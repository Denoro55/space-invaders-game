!function(e){function t(t){for(var i,n,r=t[0],h=t[1],l=t[2],c=0,u=[];c<r.length;c++)n=r[c],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&u.push(a[n][0]),a[n]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(e[i]=h[i]);for(d&&d(t);u.length;)u.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],i=!0,r=1;r<s.length;r++){var h=s[r];0!==a[h]&&(i=!1)}i&&(o.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={0:0},o=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var r=window.webpackJsonp=window.webpackJsonp||[],h=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var d=h;o.push([43,1]),s()}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(12);i.__exportStar(s(32),t),i.__exportStar(s(50),t),i.__exportStar(s(51),t),i.__exportStar(s(52),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultBulletParams=t.time=t.fullscreenParams=t.INIT_DELAY_GAME_TIME=t.defaultUISpacings=t.defaultUIPositions=t.fontSizes=t.DEVELOPER_EMAIL=t.depths=t.enemySafeAreaPercentage=t.SECONDARY_FONT=t.DEFAULT_FONT=t.defaultButtonParams=t.FULLSCREEN_TIMEOUT_DELAY=t.ORIENTATION_UPDATE_TIMEOUT_DELAY=void 0;s(12).__exportStar(s(46),t),t.ORIENTATION_UPDATE_TIMEOUT_DELAY=300,t.FULLSCREEN_TIMEOUT_DELAY=200,t.defaultButtonParams={width:180,width190:190,width120:120,height:46,spaceX:25,spaceY:70,spaceYText:30,paddingX:35},t.DEFAULT_FONT="Roboto",t.SECONDARY_FONT="atari",t.enemySafeAreaPercentage={x:10,y:10},t.depths={boss:105,enemies:50,bonuses:10,bullets:10,graphics:500,graphics2:100,overlay:499,player:101,modal:501,modalContent:502,effects:115},t.DEVELOPER_EMAIL="space-guardian@mail.ru",t.fontSizes={title:22,textMedium:18,text:16,textSmall:14},t.defaultUIPositions={top:65,bottom:50},t.defaultUISpacings={textY:20,buttonX:25,cosmonsY:35},t.INIT_DELAY_GAME_TIME=200,t.fullscreenParams={yOffset:7,xOffset:7},t.time={second:1e3,minute:6e4},t.defaultBulletParams={laser:{sprite:"laser-red",explodeSprite:"explode-red",scale:1,bodySize:6,speed:7},sphere:{sprite:"sphere-bullet",explodeSprite:"explode-red",scale:.35,bodySize:32,speed:7},triangle:{sprite:"triangle-bullet-red",explodeSprite:"explode-red",scale:1,bodySize:10,speed:7},rocket:{sprite:"rocket-bullet",explodeSprite:"explode-red"}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(12);i.__exportStar(s(53),t),i.__exportStar(s(30),t),i.__exportStar(s(54),t),i.__exportStar(s(55),t),i.__exportStar(s(56),t),i.__exportStar(s(57),t),i.__exportStar(s(33),t),i.__exportStar(s(58),t),i.__exportStar(s(59),t),i.__exportStar(s(36),t),i.__exportStar(s(87),t),i.__exportStar(s(88),t),i.__exportStar(s(89),t),i.__exportStar(s(90),t),i.__exportStar(s(91),t),i.__exportStar(s(92),t),i.__exportStar(s(93),t),i.__exportStar(s(94),t),i.__exportStar(s(95),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var i=s(45);Object.defineProperty(t,"Vector",{enumerable:!0,get:function(){return i.Vector}})},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.START_DEVELOPMENT_TIME=t.CRYPTO_TOKEN=t.IS_DEV=t.env=t.fireflyConfig=t.bossesConfig=t.playerConfig=t.storeConfig=t.boostersConfig=t.levelsConfig=t.enemiesConfig=t.mainConfig=void 0;const i=s(12);var a=s(44);Object.defineProperty(t,"mainConfig",{enumerable:!0,get:function(){return a.mainConfig}});var o=s(110);Object.defineProperty(t,"enemiesConfig",{enumerable:!0,get:function(){return o.enemiesConfig}});var n=s(29);Object.defineProperty(t,"levelsConfig",{enumerable:!0,get:function(){return n.levelsConfig}});var r=s(111);Object.defineProperty(t,"boostersConfig",{enumerable:!0,get:function(){return r.boostersConfig}});var h=s(112);Object.defineProperty(t,"storeConfig",{enumerable:!0,get:function(){return h.storeConfig}});var l=s(113);Object.defineProperty(t,"playerConfig",{enumerable:!0,get:function(){return l.playerConfig}});var d=s(20);Object.defineProperty(t,"bossesConfig",{enumerable:!0,get:function(){return d.bossesConfig}});var c=s(114);Object.defineProperty(t,"fireflyConfig",{enumerable:!0,get:function(){return c.fireflyConfig}}),i.__exportStar(s(37),t),t.env={buildTime:1685285120551},t.IS_DEV=!1,t.CRYPTO_TOKEN="space-invaders",t.START_DEVELOPMENT_TIME=new Date(2021,8,5)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=void 0;const i=s(5),a=s(3),o=s(2),n=s(116);class r extends Phaser.Scene{constructor(){super(...arguments),this.ui=new n.UI(this),this.sceneTime=0}getData(){return this.game.data}getSettings(){return this.game.settings}getQueryParam(e,t=!1){return o.getQueryParam(this.getSettings().queryParams,e,t)}getResizeParams(){return this.game.resizeManager.params}getGameSize(){const e=this.getResizeParams();return{width:+e.gameWidth,height:+e.gameHeight}}getGameCenter(){const e=this.getGameSize();return{x:Math.round(e.width/2),y:Math.round(e.height/2)}}getLastUpdatedGameTime(){const{getText:e}=this.game.i18n,t=new Date(i.env.buildTime).toLocaleString();return`${e("lastUpdated")}: ${t}`}getMousePosition(){if(this.getSettings().isMobile)return new a.Vector(-99,-99);const e=this.game.input.mousePointer;return new a.Vector(e.x,e.y)}setData(e,t){this.game.data[e]=t,i.IS_DEV&&console.log(`[${e}] was updated in global data:`,this.game.data)}updateSceneUniqueId(){this.sceneUniqueId=Date.now()+Math.random()}updateSceneTime(e,t){this.sceneTime+=15*t/i.mainConfig.scene.delta}isTheSameScene(e,t){return this.sceneUniqueId===e&&this.game.scene.isActive(t)}onGameResize(){}}t.Scene=r},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level=void 0;const i=s(5),a=s(0),o=s(142),n={[a.EGameMode.totalKills]:o.TotalKillsMode,[a.EGameMode.enemyKills]:o.EnemyKillsMode,[a.EGameMode.time]:o.TimeMode,[a.EGameMode.waves]:o.WavesMode,[a.EGameMode.boss]:o.BossMode,[a.EGameMode.survival]:o.SurvivalMode};t.Level=class{constructor(e,t,s={}){this.spawnTime=0,this.scene=e;const o=s.isSurvival?{type:a.EGameMode.survival}:i.levelsConfig.levels[t].mode;this.spawnTimeInterval=i.levelsConfig.spawnTimeInterval[this.scene.getSettings().deviceType],this.mode=new n[o.type](e,o)}update(){const{scene:e,spawnTime:t}=this,{gameTime:s}=e;s>t&&(this.spawn(),this.mode.spawn(),this.spawnTime=s+this.getSpawnInterval()),this.updateStatus()}updateStatus(){const e=this.mode.getStatus();this.status=e.value,this.statusText=e.text}getTextByMode(){return void 0===this.statusText?"":this.statusText}checkForWin(){const{status:e}=this;return void 0!==e&&e<=0}getSpawnInterval(){return this.spawnTimeInterval}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Defender=t.LaserShip=t.MissileCarrier=t.Stealth=t.Destroyer=t.Flyer=t.UFO=t.Hunter=t.Bot=t.Enemy=void 0;var i=s(10);Object.defineProperty(t,"Enemy",{enumerable:!0,get:function(){return i.Enemy}});var a=s(96);Object.defineProperty(t,"Bot",{enumerable:!0,get:function(){return a.Bot}});var o=s(97);Object.defineProperty(t,"Hunter",{enumerable:!0,get:function(){return o.Hunter}});var n=s(98);Object.defineProperty(t,"UFO",{enumerable:!0,get:function(){return n.UFO}});var r=s(99);Object.defineProperty(t,"Flyer",{enumerable:!0,get:function(){return r.Flyer}});var h=s(100);Object.defineProperty(t,"Destroyer",{enumerable:!0,get:function(){return h.Destroyer}});var l=s(101);Object.defineProperty(t,"Stealth",{enumerable:!0,get:function(){return l.Stealth}});var d=s(102);Object.defineProperty(t,"MissileCarrier",{enumerable:!0,get:function(){return d.MissileCarrier}});var c=s(103);Object.defineProperty(t,"LaserShip",{enumerable:!0,get:function(){return c.LaserShip}});var u=s(104);Object.defineProperty(t,"Defender",{enumerable:!0,get:function(){return u.Defender}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Enemy=void 0;const i=s(3),a=s(1),o=s(15),n=s(0),r=s(2),h=s(5),l=40,d=8;t.Enemy=class{constructor(e,t,s){this.reward=0,this.isInsideSafeArea=!1,this.angle=0,this.targetAngle=0,this.lastChangeTargetTime=0,this.lastFireTime=0,this.lastHitTime=0,this.scene=e,this.name=t,this.setPropertiesFromConfig();const o=this.scene.getGameCenter();this.angle=r.getAngleBetweenPointsInDegrees(new i.Vector(o.x,o.y),s),this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),this.graphics.setDepth(a.depths.graphics2),this.healthbar=new Phaser.Geom.Rectangle(0,-100,l,d)}setPropertiesFromConfig(){this.reward=h.enemiesConfig.ships[this.name].reward}act(e,t){this.draw()}updateSafeArea(e,t){const{isInsideSafeArea:s}=this;this.isOutsideSafeArea(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y)?(s&&this.onOutOfSafeArea(this.scene.utils.getSafeAreaPoint()),this.isInsideSafeArea=!1):this.isInsideSafeArea=!0}damage(e){this.hp-=e,this.lastHitTime=this.scene.gameTime,this.hp<=0&&this.destroy()}destroy(){const{scene:e,body:t,graphics:s}=this;s.clear(),this.scene.game.soundManager.play(n.ESoundName.explode),e.enemies=e.enemies.filter(e=>e!==this),e.stats.enemiesCount[this.name]-=1,t.destroy();const i=e.getStats();Math.random()>1-e.player.fortune/100&&e.utils.createBonus(t.x,t.y,this.reward),i.kills[this.name]+=1,i.totalKills+=1,e.score+=this.reward,e.shakeScreen()}isOutsideSafeArea(e,t){const{body:s}=this,i=this.scene.getGameSize(),a=i.width*(e/100),o=i.height*(t/100);return s.x<a||s.x>i.width-a||s.y<o||s.y>i.height-o}onOutOfSafeArea(e){}setRandomTargetAngleWithInterval(){const{scene:e,changeTargetTimeInterval:t}=this;this.setTargetAngle(this.scene.utils.getRandomPos(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y));const s=t[0]+Math.random()*t[1];this.lastChangeTargetTime=e.gameTime+s}setRandomTargetAngle(){this.setTargetAngle(this.scene.utils.getRandomPos(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y))}setTargetAngle(e){const{body:t}=this;this.targetAngle=r.getAngleBetweenPointsInDegrees(e,t)}updateFire(){const{scene:e,body:t,angle:s,lastFireTime:a}=this,n=e.gameTime,h=r.angleToRadians(s+180);n>a&&(e.effects.push(new o.Fire(e,{pos:new i.Vector(t.x+45*Math.cos(h+.4),t.y+45*Math.sin(h+.4)),angle:h})),e.effects.push(new o.Fire(e,{pos:new i.Vector(t.x+45*Math.cos(h-.4),t.y+45*Math.sin(h-.4)),angle:h})),this.lastFireTime=n+75)}draw(){const{graphics:e}=this;e.clear(),this.drawHealthbar({firstColor:a.colors.red,secondColor:a.colors.white,healthbarRect:this.healthbar,hp:this.hp,maxHp:this.maxHp,fromLeft:!1})}drawHealthbar(e){const{graphics:t}=this,{healthbarRect:s,firstColor:i,secondColor:o,hp:n,maxHp:r}=e;let h=n/r;e.fromLeft&&(h=1-h),t.fillStyle(o),s.width=l,t.fillRectShape(s),t.fillStyle(i),s.width=Math.max(l*h,0),t.fillRectShape(s),t.lineStyle(2,a.colors.white),s.width=l,t.strokeRectShape(s),s.x=this.body.x-l/2,s.y=this.body.y-this.body.displayHeight,this.hp<this.maxHp?t.setAlpha(this.body.alpha):t.setAlpha(0)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=void 0;t.Service=class{constructor(e){this.scene=e}}},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mode=void 0;t.Mode=class{constructor(e,t){this.scene=e,this.modeParams=t}spawn(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FireflyExplode=t.Shadow=t.Fire=t.Explode=t.Effect=void 0;var i=s(19);Object.defineProperty(t,"Effect",{enumerable:!0,get:function(){return i.Effect}});var a=s(47);Object.defineProperty(t,"Explode",{enumerable:!0,get:function(){return a.Explode}});var o=s(48);Object.defineProperty(t,"Fire",{enumerable:!0,get:function(){return o.Fire}});var n=s(49);Object.defineProperty(t,"Shadow",{enumerable:!0,get:function(){return n.Shadow}});var r=s(31);Object.defineProperty(t,"FireflyExplode",{enumerable:!0,get:function(){return r.FireflyExplode}})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIComponent=void 0;t.UIComponent=class{constructor(e){this.scene=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Effect=void 0;t.Effect=class{constructor(e){this.scene=e}act(){}destroy(){const{body:e}=this;this.scene.effects=this.scene.effects.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bossesConfig=void 0,t.bossesConfig={bodyDamage:10,bosses:{ghost:{maxHp:2e3,reward:400,paramsByDevice:{splashAttackBulletsOffset:{desktop:15,mobile:20},circleAttackBulletsCount:{desktop:8,mobile:6},circleAttackBulletsSizeTime:{desktop:50,mobile:40},bombsCount:{desktop:10,mobile:8},laserAttackReloadTime:{desktop:400,mobile:500},laserDoubleAttackReloadTime:{desktop:250,mobile:350},splashAttackReloadTime:{desktop:600,mobile:800},explodeAttackReloadTime:{desktop:500,mobile:1e3},explodeBulletSpeedTime:{desktop:40,mobile:20}}},chastener:{maxHp:3e3,reward:1200,paramsByDevice:{ufoMaxCount:{desktop:3,mobile:2},lasterShootingReloadTime:{desktop:20,mobile:30},doubleShootingReloadTime:{desktop:30,mobile:40},waveBulletsCount:{desktop:10,mobile:6},spiralShootingRange:{desktop:7,mobile:8},supportShootingBulletsLoopCount:{desktop:3,mobile:2},shootingReloadTime:{desktop:8,mobile:10}}},bomber:{maxHp:4e3,reward:3e3,paramsByDevice:{}}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIIndicator=t.UITabs=t.UICircleProgress=t.UIRewardedModal=t.UIRainbowText=t.UICosmons=void 0;s(12).__exportStar(s(117),t);var i=s(121);Object.defineProperty(t,"UICosmons",{enumerable:!0,get:function(){return i.UICosmons}});var a=s(122);Object.defineProperty(t,"UIRainbowText",{enumerable:!0,get:function(){return a.UIRainbowText}});var o=s(123);Object.defineProperty(t,"UIRewardedModal",{enumerable:!0,get:function(){return o.UIRewardedModal}});var n=s(38);Object.defineProperty(t,"UICircleProgress",{enumerable:!0,get:function(){return n.UICircleProgress}});var r=s(124);Object.defineProperty(t,"UITabs",{enumerable:!0,get:function(){return r.UITabs}});var h=s(125);Object.defineProperty(t,"UIIndicator",{enumerable:!0,get:function(){return h.UIIndicator}})},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss=void 0;const i=s(3),a=s(20),o=s(2);t.Boss=class{constructor(e,t){this.angle=0,this.scale=1,this.bodyDamageReloadTime=0,this.scene=e,this.bossName=t}initCollisions(){const{scene:e}=this;e.physics.add.overlap(this.body,e.player.body,()=>{e.gameTime>this.bodyDamageReloadTime&&(e.player.hit(a.bossesConfig.bodyDamage),this.bodyDamageReloadTime=e.gameTime+200)})}act(e,t){}damage(e){this.hp=Math.max(this.hp-e,0),this.hp<=0&&this.destroy()}isOutsideSafeArea(e,t){const{body:s}=this,i=this.scene.getGameSize(),a=i.width*(e/100),o=i.height*(t/100);return s.x<a||s.x>i.width-a||s.y<o||s.y>i.height-o}setPropertiesFromConfig(){const e=a.bossesConfig.bosses[this.bossName];this.maxHp=e.maxHp,this.hp=this.maxHp,this.rewardedScore=e.reward}destroy(){const{scene:e}=this,t=new i.Vector(this.body.x,this.body.y);for(let e=0;e<3;e++){const s=o.getOffsetByAngle(this.angle+120*e,70);this.scene.utils.createTripleExplode(t.x+s.x,t.y+s.y)}this.body.destroy(),e.shakeScreen(),this.scene.score+=this.rewardedScore,this.scene.money+=this.rewardedScore}get pos(){return new i.Vector(this.body.x,this.body.y)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RayBullet=t.RocketBullet=t.SphereBullet=t.Bullet=void 0;var i=s(173);Object.defineProperty(t,"Bullet",{enumerable:!0,get:function(){return i.Bullet}});var a=s(174);Object.defineProperty(t,"SphereBullet",{enumerable:!0,get:function(){return a.Sphere}});var o=s(175);Object.defineProperty(t,"RocketBullet",{enumerable:!0,get:function(){return o.Rocket}});var n=s(176);Object.defineProperty(t,"RayBullet",{enumerable:!0,get:function(){return n.Ray}})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bonus=void 0;t.Bonus=class{constructor(e){this.scene=e}act(){}destroy(){const{body:e}=this;this.scene.bonuses=this.scene.bonuses.filter(e=>e!==this),e.destroy()}}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.levelsConfig=t.levelsSchema=void 0;const i=s(9),a=s(0),o=s(105),n=s(106);t.levelsSchema=[{maxEnemies:3,mode:{type:a.EGameMode.totalKills,target:15}},{maxEnemies:3,mode:{type:a.EGameMode.enemyKills,target:{hunter:10}}},{maxEnemies:3,mode:{type:a.EGameMode.time,target:90}},{maxEnemies:4,mode:{type:a.EGameMode.waves,target:[{maxEnemies:3,enemies:o.getEnemiesArray([i.Bot,5],i.Hunter,i.Bot)},{maxEnemies:3,enemies:o.getEnemiesArray(i.Hunter,[i.Bot,3],i.Hunter,[i.Bot,3],i.Hunter)},{maxEnemies:3,enemies:o.getEnemiesArray([i.Hunter,2],i.Bot,i.Hunter,[i.Bot,2],i.Hunter,[i.Bot,3])},{maxEnemies:4,enemies:o.getEnemiesArray(i.Bot,i.Hunter,i.UFO,[i.Bot,2],[i.Hunter,2],i.Bot,i.UFO,i.Hunter)},{maxEnemies:4,enemies:o.getEnemiesArray(i.UFO,i.Bot,[i.Hunter,2],[i.Bot,2],i.UFO,[i.Hunter,2],i.Bot,[i.UFO,2])}]}},{maxEnemies:1,mode:{type:a.EGameMode.boss,target:n.Boss1}},{maxEnemies:4,mode:{type:a.EGameMode.totalKills,target:30}},{maxEnemies:4,mode:{type:a.EGameMode.enemyKills,target:{destroyer:10}}},{maxEnemies:4,mode:{type:a.EGameMode.time,target:150}},{maxEnemies:5,mode:{type:a.EGameMode.waves,target:[{maxEnemies:4,enemies:o.getEnemiesArray([i.Hunter,2],i.UFO,i.Bot,i.Hunter,[i.UFO,2],[i.Hunter,2],i.Bot)},{maxEnemies:4,enemies:o.getEnemiesArray([i.Hunter,2],[i.Flyer,2],[i.UFO,2],i.Hunter,[i.Flyer,2],[i.UFO,2],[i.Hunter,2])},{maxEnemies:4,enemies:o.getEnemiesArray(i.Hunter,[i.UFO,2],[i.Destroyer,2],[i.Flyer,3],i.Bot,[i.Hunter,2],[i.Destroyer,2],[i.UFO,2],i.Bot,[i.Flyer,2])},{maxEnemies:5,enemies:o.getEnemiesArray([i.Hunter,2],[i.Destroyer,3],[i.Flyer,4],i.Bot,[i.UFO,2],[i.Destroyer,3],[i.Flyer,2],[i.UFO,2],[i.Destroyer,2],[i.Flyer,4],i.UFO)},{maxEnemies:5,enemies:o.getEnemiesArray([i.Flyer,6],[i.Destroyer,3],[i.Flyer,2],[i.Stealth,2],[i.Destroyer,2],[i.Hunter,2],[i.Stealth,3],[i.Flyer,3],[i.Destroyer,3],[i.Stealth,2],[i.Flyer,3],i.Destroyer,[i.Stealth,2])}]}},{maxEnemies:1,mode:{type:a.EGameMode.boss,target:n.Boss2}},{maxEnemies:5,mode:{type:a.EGameMode.totalKills,target:50}},{maxEnemies:5,mode:{type:a.EGameMode.enemyKills,target:{"laser-ship":15}}},{maxEnemies:5,mode:{type:a.EGameMode.time,target:210}},{maxEnemies:5,mode:{type:a.EGameMode.waves,target:[{maxEnemies:5,enemies:o.getEnemiesArray([i.Stealth,4],[i.MissileCarrier,2],[i.Stealth,4],[i.MissileCarrier,2],[i.Destroyer,3],[i.UFO,3],[i.Stealth,2],[i.MissileCarrier,2])},{maxEnemies:5,enemies:o.getEnemiesArray([i.Flyer,4],[i.Stealth,4],[i.LaserShip,2],[i.Flyer,4],[i.LaserShip,2],[i.Destroyer,3],[i.Stealth,2],[i.LaserShip,2],[i.Flyer,4])},{maxEnemies:5,enemies:o.getEnemiesArray([i.Defender,3],[i.Flyer,4],[i.Destroyer,4],[i.Defender,2],[i.Stealth,4],[i.Defender,2],[i.Stealth,4],[i.Destroyer,4],[i.Stealth,4],[i.UFO,4])},{maxEnemies:5,enemies:o.getEnemiesArray([i.Flyer,6],[i.MissileCarrier,2],[i.Flyer,4],[i.LaserShip,2],[i.Destroyer,3],[i.MissileCarrier,2],[i.Flyer,4],[i.LaserShip,2],[i.Stealth,4],[i.MissileCarrier,2],[i.Stealth,4])},{maxEnemies:6,enemies:o.getEnemiesArray([i.LaserShip,2],[i.MissileCarrier,2],[i.Defender,2],[i.LaserShip,2],[i.Stealth,2],[i.MissileCarrier,2],[i.Stealth,2],[i.LaserShip,2],[i.Defender,4],[i.MissileCarrier,2],[i.Flyer,4],[i.MissileCarrier,2],[i.LaserShip,2])}]}},{maxEnemies:1,mode:{type:a.EGameMode.boss,target:n.Boss3}}];const r=t.levelsSchema.map((e,t)=>Object.assign(Object.assign({},e),{level:t}));t.levelsConfig={spawnTimeInterval:{desktop:1500,mobile:3e3},levels:r}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spreadRadians=t.spreadAngle=t.getAngleDiff=t.getOffsetByAngle=t.getOffsetByRadians=t.getNearestAngle=t.angleToRadians=t.angleToDegrees=t.getAngleBetweenPointsInDegrees=t.getAngleBetweenPointsInRadians=void 0;const i=s(3);function a(e,t){return Math.atan2(e.y-t.y,e.x-t.x)}function o(e){return e/Math.PI*180}function n(e){return e*Math.PI/180}t.getAngleBetweenPointsInRadians=a,t.getAngleBetweenPointsInDegrees=function(e,t){return o(a(e,t))},t.angleToDegrees=o,t.angleToRadians=n,t.getNearestAngle=function(e,t,s){if(function(e,t){const s=e*Math.PI/180,i=t*Math.PI/180,a=Math.cos(s),o=Math.sin(s),n=a*Math.cos(i)+o*Math.sin(i);return 180*Math.acos(n)/Math.PI}(e,t)<s||Math.abs(e-t)<s)return t;Math.abs(e-t)<180?e<t?e+=s:e-=s:e<t?e-=s:e+=s;const i=(e%360+360)%360;return i>180?i-360:i};t.getOffsetByRadians=(e,t)=>new i.Vector(Math.cos(e)*t,Math.sin(e)*t);t.getOffsetByAngle=(e,s)=>t.getOffsetByRadians(n(e),s);t.getAngleDiff=(e,t)=>{const s=Math.abs(e-t);return Math.abs((s+180)%360-180)};t.spreadAngle=(e,t)=>e-t+Math.random()*(2*t);t.spreadRadians=(e,s)=>t.spreadAngle(e,n(s))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FireflyExplode=void 0;const i=s(5),a=s(19);class o extends a.Effect{constructor(e,t){super(e),this.body=new Phaser.GameObjects.Image(e,t.pos.x,t.pos.y,"firefly"),this.params=t,this.init()}init(){const{scene:e,params:t}=this;this.startTime=e.gameTime,this.body.setScale(t.scale),e.add.existing(this.body),this.spawnCoins(),e.cameras.main.flash(i.fireflyConfig.cameraFlashDuration)}act(){this.update()}update(){const{scene:e,params:t,startTime:s}=this,i=e.gameTime-s,a=t.scale+i/100;this.body.setScale(a,a),this.body.setAlpha(Math.max(0,1-i/500)),this.body.alpha<=0&&this.destroy()}spawnCoins(){const{scene:e}=this,t=this.scene.getData().level,s=i.fireflyConfig.reward+Math.floor(t*i.fireflyConfig.increaseRewardPerLevel);for(let t=0;t<10;t++){const t=e.utils.getRandomPos(5,10);e.utils.createBonus(t.x,t.y,s)}}}t.FireflyExplode=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ELeaderboardName=t.ESoundName=t.EBoosterType=t.ESceneName=t.EBossName=t.EEnemyName=t.EGameMode=t.EOwner=t.EPlayerStoreProduct=t.EDeviceType=t.ELanguage=void 0,function(e){e.ru="ru",e.en="en"}(t.ELanguage||(t.ELanguage={})),function(e){e.desktop="desktop",e.mobile="mobile"}(t.EDeviceType||(t.EDeviceType={})),function(e){e.damage="damage",e.movementSpeed="movementSpeed",e.attackSpeed="attackSpeed",e.maxHealth="maxHealth",e.explosionResistance="explosionResistance",e.bonusesTime="bonusesTime",e.fortune="fortune"}(t.EPlayerStoreProduct||(t.EPlayerStoreProduct={})),function(e){e.player="player",e.enemy="enemy"}(t.EOwner||(t.EOwner={})),function(e){e.totalKills="totalKills",e.enemyKills="enemyKill",e.time="time",e.waves="waves",e.boss="boss",e.survival="survival"}(t.EGameMode||(t.EGameMode={})),function(e){e.bot="bot",e.defender="defender",e.destroyer="destroyer",e.ufo="ufo",e.hunter="hunter",e.flyer="flyer",e.stealth="stealth",e.missileCarrier="missile-carrier",e.laserShip="laser-ship"}(t.EEnemyName||(t.EEnemyName={})),function(e){e.ghost="ghost",e.chastener="chastener",e.bomber="bomber"}(t.EBossName||(t.EBossName={})),function(e){e.ad="AdScene",e.menu="MenuScene",e.preview="PreviewScene",e.game="GameScene",e.fail="FailScene",e.win="WinScene",e.info="InfoScene",e.preload="PreloadScene",e.history="HistoryScene",e.loading="LoadingScene",e.contacts="ContactsScene",e.store="StoreScene",e.leaderboards="LeaderboardsScene",e.workshop="WorkshopsScene",e.rankedBosses="RankedBossesScene",e.final="FinalScene",e.controls="ControlsScene",e.suvivalPreview="SurvivalPreviewScene",e.survivalResults="SurvivalResultsScene"}(t.ESceneName||(t.ESceneName={})),function(e){e.speed="bonus-speed",e.damage="bonus-damage",e.shield="bonus-shield",e.regenerator="bonus-regenerator"}(t.EBoosterType||(t.EBoosterType={})),function(e){e.playerLaser="playerLaser",e.enemyLaser="enemyLaser",e.explode="explode",e.ufoShot="ufoShot"}(t.ESoundName||(t.ESoundName={})),function(e){e.main="main",e.survival="survival",e.level="level"}(t.ELeaderboardName||(t.ELeaderboardName={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryParam=t.parseQuery=void 0;const i=s(5);t.parseQuery=e=>{const t={},s=("?"===e[0]?e.slice(1):e).split("&");for(let e=0;e<s.length;e++){const i=s[e].split("=");i[0]&&(t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||""))}return t};t.getQueryParam=(e,t,s=!1)=>!i.IS_DEV&&s&&"guardian"!==e.admin?null:e[t]},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debugLog=void 0;const i=s(5),a=s(33).parseQuery(window.location.search);t.debugLog=(e,t)=>{(i.IS_DEV||a.debug)&&console.log(`[${e}]:`,t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMobileGameConfig=t.getDesktopGameConfig=t.baseConfig=void 0;const i=s(115),a=s(2),o=a.parseQuery(window.location.search),n=1332,r=600,h=768,l={width:1100,minHeight:460,maxHeight:1100/1.77};t.baseConfig={type:Phaser.AUTO,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:Boolean(a.getQueryParam(o,"debug"))}},scene:[i.PreloadScene,i.MenuScene,i.GameScene,i.PreviewScene,i.FailScene,i.WinScene,i.InfoScene,i.HistoryScene,i.AdScene,i.LoadingScene,i.ContactsScene,i.LeaderboardsScene,i.StoreScene,i.FinalScene,i.ControlsScene,i.SurvivalPreviewScene,i.SurvivalResultsScene]};t.getDesktopGameConfig=()=>({width:n,height:Math.min(Math.max(n*window.innerHeight/window.innerWidth,r),h),scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}});t.getMobileGameConfig=()=>({width:l.width,height:Math.min(Math.max(l.width*window.innerHeight/window.innerWidth,l.minHeight),l.maxHeight),scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UICircleProgress=void 0;const i=s(3),a=s(18);class o extends a.UIComponent{constructor(e,t){super(e),this.isVisible=!1,this.params=t,this.pos=t.pos,this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),t.depth&&this.graphics.setDepth(t.depth)}update(e){const{pos:t}=this;this.graphics.clear();const s=(270+Math.min(360-360*e.percentage,360))%360;this.graphics.lineStyle(2,e.color),this.graphics.beginPath(),this.graphics.arc(t.x,t.y,20,Phaser.Math.DegToRad(s),Phaser.Math.DegToRad(270),!1),this.graphics.strokePath(),this.isVisible=!0}hide(){this.isVisible&&(this.graphics.clear(),this.isVisible=!1)}setPosition(e,t){this.pos=new i.Vector(e,t)}}t.UICircleProgress=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Booster=t.boosters=void 0;const i=s(5),a=s(0),o=s(1),n=s(27);t.boosters={0:a.EBoosterType.speed,1:a.EBoosterType.damage,2:a.EBoosterType.shield,3:a.EBoosterType.regenerator};class r extends n.Bonus{constructor(e,t,s){super(e),this.creationTime=e.gameTime,this.type=s,this.body=this.scene.physics.add.image(t.x,t.y,this.type),this.rect=new Phaser.Geom.Rectangle(t.x-18,t.y-18,36,36),this.init()}init(){this.body.setDepth(o.depths.bonuses)}act(){this.update()}update(){const{scene:e,body:t}=this,s=e.gameTime;t.scale=1.2+Math.sin(.004*s)/6,s>this.creationTime+1e3*i.boostersConfig.lifeTime&&this.destroy(),Phaser.Geom.Intersects.CircleToRectangle(e.player.geomCircle,this.rect)&&(e.player.setBooster(this.type),this.destroy())}}t.Booster=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EStoreSection=void 0,function(e){e.characteristics="characteristics",e.ships="ships",e.weapons="weapons",e.boosters="boosters"}(t.EStoreSection||(t.EStoreSection={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGameConfig=t.getDeviceOptions=void 0;const i=s(37),a=s(2);t.getDeviceOptions=()=>a.isMobileDevice()?i.getMobileGameConfig():i.getDesktopGameConfig();t.getGameConfig=()=>Object.assign(Object.assign({},i.baseConfig),t.getDeviceOptions())},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeManager=t.SoundManager=t.Leaderboards=t.AdManager=t.Translations=t.I18n=t.LocalStorage=t.EventEmitter=t.Game=void 0;var a=s(192);Object.defineProperty(t,"Game",{enumerable:!0,get:function(){return a.Game}});var o=s(193);Object.defineProperty(t,"EventEmitter",{enumerable:!0,get:function(){return o.EventEmitter}});var n=s(194);Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return i(n).default}});var r=s(195);Object.defineProperty(t,"I18n",{enumerable:!0,get:function(){return i(r).default}});var h=s(196);Object.defineProperty(t,"Translations",{enumerable:!0,get:function(){return h.Translations}});var l=s(197);Object.defineProperty(t,"AdManager",{enumerable:!0,get:function(){return l.AdManager}});var d=s(198);Object.defineProperty(t,"Leaderboards",{enumerable:!0,get:function(){return d.Leaderboards}});var c=s(199);Object.defineProperty(t,"SoundManager",{enumerable:!0,get:function(){return c.SoundManager}});var u=s(200);Object.defineProperty(t,"ResizeManager",{enumerable:!0,get:function(){return u.ResizeManager}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s(28);const i=s(5),a=s(41),o=s(42),n=s(0),r=s(2),h=s(1),l=s(201);let d,c=!1,u=!1,m=!1,p=null;const g=r.parseQuery(window.location.search),y=o.LocalStorage.getGameData(),v=document.querySelector(".rotate-screen-overlay__content"),S=B(),b=new o.I18n(S),f=Boolean(g["mock-sdk"]||!r.isInIframe());function x(){const e=null==y?void 0:y.player;return e||{level:T()}}function T(){const e=Number(r.getQueryParam(g,"level",!0))-1;return!isNaN(e)&&r.isLevelNumberValid(e)?e:(null==y?void 0:y.level)&&r.isLevelNumberValid(null==y?void 0:y.level)?y.level:0}function w(){const e=Number(r.getQueryParam(g,"money",!0));if(e&&!isNaN(e))return e;const t=Number(null==y?void 0:y.money);return t||0}function P(){const e=null==y?void 0:y.store;return null!=e?e:{}}function B(){const e=r.getQueryParam(g,"lang");if(e&&r.isLangExists(e))return e;if(void 0!==window.ysdk&&r.isLangExists(window.ysdk.environment.i18n.lang))return window.ysdk.environment.i18n.lang;const t=window.navigator.language;return r.isLangExists(t)?t:n.ELanguage.ru}function M(){const e=r.isMobileDevice();u||void 0===window.ysdk||(e&&r.isLandscapeOrientation()||!e?(setTimeout(()=>{window.ysdk.getPlayer().then(e=>{var t;const s={level:T(),money:w(),player:x(),wasHistoryShown:!1,isWaitButtonPressed:Boolean(null==y?void 0:y.isWaitButtonPressed)||!1,store:Object.assign({maxHealth:0,movementSpeed:0,attackSpeed:0,bonusesTime:0,explosionResistance:0,damage:0,fortune:0},P())},n={isMobile:r.isMobileDevice(),isAuthorized:"lite"!==e.getMode(),deviceType:r.getDeviceType(),queryParams:g,lang:B()};d=new o.Game(a.getGameConfig(),{data:s,settings:n,i18n:b}),i.IS_DEV?console.log("Game inited",d):console.log("Game inited"),null===(t=document.getElementById("spinner"))||void 0===t||t.remove()}).catch(e=>{console.error(e)})},h.INIT_DELAY_GAME_TIME),u=!0):console.log("Game could not be inited as it does not support portrait orientation"))}function E(e=120){if(!c)return;const t=r.getCurrentOrientation();t!==p?(p=t,M(),r.isLandscapeOrientation()?r.hideOrientationWarning():r.isMobileDevice()&&(r.showOrientationWarning(),d&&r.hideFullscreen())):e>0&&window.requestAnimationFrame(()=>{E(e-1)})}function A(){m||f||(m=!0,window.YaGames.init().then(e=>{console.log("Yandex SDK initialized"),window.ysdk=e,M()}))}r.debugLog("ls data",y),window.addEventListener("orientationchange",()=>{setTimeout(()=>{E()},h.ORIENTATION_UPDATE_TIMEOUT_DELAY)}),window.addEventListener("load",A),window.addEventListener("onSDKLoaded",A),b.loadLang(S).then(()=>{c=!0,document.body.classList.add("lang-loaded");const e=b.getKeyValue("rotateDevice");v&&e&&(v.textContent=e),E()}),r.isMobileDevice()&&(document.body.style.backgroundColor="#000"),f&&l.initMockYSDK().then(()=>{M()})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mainConfig=void 0;s(29);const i=s(0);t.mainConfig={gameTitle:"Space Guardian",gameSubtitle:"A threat to humanity",totalLevelsCount:15,touch:{pointerSize:32,pointerRadius:100,areaSize:35,areaOffset:85},scene:{delta:16,minYPos:100,failTimeoutTime:2e3,winTimeoutTime:2e3},languages:[i.ELanguage.ru,i.ELanguage.en]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;t.Vector=class{constructor(e,t){this.x=e,this.y=t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexColors=t.colors=void 0,t.colors={black:0,white:16777215,green:65280,red:16711680,gray:14540253,gray2:6710886,yellow:16548895,blue:3327,aqua:36863,bronze:13467442,silver:12632256,gold:16766720},t.hexColors={white:"#ffffff",green:"#00ff00"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Explode=void 0;const i=s(1),a=s(19);class o extends a.Effect{constructor(e,t){super(e),this.canDamage=!0,this.body=e.add.image(t.pos.x,t.pos.y,t.sprite),this.params=t,this.startTime=e.gameTime,this.circle=new Phaser.Geom.Circle(t.pos.x,t.pos.y,16),this.body.setScale(0),this.body.setOrigin(.5,.5),this.body.setDepth(i.depths.effects)}act(){this.update()}update(){const{scene:e,startTime:t,params:s}=this,i=e.gameTime-t,a=Math.sin(i/150)*this.params.scaleCoef,o=a;this.body.angle+=3*e.deltaTime,this.body.setScale(o,o),this.body.setAlpha(a),a<.06&&i>100&&this.destroy(),s.withDamage&&Phaser.Geom.Intersects.CircleToCircle(this.circle,e.player.geomCircle)&&this.canDamage&&(e.player.hit(10,{type:"explode"}),this.canDamage=!1)}}t.Explode=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fire=void 0;const i=s(30),a=s(19);class o extends a.Effect{constructor(e,t){super(e),this.speed=1.7,this.body=e.ui.drawImage({x:t.pos.x,y:t.pos.y,texture:"fire"}),this.params=t,this.body.setDepth(5),this.body.setAngle(i.angleToDegrees(t.angle)+90),this.startTime=e.gameTime,this.params=t}act(){this.update()}update(){const{scene:e,body:t,speed:s,startTime:i,params:a}=this,o=e.gameTime-i;t.alpha=1-o/150,t.x+=s*Math.cos(a.angle),t.y+=s*Math.sin(a.angle),t.alpha<=0&&this.destroy()}}t.Fire=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shadow=void 0;const i=s(19);class a extends i.Effect{constructor(e,t){super(e),this.params=t,this.body=e.ui.drawImage({x:t.pos.x,y:t.pos.y,texture:t.sprite}),this.body.setScale(t.scale),this.body.setAngle(t.angle),this.body.setAlpha(t.alpha),this.body.setDepth(0),this.destroyTime=t.lifeTime+e.gameTime}act(){this.update()}update(){const{scene:e,body:t,destroyTime:s,params:i}=this,{gameTime:a}=e,o=(s-a)*i.alpha/i.lifeTime;t.setAlpha(o),a>this.destroyTime&&this.destroy()}}t.Shadow=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EGoalTargetName=void 0,function(e){e.levelCompleted="levelCompleted",e.levelStart="levelStart",e.waitNextLevels="waitNextLevels",e.survivalComplete="survivalComplete"}(t.EGoalTargetName||(t.EGoalTargetName={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBodyPosWithOffset=void 0;const i=s(3);t.getBodyPosWithOffset=(e,t,s,a,o={x:0,y:0})=>{const n=e/s/2-a+o.x,r=t/s/2-a+o.y;return new i.Vector(n,r)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIndexOfMinNumber=t.getDistanceBetweenPoints=t.getRandomInt=void 0;t.getRandomInt=(e,t)=>Math.floor(e+Math.random()*(t+1-e));t.getDistanceBetweenPoints=(e,t)=>{const s=e.x-t.x,i=e.y-t.y;return Math.sqrt(s*s+i*i)};t.getIndexOfMinNumber=e=>{let t=e[0],s=0;for(let i=1;i<e.length;i++)e[i]<t&&(t=e[i],s=i);return s}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pluralize=void 0,t.pluralize=function(e,t,s){switch(function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}(e)){case 0:return(null==s?void 0:s.isGenetiveForm)?t[3]:t[0];case 1:return t[1];default:return t[2]}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInFullscreen=t.isInIframe=t.getDeviceType=t.isMobileDevice=t.getCurrentOrientation=t.isLandscapeOrientation=void 0;const i=s(0);t.isLandscapeOrientation=()=>window.innerHeight<window.innerWidth;t.getCurrentOrientation=()=>t.isLandscapeOrientation()?"horizontal":"vertical";t.isMobileDevice=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t.getDeviceType=()=>t.isMobileDevice()?i.EDeviceType.mobile:i.EDeviceType.desktop;t.isInIframe=()=>{try{return window.self!==window.top}catch(e){return!0}};t.isInFullscreen=()=>window.innerHeight==screen.height},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFullScreenMode=t.getFullWindowHeight=t.hideFullscreen=t.showFullscreen=t.hideOrientationWarning=t.showOrientationWarning=void 0;const i=s(5),a=document.querySelector(".screen-height-detector");t.showOrientationWarning=()=>{document.body.classList.add("portrait-orientation-warning")};t.hideOrientationWarning=()=>{document.body.classList.remove("portrait-orientation-warning")};t.showFullscreen=e=>{i.IS_DEV||t.isFullScreenMode()||(e.requestFullscreen?e.requestFullscreen({navigationUI:"hide"}):e.webkitRequestFullscreen?e.webkitRequestFullscreen({navigationUI:"hide"}):e.msRequestFullscreen&&e.msRequestFullscreen({navigationUI:"hide"}))};t.hideFullscreen=()=>{t.isFullScreenMode()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())};t.getFullWindowHeight=()=>{if(!a)throw new Error("root element for detecting height is null");return a.getBoundingClientRect().height};t.isFullScreenMode=()=>!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLevelNumberValid=void 0;const i=s(5);t.isLevelNumberValid=e=>!("number"!=typeof e||isNaN(e)||e<0||e>=i.mainConfig.totalLevelsCount)},function(e,t,s){"use strict";const i=a;function a(e,t){const s=r();return(a=function(e,t){return s[e-=445]})(e,t)}!function(e,t){const s=a,i=e();for(;;)try{if(615860===parseInt(s(470))/1+parseInt(s(467))/2+parseInt(s(449))/3*(-parseInt(s(447))/4)+-parseInt(s(465))/5*(-parseInt(s(461))/6)+parseInt(s(448))/7*(parseInt(s(472))/8)+parseInt(s(458))/9*(parseInt(s(450))/10)+-parseInt(s(466))/11*(parseInt(s(454))/12))break;i.push(i.shift())}catch(e){i.push(i.shift())}}(r),Object[i(455)](t,i(462),{value:!0}),t[i(468)]=t[i(469)]=t[i(473)]=void 0;const o=s(12)[i(453)](s(60)),n=s(5);t[i(473)]=()=>{const e=i;return n[e(457)][e(460)]("")[e(451)]()[e(463)]("")};t[i(469)]=e=>{const s=i;try{return o.default[s(471)][s(446)](e,t[s(473)]())[s(464)]()}catch(e){console.error(e)}return null};function r(){const e=["encrypt","795868qqydsG","1526BOBYEp","3QudPDF","20MbPALn","reverse","default","__importDefault","8686956lxzTxR","defineProperty","Utf8","CRYPTO_TOKEN","1407870aDrPhk","enc","split","4099692SYDTvz","__esModule","join","toString","5tRoVAr","22ARVhpU","1210622ivvepO","decryptValue","encryptValue","589914ZBkXBa","AES","2616komGah","getCryptoKey","decrypt"];return(r=function(){return e})()}t[i(468)]=e=>{const s=i;if(!e)return null;try{return o[s(452)][s(471)][s(445)](e,t[s(473)]())[s(464)](o.default[s(459)][s(456)])}catch(e){console.error(e)}return null}},,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomHexColor=void 0;t.getRandomHexColor=()=>{let e=65280,t=16711681;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLangExists=void 0;const i=s(5);t.isLangExists=e=>!!i.mainConfig.languages.includes(e)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textTemplate=void 0;t.textTemplate=(e,t)=>{const s=e.matchAll(/{(.+?)}/g);for(const i of s)e=e.replace(`{${i[1]}}`,t[i[1]]);return e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shuffleArray=t.flatten=t.chunk=void 0;t.chunk=(e,t)=>{const s=[];for(let i=0;i<e.length;i+=t)s.push(e.slice(i,i+t));return s};t.flatten=e=>{const t=[e],s=[];for(;t.length;){const e=t.pop();if(Array.isArray(e))for(;e.length;)t.push(e.pop());else s.push(e)}return s};t.shuffleArray=e=>{for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[s],e[s]=i}return e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excludeUndefinedValues=void 0;t.excludeUndefinedValues=e=>(Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),e)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEllipsisText=void 0;t.getEllipsisText=(e,t)=>e.length>t?e.slice(0,t)+"...":e},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendMetrikaGoal=void 0;const i=s(5),a=s(36);t.sendMetrikaGoal=(e,t)=>{i.IS_DEV?a.debugLog("metrika",{targetName:e,params:t}):window.ym(91179787,"reachGoal",e,t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeStringFromSeconds=t.getSeconds=void 0;const i=s(1);t.getSeconds=e=>i.time.second*e,t.getTimeStringFromSeconds=function(e){return`${Math.floor(e/60).toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=void 0,t.debounce=function(e,t=300){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>{e.apply(this,i)},t)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bot=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10);class h extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.bot,t.pos),this.speed=1.5,this.rotateSpeed=2,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.shootInterval=1200,this.shootIntervalRange=200,this.bulletSpeed=7,this.maxHp=30,this.hp=this.maxHp,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.6,this.coinChance=.9,this.lastShootTime=0,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-bot-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const a=this.speed+Math.random();this.speed=a,this.rotateSpeed=a;const n=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,n.x,n.y)}act(e,t){this.update(e,t),super.act(e,t)}update(e,t){const{scene:s,lastShootTime:a}=this,o=s.gameTime;if(this.updateSafeArea(e,t),this.updateBase(e,t),o>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),o>a){const e=s.player.body;this.shoot(new i.Vector(e.x,e.y))}}updateBase(e,t){const{scene:s,body:i,angle:a,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=o.angleToRadians(a);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=o.getNearestAngle(a,n,r*h),this.body.angle=a-90}shoot(e){const{body:t,bulletSpeed:s,shootInterval:a,shootIntervalRange:r,weaponDamage:h}=this;this.scene.game.soundManager.play(n.ESoundName.enemyLaser);const l=o.getAngleBetweenPointsInRadians(e,new i.Vector(t.x,t.y));this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:n.EOwner.enemy,speed:s,angle:o.angleToDegrees(l),sprite:"laser-red",explodeSprite:"explode-red",damage:h}),this.lastShootTime=this.scene.gameTime+a+Math.random()*r}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Bot=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hunter=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10);var h;!function(e){e.moving="moving",e.stop="stop",e.rotate="rotate",e.attack="attack"}(h||(h={}));class l extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.hunter,t.pos),this.weaponDamage=10,this.chanceToShoot=.25,this.lastShootTime=0,this.shootIntervalTime=1200,this.attackEndTime=0,this.attackIntervalTime=3e3,this.attackShootIntervalTime=325,this.attackSpreadRange=10,this.attackHunting=!0,this.lastChangeTargetTime=0,this.changeTargetTimeInterval=[1e3,2e3],this.rotateSpeed=2,this.currentRotateSpeed=this.rotateSpeed,this.rotateTimer=0,this.rotateIntervalTimer=3e3,this.maxSpeed=2,this.speed=2,this.speedIncrease=.05,this.stopEndTime=0,this.stopIntervalTime=3e3,this.stopIntervalRangeTime=1e3,this.coinChance=.9,this.bodySize=36,this.depth=a.depths.enemies,this.scale=.7,this.maxHp=70,this.hp=this.maxHp,this.bulletSpeed=7,this.behavior=h.moving,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-hunter-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const a=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,a.x,a.y),this.setStopEndTime(!0)}act(e,t){this.update(e,t),super.act(e,t)}update(e,t){const{scene:s,body:a,lastShootTime:n,chanceToShoot:r,behavior:l,speedIncrease:d,stopEndTime:c,attackHunting:u,attackIntervalTime:m}=this,p=s.player.body,g=s.gameTime;switch(this.updateSafeArea(g,t),this.updateBase(g,t),l){case h.moving:if(this.speed<this.maxSpeed&&(this.speed+=d*s.deltaTime),g>n){if(Math.random()>1-r){const e=o.getAngleBetweenPointsInDegrees(new i.Vector(p.x,p.y),new i.Vector(a.x,a.y));this.shoot(e)}this.lastShootTime=g+this.shootIntervalTime}g>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),g>c&&(this.behavior=h.stop);break;case h.stop:this.speed>0?this.speed-=d*s.deltaTime:this.setRotateBehavior();break;case h.rotate:this.setTargetAngle(new i.Vector(p.x,p.y)),g>n&&(this.shoot(this.angle,this.attackSpreadRange),this.lastShootTime=g+this.attackShootIntervalTime),o.getAngleDiff(this.targetAngle,this.angle)<=4?this.setAttackBehavior():g>this.rotateTimer&&this.setMovingBehavior();break;case h.attack:(u||g>this.attackEndTime-m/3)&&this.setTargetAngle(new i.Vector(p.x,p.y)),this.speed<this.maxSpeed&&(this.speed+=d*s.deltaTime),g>n&&(this.shoot(this.angle,this.attackSpreadRange),this.lastShootTime=g+this.attackShootIntervalTime),g>this.attackEndTime&&this.setMovingBehavior()}}updateBase(e,t){const{scene:s,body:i,angle:a,targetAngle:n,currentRotateSpeed:r}=this,{deltaTime:h}=s,l=o.angleToRadians(a);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=o.getNearestAngle(a,n,r*h),this.body.angle=a-90}setAttackBehavior(){const{scene:e,rotateSpeed:t}=this,s=e.gameTime;this.attackEndTime=s+this.attackIntervalTime,this.currentRotateSpeed=t,this.attackHunting=!0,this.behavior=h.attack}setStopEndTime(e=!1){const{scene:t,stopIntervalTime:s,stopIntervalRangeTime:i}=this,a=t.gameTime;this.stopEndTime=e?a+1e3+o.getRandomInt(0,s):a+s+o.getRandomInt(0,i)}setMovingBehavior(){const{scene:e,changeTargetTimeInterval:t,shootIntervalTime:s}=this,i=e.gameTime;this.setStopEndTime(),this.lastChangeTargetTime=i+t[0],this.lastShootTime=i+s,this.behavior=h.moving}setRotateBehavior(){const{scene:e,rotateIntervalTimer:t,rotateSpeed:s}=this,i=e.gameTime;this.speed=0,this.rotateTimer=i+t,this.currentRotateSpeed=s+1,this.behavior=h.rotate}shoot(e,t=0){const{body:s,bulletSpeed:a,weaponDamage:r}=this,h=o.spreadRadians(o.angleToRadians(e),t);this.scene.game.soundManager.play(n.ESoundName.enemyLaser),this.scene.utils.createSphereBullet({pos:new i.Vector(s.x,s.y),owner:n.EOwner.enemy,speed:a,angle:o.angleToDegrees(h),sprite:"laser-red",explodeSprite:"explode-red",damage:r})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Hunter=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UFO=void 0;const i=s(3),a=s(2),o=s(1),n=s(0),r=s(10);var h;!function(e){e.moving="moving",e.stop="stop",e.attack="attack"}(h||(h={}));class l extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.ufo,t.pos),this.weaponDamage=10,this.chanceToShoot=.25,this.lastShootTime=0,this.shootIntervalTime=1200,this.attackEndTime=0,this.attackIntervalTime=1e3,this.lastChangeTargetTime=0,this.changeTargetTimeInterval=[1e3,2e3],this.rotateSpeed=.5,this.maxSpeed=1,this.speed=1,this.speedIncrease=.02,this.stopEndTime=0,this.stopIntervalTime=1500,this.stopIntervalRangeTime=2500,this.coinChance=.9,this.bodySize=36,this.depth=o.depths.enemies,this.scale=.7,this.maxHp=70,this.hp=this.maxHp,this.bulletSpeed=7,this.behavior=h.moving,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-ufo"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y),this.setStopEndTime()}act(e,t){this.update(e,t),super.act(e,t)}update(e,t){const{scene:s,body:n,lastShootTime:r,shootIntervalTime:l,chanceToShoot:d,behavior:c,speedIncrease:u,stopEndTime:m}=this,p=s.player.body,g=s.gameTime;switch(this.updateSafeArea(g,t),this.updateBase(g,t),c){case h.moving:if(this.speed<this.maxSpeed&&(this.speed+=u*this.scene.deltaTime),g>r){if(Math.random()>1-d){const e=a.getAngleBetweenPointsInDegrees(new i.Vector(p.x,p.y),new i.Vector(n.x,n.y));this.shoot(e,!1)}this.lastShootTime=g+l}g>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),g>m&&!this.isOutsideSafeArea(o.enemySafeAreaPercentage.x,o.enemySafeAreaPercentage.y)&&(this.behavior=h.stop);break;case h.stop:this.speed>0?this.speed-=u*s.deltaTime:(this.attackEndTime=g+this.attackIntervalTime,this.behavior=h.attack);break;case h.attack:g>this.attackEndTime&&(this.makeCircleAttack(),this.setMovingBehavior())}}updateBase(e,t){const{scene:s,body:i,angle:o,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=a.angleToRadians(o);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=a.getNearestAngle(o,n,r*h),this.body.angle+=this.speed*h}setStopEndTime(){const{scene:e,stopIntervalTime:t,stopIntervalRangeTime:s}=this,i=e.gameTime;this.stopEndTime=i+t+a.getRandomInt(0,s)}setMovingBehavior(){const{scene:e,changeTargetTimeInterval:t,shootIntervalTime:s}=this,i=e.gameTime;this.setStopEndTime(),this.lastChangeTargetTime=i+t[0],this.lastShootTime=i+s,this.behavior=h.moving}makeCircleAttack(){const e=45*Math.random();for(let t=0;t<8;t++)this.shoot(e+45*t,!0)}shoot(e,t=!0){const{body:s,bulletSpeed:a,weaponDamage:o}=this;t?this.scene.game.soundManager.play(n.ESoundName.ufoShot):this.scene.game.soundManager.play(n.ESoundName.enemyLaser),this.scene.utils.createSphereBullet({pos:new i.Vector(s.x,s.y),owner:n.EOwner.enemy,speed:a,angle:e,sprite:t?"sphere-bullet":"laser-red",explodeSprite:"explode-red",damage:o,scale:t?.35:1,bodySize:t?32:6})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),this.makeCircleAttack(),super.destroy()}}t.UFO=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Flyer=void 0;const i=s(3),a=s(1),o=s(2),n=s(15),r=s(0),h=s(10);class l extends h.Enemy{constructor(e,t){super(e,r.EEnemyName.flyer,t.pos),this.maxSpeed=4,this.minSpeed=1,this.speed=2,this.speedChange=.1,this.rotateSpeed=2,this.bulletSpeed=7,this.lastShootTime=0,this.shootTime=1200,this.shootTimeInterval=200,this.weaponDamage=10,this.lastShadowTime=0,this.shadowTime=50,this.maxHp=50,this.hp=this.maxHp,this.coinChance=.9,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.6,this.changeTargetTimeInterval=[0,0],this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-flyer"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const a=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,a.x,a.y)}act(e,t){this.update(e,t),super.act(e,t)}update(e,t){this.updateSafeArea(e,t),this.updateBase(e,t),this.updateMovement(e,t),this.updateAttack(e,t),this.updateShadows()}updateBase(e,t){const{scene:s,body:i,angle:a,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=o.angleToRadians(a);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=o.getNearestAngle(a,n,r*h),this.body.angle=a-90}updateMovement(e,t){const{speedChange:s,angle:i,targetAngle:a}=this;o.getAngleDiff(i,a)<3?this.speed<this.maxSpeed&&(this.speed+=s*this.scene.deltaTime):this.speed>this.minSpeed&&(this.speed-=s*this.scene.deltaTime)}updateAttack(e,t){const{scene:s,body:a,shootTime:n,shootTimeInterval:r}=this,h=s.gameTime;if(h>this.lastShootTime){const e=s.player.body,t=new i.Vector(e.x,e.y),l=o.getAngleBetweenPointsInDegrees(t,new i.Vector(a.x,a.y));if(Math.random()>.1){const e=o.angleToDegrees(.25+.3*Math.random());this.shoot(l+e),this.shoot(l-e)}else this.shoot(l);this.lastShootTime=h+n+Math.random()*r}}updateShadows(){const{scene:e,lastShadowTime:t,shadowTime:s}=this,i=e.gameTime;i>t&&(this.lastShadowTime=i+s,this.createShadow())}createShadow(){const{scene:e,body:t,scale:s,angle:a}=this,o=.25*Math.max(this.maxSpeed-this.speed,0);e.effects.push(new n.Shadow(e,{pos:new i.Vector(t.x,t.y),sprite:"enemy-flyer",lifeTime:250,scale:s,angle:a-90,alpha:.4-o}))}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:a}=this;this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:r.EOwner.enemy,speed:s,angle:e,sprite:"laser-red",explodeSprite:"explode-red",damage:a})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Flyer=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Destroyer=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10);class h extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.destroyer,t.pos),this.mainState="move",this.states={move:{active:!0,timeToStop:this.getTimeToStop(),methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},stop:{active:!1,methods:{activate:this.activateStopState.bind(this),deactivate:this.deactivateStopState.bind(this),update:this.updateStopState.bind(this)}},reload:{active:!1,timeToShot:30,methods:{activate:this.activateReloadState.bind(this),deactivate:this.deactivateReloadState.bind(this),update:this.updateReloadState.bind(this)}},rotateAndShot:{active:!1,shots:0,methods:{activate:this.activateRotateAndShotState.bind(this),deactivate:this.deactivateRotateAndShotState.bind(this),update:this.updateRotateAndShotState.bind(this)}}},this.maxSpeed=1.5,this.speed=this.maxSpeed,this.changeSpeed=.01,this.rotateSpeed=1.5,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.bulletSpeed=7,this.maxHp=90,this.hp=this.maxHp,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.75,this.coinChance=.9,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-destroyer-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const a=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,a.x,a.y)}act(e,t){this.updateMainState(e,t),this.updateStates(e,t),super.act(e,t)}updateMainState(e,t){const{mainState:s}=this;switch(s){case"move":this.states.move.timeToStop<=0&&this.setStopState();break;case"stop":this.speed<=0&&this.setReloadState();break;case"reload":this.states.reload.timeToShot<=0&&this.setRotateAndShotState();break;case"rotateAndShot":this.angle===this.targetAngle&&(this.states.rotateAndShot.shots+=1,this.shoot(this.angle),this.states.rotateAndShot.shots>=10?(this.states.rotateAndShot.shots=0,this.setMoveState()):this.setReloadState())}}setMoveState(){this.mainState="move",this.deactivateAllStates(),this.activateMoveState()}setStopState(){this.mainState="stop",this.deactivateMoveState(),this.activateStopState()}setReloadState(){this.mainState="reload",this.deactivateStopState(),this.deactivateRotateAndShotState(),this.activateReloadState()}setRotateAndShotState(){this.mainState="rotateAndShot",this.deactivateReloadState(),this.activateRotateAndShotState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveState(){this.states.move.active=!0,this.states.move.timeToStop=this.getTimeToStop(),this.lastChangeTargetTime=this.scene.gameTime+this.changeTargetTimeInterval[0],this.targetAngle=this.angle}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s}=this,i=s.gameTime;this.states.move.timeToStop-=this.scene.deltaTime,this.updateSafeArea(e,t),this.updateBase(e,t),this.updateSpeed(),this.updateAngle(e,t),i>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval()}activateStopState(){this.states.stop.active=!0}deactivateStopState(){this.states.stop.active=!1}updateStopState(e,t){this.updateBase(e,t),this.speed>0&&(this.speed=Math.max(this.speed-this.changeSpeed*this.scene.deltaTime,0))}activateReloadState(){this.states.reload.active=!0,this.states.reload.timeToShot=30}deactivateReloadState(){this.states.reload.active=!1}updateReloadState(e,t){this.states.reload.timeToShot-=this.scene.deltaTime}activateRotateAndShotState(){const{scene:e}=this,t=e.player.body;this.states.rotateAndShot.active=!0,this.setTargetAngle(new i.Vector(t.x,t.y))}deactivateRotateAndShotState(){this.states.rotateAndShot.active=!1}updateRotateAndShotState(e,t){this.updateAngle(e,t)}updateBase(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=o.angleToRadians(a);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateSpeed(){this.speed<this.maxSpeed&&(this.speed=Math.min(this.speed+this.changeSpeed*this.scene.deltaTime,this.maxSpeed))}updateAngle(e,t){const{scene:s,angle:i,targetAngle:a,rotateSpeed:n}=this;this.angle=o.getNearestAngle(i,a,n*s.deltaTime),this.body.angle=i-90}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:a}=this;[1,-1].forEach(r=>{const h=o.angleToRadians(e+40*r),l=o.getOffsetByRadians(h,40);this.scene.utils.createSphereBullet({pos:new i.Vector(t.x+l.x,t.y+l.y),owner:n.EOwner.enemy,speed:s,angle:e,sprite:"laser-red",explodeSprite:"explode-red",damage:a})})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}getTimeToStop(){return 50+150*Math.random()}}t.Destroyer=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stealth=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10);class h extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.stealth,t.pos),this.mainState="moveToPlayer",this.states={moveToPlayer:{active:!0,time:300,methods:{activate:this.activateMoveToPlayerState.bind(this),deactivate:this.deactivateMoveToPlayerState.bind(this),update:this.updateMoveToPlayerState.bind(this)}},moveToPlayerArea:{active:!1,time:300,methods:{activate:this.activateMoveToPlayerAreaState.bind(this),deactivate:this.deactivateMoveToPlayerAreaState.bind(this),update:this.updateMoveToPlayerAreaState.bind(this)}},visibility:{active:!0,time:0,methods:{activate:this.activateVisibilityState.bind(this),deactivate:this.deactivateVisibilityState.bind(this),update:this.updateVisibilityState.bind(this)}},shooting:{active:!1,reload:0,methods:{activate:this.activateShootingState.bind(this),deactivate:this.deactivateShootingState.bind(this),update:this.updateShootingState.bind(this)}}},this.maxSpeed=2.7,this.speed=this.maxSpeed,this.rotateSpeed=1.8,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.bulletSpeed=7,this.maxHp=50,this.hp=this.maxHp,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.6,this.coinChance=.9,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-stealth-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t),s.setAlpha(0);const a=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,a.x,a.y)}act(e,t){this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),this.updateMainState(e,t),this.updateStates(e,t),super.act(e,t)}updateMainState(e,t){const{mainState:s,scene:a}=this,n=a.player.body;if(this.states.shooting.reload<=0){o.getDistanceBetweenPoints(new i.Vector(n.x,n.y),new i.Vector(this.body.x,this.body.y))<250?(this.activateShootingState(),this.deactivateVisibilityState()):this.states.shooting.active&&(this.deactivateShootingState(),this.activateVisibilityState())}switch(s){case"moveToPlayer":this.states.moveToPlayer.time<=0&&this.setMoveToPlayerAreaState();break;case"moveToPlayerArea":this.states.moveToPlayerArea.time<=0&&this.setMoveToPlayerState()}}setMoveToPlayerState(){this.mainState="moveToPlayer",this.deactivateMoveToPlayerAreaState(),this.activateMoveToPlayerState()}setMoveToPlayerAreaState(){this.mainState="moveToPlayerArea",this.deactivateMoveToPlayerState(),this.activateMoveToPlayerAreaState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveToPlayerState(){this.states.moveToPlayer.active=!0,this.states.moveToPlayer.time=300}deactivateMoveToPlayerState(){this.states.moveToPlayer.active=!1}updateMoveToPlayerState(e,t){const s=this.scene.player.body;this.states.moveToPlayer.time-=this.scene.deltaTime,this.setTargetAngle(new i.Vector(s.x,s.y))}activateMoveToPlayerAreaState(){const e=this.scene.player.body,t=o.getOffsetByAngle(360*Math.random(),100);this.setTargetAngle(new i.Vector(e.x+t.x,e.y+t.y)),this.states.moveToPlayerArea.active=!0,this.states.moveToPlayerArea.time=300}deactivateMoveToPlayerAreaState(){this.states.moveToPlayerArea.active=!1}updateMoveToPlayerAreaState(){this.states.moveToPlayerArea.time-=this.scene.deltaTime}activateVisibilityState(){this.states.visibility.active=!0,this.states.visibility.time=0}deactivateVisibilityState(){this.states.visibility.active=!1}updateVisibilityState(){const{scene:e}=this;this.states.visibility.time+=this.scene.deltaTime,this.states.visibility.time>300?this.body.setAlpha(Math.min(this.body.alpha+=.005*e.deltaTime,.25)):this.body.setAlpha(Math.max(this.body.alpha-=.005*e.deltaTime,0)),this.states.visibility.time>360&&(this.states.visibility.time=0)}activateShootingState(){this.states.shooting.active=!0}deactivateShootingState(){this.states.shooting.active=!1}updateShootingState(){const{scene:e}=this,t=this.scene.player.body;if(this.body.setAlpha(Math.min(this.body.alpha+=.005*e.deltaTime,.25)),this.states.shooting.reload>0)this.states.shooting.reload-=e.deltaTime;else{const e=new i.Vector(t.x,t.y),s=new i.Vector(this.body.x,this.body.y);this.shoot(o.getAngleBetweenPointsInDegrees(e,s)),this.states.shooting.reload=40}}updateBase(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=o.angleToRadians(a);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateAngle(e,t){const{scene:s,angle:i,targetAngle:a,rotateSpeed:n}=this;this.angle=o.getNearestAngle(i,a,n*s.deltaTime),this.body.angle=i-90}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:a}=this;this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:n.EOwner.enemy,speed:s,angle:e,sprite:"laser-red",explodeSprite:"explode-red",damage:a})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Stealth=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissileCarrier=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10);class h extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.missileCarrier,t.pos),this.mainState="move",this.mainStateTime=0,this.states={move:{active:!0,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},moveToPlayer:{active:!1,shots:0,reload:0,methods:{activate:this.activateMoveToPlayerState.bind(this),deactivate:this.deactivateMoveToPlayerState.bind(this),update:this.updateMoveToPlayerState.bind(this)}}},this.maxSpeed=1.5,this.speed=this.maxSpeed,this.rotateSpeed=2,this.weaponDamage=10,this.maxHp=100,this.hp=this.maxHp,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.75,this.coinChance=.9,this.changeTargetTimeInterval=[1e3,2e3],this.nextBulletDir=1,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-missile-carrier-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const a=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,a.x,a.y)}act(e,t){this.updateMainState(e,t),this.updateStates(e,t),super.act(e,t)}updateMainState(e,t){const{mainState:s}=this;switch(this.mainStateTime+=this.scene.deltaTime,s){case"move":this.mainStateTime>175&&this.setMoveToPlayerState();break;case"moveToPlayer":this.states.moveToPlayer.shots>=2&&this.setMoveState()}}setMoveState(){const{scene:e}=this;this.mainState="move",this.mainStateTime=0;const t=Math.random()*this.changeTargetTimeInterval[1];this.lastChangeTargetTime=e.gameTime+t,this.deactivateAllStates(),this.activateMoveState()}setMoveToPlayerState(){this.mainState="moveToPlayer",this.mainStateTime=0,this.states.moveToPlayer.shots=0,this.deactivateAllStates(),this.activateMoveToPlayerState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveState(){this.states.move.active=!0}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s}=this,i=s.gameTime;this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),i>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval()}activateMoveToPlayerState(){this.states.moveToPlayer.active=!0}deactivateMoveToPlayerState(){this.states.moveToPlayer.active=!1}updateMoveToPlayerState(e,t){const{scene:s}=this,a=s.player.body;this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),this.setTargetAngle(new i.Vector(a.x,a.y));const n=o.getAngleDiff(this.targetAngle,this.angle);this.states.moveToPlayer.reload>0&&(this.states.moveToPlayer.reload-=s.deltaTime),n<10&&this.states.moveToPlayer.reload<=0&&(this.states.moveToPlayer.shots+=1,this.states.moveToPlayer.reload=60,this.shoot(this.angle))}updateBase(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=o.angleToRadians(a);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateAngle(e,t){const{angle:s,targetAngle:i,rotateSpeed:a}=this,n=(this.states.moveToPlayer.active?1.25*a:a)*this.scene.deltaTime;this.angle=o.getNearestAngle(s,i,n),this.body.angle=s-90}shoot(e){const{body:t,weaponDamage:s}=this,a=this.nextBulletDir,r=o.angleToRadians(e+40*a),h=o.getOffsetByRadians(r,40);this.scene.utils.createRocketBullet({pos:new i.Vector(t.x+h.x,t.y+h.y),owner:n.EOwner.enemy,angle:e,sprite:"rocket-bullet",explodeSprite:"explode-red",damage:s}),this.nextBulletDir=0-this.nextBulletDir}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.MissileCarrier=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaserShip=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10);class h extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.laserShip,t.pos),this.mainState="move",this.mainStateTime=0,this.states={move:{active:!0,stop:!1,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},rotate:{active:!1,methods:{activate:this.activateRotateState.bind(this),deactivate:this.deactivateRotateState.bind(this),update:this.updateRotateState.bind(this)}},shoot:{active:!1,isLaserActive:!1,shots:0,methods:{activate:this.activateShootState.bind(this),deactivate:this.deactivateShootState.bind(this),update:this.updateShootState.bind(this)}}},this.maxSpeed=2,this.speed=this.maxSpeed,this.changeSpeed=.03,this.rotateSpeed=2,this.weaponDamage=30,this.maxHp=120,this.hp=this.maxHp,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.65,this.coinChance=.9,this.changeTargetTimeInterval=[1e3,2e3],this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-laser-ship"),this.onLaserEnds=this.onLaserEnds.bind(this),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const a=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,a.x,a.y)}act(e,t){this.updateMainState(e,t),this.updateStates(e,t),super.act(e,t)}updateMainState(e,t){const{mainState:s}=this;switch(this.mainStateTime+=this.scene.deltaTime,s){case"move":this.mainStateTime>150&&(this.states.move.stop=!0),this.speed<=0&&this.setRotateState();break;case"rotate":o.getAngleDiff(this.targetAngle,this.angle)<=0&&this.setShootState();break;case"shoot":this.states.shoot.isLaserActive||(this.states.shoot.shots+=1,this.states.shoot.shots>=3?(this.states.shoot.shots=0,this.setMoveState()):this.setRotateState())}}setMoveState(){const{scene:e}=this;this.mainState="move",this.mainStateTime=0;const t=Math.random()*this.changeTargetTimeInterval[1];this.lastChangeTargetTime=e.gameTime+t,this.deactivateAllStates(),this.activateMoveState()}setRotateState(){this.mainState="rotate",this.deactivateAllStates(),this.activateRotateState()}setShootState(){this.mainState="shoot",this.deactivateAllStates(),this.activateShootState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveState(){this.states.move.active=!0,this.states.move.stop=!1}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s}=this,i=s.gameTime,a=this.states.move;this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),a.stop?this.speed=Math.max(this.speed-this.changeSpeed*s.deltaTime,0):(this.speed=Math.min(this.speed+this.changeSpeed*s.deltaTime,this.maxSpeed),i>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval())}activateRotateState(){this.states.rotate.active=!0}deactivateRotateState(){this.states.rotate.active=!1}updateRotateState(e,t){const{scene:s}=this,a=s.player.body;this.setTargetAngle(new i.Vector(a.x,a.y)),this.updateAngle(e,t)}activateShootState(){this.states.shoot.active=!0,this.states.shoot.isLaserActive=!0,this.shoot()}deactivateShootState(){this.states.shoot.active=!1}updateShootState(e,t){}updateBase(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=o.angleToRadians(a);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateAngle(e,t){const{angle:s,targetAngle:i,rotateSpeed:a}=this,n=(this.states.rotate.active?1.5*a:a)*this.scene.deltaTime;this.angle=o.getNearestAngle(s,i,n),this.body.angle=s-90}shoot(){const{body:e,angle:t,weaponDamage:s}=this,a=o.getOffsetByAngle(t,40*this.scale);this.scene.utils.createRayBullet({pos:new i.Vector(e.x+a.x,e.y+a.y),owner:n.EOwner.enemy,angle:t,sprite:"ray-bullet-red",explodeSprite:"explode-red",damage:s,delay:30,onDestroy:this.onLaserEnds,isLaserActive:()=>this.hp>0})}onOutOfSafeArea(e){this.setTargetAngle(e)}onLaserEnds(){this.states.shoot.isLaserActive=!1}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.LaserShip=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Defender=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(10),h=40,l=4;class d extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.defender,t.pos),this.speed=1.7,this.rotateSpeed=2,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.shots=4,this.bulletSpeed=7,this.maxHp=120,this.hp=this.maxHp,this.bodySize=32,this.depth=a.depths.enemies,this.scale=.6,this.coinChance=.9,this.lastShootTime=0,this.shieldMaxHp=150,this.shieldHp=this.shieldMaxHp,this.shieldBodySize=80,this.isShieldActive=!0,this.shieldTime=0,this.shieldCanUpdate=!1,this.nextShieldUpdateTime=0,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-defender-ship"),this.shieldGraphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),this.shieldGraphics.setDepth(a.depths.graphics2),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t),this.shieldStatusBar=new Phaser.Geom.Rectangle(0,-100,h,l);const a=this.speed+Math.random();this.speed=a,this.rotateSpeed=a;const n=o.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,n.x,n.y),this.initShield()}initShield(){this.shieldBody=this.scene.physics.add.image(this.body.x,this.body.y,"shield"),this.shieldBody.setImmovable(!0)}act(e,t){this.update(e,t),super.act(e,t)}update(e,t){const{scene:s,lastShootTime:a}=this,o=s.gameTime;if(this.updateSafeArea(e,t),this.updateBase(e,t),this.updateShield(),o>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),o>a){const e=s.player.body;this.shoot(new i.Vector(e.x,e.y))}}updateBase(e,t){const{scene:s,body:i,angle:a,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=o.angleToRadians(a);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=o.getNearestAngle(a,n,r*h),this.body.angle=a-90}updateShield(){const{scene:e,shieldBodySize:t}=this;this.shieldBody.x=this.body.x,this.shieldBody.y=this.body.y,this.shieldBody.angle=this.body.angle+180;const s=o.getOffsetByRadians(o.angleToRadians(this.angle)+Math.PI,25),i=o.getBodyPosWithOffset(this.shieldBody.displayWidth,this.shieldBody.displayHeight,1,t,s);this.shieldBody.setCircle(t,i.x,i.y),this.shieldBody.visible=this.isShieldActive&&this.shieldHp>0,!this.shieldCanUpdate&&this.shieldHp<this.shieldMaxHp&&e.gameTime>this.lastHitTime+1*a.time.second&&(this.shieldCanUpdate=!0,this.nextShieldUpdateTime=e.gameTime+a.time.second/2),e.gameTime<this.lastHitTime+1*a.time.second&&(this.shieldCanUpdate=!1),this.shieldCanUpdate&&e.gameTime>this.nextShieldUpdateTime&&(this.shieldHp=Math.min(this.shieldHp+30,this.shieldMaxHp),this.shieldCanUpdate=!1)}draw(){this.shieldGraphics.clear(),this.drawShieldStatusBar({firstColor:a.colors.aqua,secondColor:a.colors.white,healthbarRect:this.shieldStatusBar,hp:this.shieldHp,maxHp:this.shieldMaxHp,fromLeft:!1}),super.draw()}drawShieldStatusBar(e){const t=this.shieldGraphics,{healthbarRect:s,firstColor:i,secondColor:o,hp:n,maxHp:r}=e;let d=n/r;e.fromLeft&&(d=1-d),t.fillStyle(o),s.width=h,t.fillRectShape(s),t.fillStyle(i),s.width=Math.max(h*d,0),t.fillRectShape(s),t.lineStyle(2,a.colors.white),s.width=h,t.strokeRectShape(s),s.x=this.body.x-h/2,s.y=this.body.y-this.body.displayHeight+2*l,n<r&&this.shieldHp>0?t.setAlpha(this.body.alpha):t.setAlpha(0)}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:a}=this,r=o.spreadAngle(o.getAngleBetweenPointsInDegrees(e,new i.Vector(t.x,t.y)),60);this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:n.EOwner.enemy,speed:s,angle:r,sprite:"triangle-bullet-red",explodeSprite:"explode-red",damage:a}),this.shots-=1;const h=this.shots<=0?1200:200;this.shots<=0&&(this.shots=4),this.lastShootTime=this.scene.gameTime+h+Math.random()}onOutOfSafeArea(e){this.setTargetAngle(e)}hitShield(e){if(this.lastHitTime=this.scene.gameTime,!this.isShieldActive||this.shieldHp<=0)return;const t=new i.Vector(e.body.x,e.body.y),s=new i.Vector(this.body.x,this.body.y),a=o.getDistanceBetweenPoints(t,s),n=o.getAngleDiff(this.angle,e.getAngle());a<70&&n>45&&(e.explode(),this.shieldHp=Math.max(this.shieldHp-e.damage,0))}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),this.shieldBody.destroy(),this.shieldGraphics.clear(),super.destroy()}}t.Defender=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnemiesArray=t.repeatEnemy=void 0;t.repeatEnemy=(e,t)=>new Array(t).fill(e);t.getEnemiesArray=(...e)=>e.reduce((e,s)=>Array.isArray(s)?[...e,...t.repeatEnemy(s[0],s[1])]:[...e,s],[])},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss3=t.Boss2=t.Boss1=t.Boss=void 0;var i=s(23);Object.defineProperty(t,"Boss",{enumerable:!0,get:function(){return i.Boss}});var a=s(107);Object.defineProperty(t,"Boss1",{enumerable:!0,get:function(){return a.Boss1}});var o=s(108);Object.defineProperty(t,"Boss2",{enumerable:!0,get:function(){return o.Boss2}});var n=s(109);Object.defineProperty(t,"Boss3",{enumerable:!0,get:function(){return n.Boss3}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss1=void 0;const i=s(20),a=s(2),o=s(3),n=s(0),r=s(1),h=s(23),l=a.getDeviceType(),d=i.bossesConfig.bosses.ghost.paramsByDevice;class c extends h.Boss{constructor(e){super(e,n.EBossName.ghost),this.maxHp=0,this.hp=0,this.rewardedScore=0,this.scale=.5,this.alpha=1,this.bodySize=175,this.maxSpeed=2.2,this.speed=this.maxSpeed,this.changeSpeed=.02,this.rotateSpeed=1.25,this.moveAngle=0,this.maxEnergy=1e3,this.energy=this.maxEnergy,this.bulletDamage=10,this.mainState="init",this.mainStateTime=0,this.states={move:{active:!0,stopNearTarget:!0,targetPoint:this.scene.utils.getRandomPos(30,30),isNearTarget:!1,timeoutTime:0,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},focusOnPlayer:{active:!0,methods:{activate:this.activateFocusOnPlayerState.bind(this),deactivate:this.deactivateFocusOnPlayerState.bind(this),update:this.updateFocusOnPlayerState.bind(this)}},circleAttack:{active:!1,bulletsOrder:[],nextBulletTime:0,reloadTime:50,methods:{activate:this.activateCircleAttackState.bind(this),deactivate:this.deactivateCircleAttackState.bind(this),update:this.updateCircleAttackState.bind(this)}},laserAttack:{active:!1,bullets:0,nextBulletTime:0,reloadTime:d.laserAttackReloadTime[l],methods:{activate:this.activateLaserAttackState.bind(this),deactivate:this.deactivateLaserAttackState.bind(this),update:this.updateLaserAttackState.bind(this)}},laserDoubleAttack:{active:!1,bullets:0,sideIndex:1,nextBulletTime:0,reloadTime:d.laserDoubleAttackReloadTime[l],methods:{activate:this.activateLaserDoubleAttackState.bind(this),deactivate:this.deactivateLaserDoubleAttackState.bind(this),update:this.updateLaserDoubleAttackState.bind(this)}},splashAttack:{active:!1,shots:0,nextShotTime:0,reloadTime:d.splashAttackReloadTime[l],methods:{activate:this.activateSplashAttackState.bind(this),deactivate:this.deactivateSplashAttackState.bind(this),update:this.updateSplashAttackState.bind(this)}},explodeAttack:{active:!1,bullets:0,nextBulletTime:0,reloadTime:d.explodeAttackReloadTime[l],methods:{activate:this.activateExplodeAttackState.bind(this),deactivate:this.deactivateExplodeAttackState.bind(this),update:this.updateExplodeAttackState.bind(this)}},visibility:{active:!1,isVisible:!0,nextChangeTime:0,reloadTime:5e3,methods:{activate:this.activateVisibilityState.bind(this),deactivate:this.deactivateVisibilityState.bind(this),update:this.updateVisibilityState.bind(this)}},bombs:{active:!1,bombs:0,nextBombTime:0,reloadTime:2e3,methods:{activate:this.activateBombsState.bind(this),deactivate:this.deactivateBombsState.bind(this),update:this.updateBombsState.bind(this)}},centerAttack:{active:!1,shots:0,nextShotTime:0,lastOffset:0,reloadTime:700,methods:{activate:this.activateCenterAttackState.bind(this),deactivate:this.deactivateCenterAttackState.bind(this),update:this.updateCenterAttackState.bind(this)}}},this.setPropertiesFromConfig();const t=this.scene.utils.getRandomPointOutside({distance:200}),s=this.scene.getGameCenter();this.body=e.physics.add.image(t.x,t.y,"boss-1-ship"),this.moveAngle=a.getAngleBetweenPointsInDegrees(new o.Vector(s.x,s.y),t),this.angle=this.moveAngle,this.body.setImmovable(!0),this.body.setScale(this.scale),this.body.setDepth(r.depths.boss),this.centerBody(),this.initCollisions(),this.activateVisibilityState()}centerBody(){const{scale:e,bodySize:t}=this,s=a.getOffsetByAngle(this.angle,0),i=a.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t,s);this.body.setCircle(t,i.x,i.y)}act(e,t){const{angle:s}=this;this.body.active&&(this.updateMainState(),this.updateStates(),this.body.setAlpha(this.alpha),this.body.angle=s+90)}updateMainState(){const{mainState:e}=this,{isNearTarget:t}=this.states.move;switch(this.mainStateTime+=this.scene.deltaTime,e){case"init":this.mainStateTime>200&&this.setAttackState();break;case"attack":t?(this.activateCircleAttackState(),this.activateMoveState(),this.activateLaserAttackState()):this.energy<200?this.setMoveToCenterState():this.isAttackExisted()||this.setRandomAttack();break;case"moveToCenter":t&&this.setCenterAttackState();break;case"centerAttack":this.isAttackExisted()||this.setAttackState()}}setAttackState(){this.deactivateAllStates(),this.activateLaserAttackState(),this.activateMoveState(),this.activateFocusOnPlayerState(),this.energy=Math.max(this.energy+Math.random()*this.maxEnergy,this.maxEnergy),this.mainState="attack"}setMoveToCenterState(){const e=this.scene.getGameCenter();this.deactivateAllStates(),this.activateFocusOnPlayerState(),this.activateMoveState({targetPos:new o.Vector(e.x,e.y),noStopNearTarget:!0}),this.activateBombsState(),this.mainState="moveToCenter"}setCenterAttackState(){this.deactivateAllStates(),this.activateCenterAttackState(),this.activateFocusOnPlayerState(),this.speed=0,this.mainState="centerAttack"}updateStates(){Object.keys(this.states).forEach(e=>{this.states[e].active&&this.states[e].methods.update()})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{"visibility"!==e&&this.states[e].methods.deactivate()})}activateMoveState(e={}){var t;const s=this.states.move,i=null!==(t=e.targetPos)&&void 0!==t?t:this.scene.utils.getRandomPos(15,15);s.active=!0,s.targetPoint=i,s.timeoutTime=0,e.noStopNearTarget?s.stopNearTarget=!1:s.stopNearTarget=!0}deactivateMoveState(){this.states.move.active=!1,this.states.move.timeoutTime=0}activateFocusOnPlayerState(){this.states.focusOnPlayer.active=!0}deactivateFocusOnPlayerState(){this.states.focusOnPlayer.active=!1}activateCircleAttackState(){const e=[];for(let t=0;t<d.circleAttackBulletsCount[l];t++)e.push(t+1);const t=a.shuffleArray(e);this.states.circleAttack.active=!0,this.states.circleAttack.bulletsOrder=t}deactivateCircleAttackState(){this.states.circleAttack.active=!1,this.states.circleAttack.bulletsOrder=[]}activateLaserAttackState(){this.states.laserAttack.active=!0,this.states.laserAttack.bullets=6}deactivateLaserAttackState(){this.states.laserAttack.active=!1,this.states.laserAttack.bullets=0}activateLaserDoubleAttackState(){this.states.laserDoubleAttack.active=!0,this.states.laserDoubleAttack.bullets=12,this.energy-=100}deactivateLaserDoubleAttackState(){this.states.laserDoubleAttack.active=!1,this.states.laserDoubleAttack.bullets=0}activateSplashAttackState(){this.states.splashAttack.active=!0,this.states.splashAttack.shots=3,this.energy-=100}deactivateSplashAttackState(){this.states.splashAttack.active=!1,this.states.splashAttack.shots=0}activateExplodeAttackState(){this.states.explodeAttack.active=!0,this.states.explodeAttack.bullets=5,this.energy-=100}deactivateExplodeAttackState(){this.states.explodeAttack.active=!1,this.states.explodeAttack.bullets=0}activateVisibilityState(){const{scene:e,states:t}=this;t.visibility.active=!0,t.visibility.nextChangeTime=e.gameTime+t.visibility.reloadTime}deactivateVisibilityState(){this.states.visibility.active=!1}activateBombsState(){this.states.bombs.active=!0,this.states.bombs.bombs=d.bombsCount[l]}deactivateBombsState(){this.states.bombs.active=!1,this.states.bombs.bombs=0}activateCenterAttackState(){this.states.centerAttack.active=!0,this.states.centerAttack.shots=5}deactivateCenterAttackState(){this.states.centerAttack.active=!1,this.states.centerAttack.shots=0}updateMoveState(){const{scene:e,body:t,moveAngle:s,rotateSpeed:i}=this,{deltaTime:n}=e,r=this.states.move,{targetPoint:h}=r,l=new o.Vector(t.x,t.y),d=new o.Vector(h.x,h.y),c=a.getAngleBetweenPointsInDegrees(d,l),u=a.angleToRadians(s);t.x+=this.speed*Math.cos(u)*n,t.y+=this.speed*Math.sin(u)*n;const m=a.getDistanceBetweenPoints(l,d);if(this.moveAngle=a.getNearestAngle(s,c,i*e.deltaTime),r.isNearTarget=m<15,m<150&&(r.timeoutTime<120?r.timeoutTime+=e.deltaTime:r.isNearTarget=!0),this.states.move.stopNearTarget)if(m<200){Math.max(m/(200/this.maxSpeed))>this.speed?this.speed=Math.min(this.changeSpeed*e.deltaTime+this.speed,this.maxSpeed):this.speed=Math.max(this.speed-this.changeSpeed*e.deltaTime,.5)}else this.speed=Math.min(this.changeSpeed*e.deltaTime+this.speed,this.maxSpeed);else this.speed=Math.min(this.changeSpeed*e.deltaTime+this.speed,this.maxSpeed)}updateFocusOnPlayerState(){const{scene:e,body:t,angle:s,rotateSpeed:i}=this,n=e.utils.getAngleToPlayer(new o.Vector(t.x,t.y));this.angle=a.getNearestAngle(s,n,i*e.deltaTime)}updateCircleAttackState(){const{scene:e,body:t}=this,s=this.states.circleAttack;if(e.gameTime<s.nextBulletTime)return;const i=s.bulletsOrder.shift();if(i){const n=new o.Vector(t.x,t.y),r=360/d.circleAttackBulletsCount[l]*i,h=a.getOffsetByAngle(r,150),c=new o.Vector(n.x+h.x,n.y+h.y),u=d.circleAttackBulletsSizeTime[l];this.shootBullet({bulletPos:c,speed:0,angle:0,sprite:"sphere-bullet-blue",explodeSprite:"explode-blue",explodeScale:1.35,scale:.15,bodySize:32,states:[{name:"changeSize",time:u,scaleFn:t=>t+.01*e.deltaTime},{name:"changeAngle",angleFn:()=>{const t=e.utils.getAngleToPlayer(c);return a.spreadAngle(t,20)}},{name:"changeSpeed",time:0,speedFn:()=>2+Math.random()}]}),s.nextBulletTime=e.gameTime+s.reloadTime}else this.deactivateCircleAttackState()}updateLaserAttackState(){const{scene:e,body:t}=this,s=this.states.laserAttack;if(s.bullets<=0)this.deactivateLaserAttackState();else if(e.gameTime>s.nextBulletTime){const i=new o.Vector(t.x,t.y);this.shootBullet({bulletPos:i,angle:this.scene.utils.getAngleToPlayer(new o.Vector(t.x,t.y)),speed:3,sprite:"laser-red"}),s.nextBulletTime=e.gameTime+s.reloadTime,s.bullets-=1}}updateLaserDoubleAttackState(){const{scene:e,body:t}=this,s=this.states.laserDoubleAttack;if(s.bullets<=0)this.deactivateLaserDoubleAttackState();else if(e.gameTime>s.nextBulletTime){const i=this.angle+110*s.sideIndex,a=this.getAttackPos(i);this.shootBullet({bulletPos:a,angle:this.scene.utils.getAngleToPlayer(new o.Vector(t.x,t.y)),speed:5,sprite:"laser-aqua",explodeSprite:"explode-aqua"}),s.nextBulletTime=e.gameTime+s.reloadTime,s.bullets-=1,s.sideIndex=0-s.sideIndex}}updateSplashAttackState(){const{scene:e}=this,t=this.states.splashAttack;if(t.shots<=0)this.deactivateSplashAttackState();else if(e.gameTime>t.nextShotTime){const s=9,i=d.splashAttackBulletsOffset[l],a=Math.random()*i;for(let e=0;e<s;e++){const t=a+this.angle+e*i-Math.floor(s/2)*i,o=this.getAttackPos(t);this.shootBullet({bodySize:25,bulletPos:o,angle:t,speed:4,sprite:"sphere-bullet-purple",explodeSprite:"explode-purple",scale:.25})}t.nextShotTime=e.gameTime+t.reloadTime,t.shots-=1}}updateExplodeAttackState(){const{scene:e,body:t}=this,s=this.states.explodeAttack;if(s.bullets<=0)this.deactivateExplodeAttackState();else if(e.gameTime>s.nextBulletTime){const i={bodySize:32,bulletPos:new o.Vector(t.x,t.y),angle:this.angle,speed:5,sprite:"sphere-bullet",scale:.1},a=d.explodeBulletSpeedTime[l]+Math.random()*d.explodeBulletSpeedTime[l];this.shootBullet(Object.assign(Object.assign({},i),{states:[{name:"changeSize",time:60,scaleFn:t=>t+.007*e.deltaTime},{name:"changeSpeed",time:a,speedFn:t=>t-.03*e.deltaTime},{name:"explode",explode:e=>{const t=45*Math.random();for(let s=0;s<8;s++)this.shootBullet(Object.assign(Object.assign({},i),{bulletPos:new o.Vector(e.body.x,e.body.y),angle:t+45*s,scale:.2}))}}]})),s.nextBulletTime=e.gameTime+s.reloadTime,s.bullets-=1}}updateVisibilityState(){const{scene:e}=this,t=this.states.visibility;t.isVisible&&this.alpha<1?this.alpha=Math.max(this.alpha+=.01*e.deltaTime,0):this.alpha>0&&(this.alpha=Math.max(this.alpha-=.01*e.deltaTime,0)),e.gameTime>t.nextChangeTime&&(t.isVisible=!t.isVisible,t.nextChangeTime=e.gameTime+t.reloadTime)}updateBombsState(){const{scene:e,body:t}=this,s=this.states.bombs;if(s.bombs<=0)this.deactivateBombsState();else if(e.gameTime>s.nextBombTime){const i={bulletPos:new o.Vector(t.x,t.y),angle:0,speed:0,sprite:"sphere-bullet",scale:.1};this.shootBullet(Object.assign(Object.assign({},i),{states:[{name:"changeSize",time:60/e.deltaTime,scaleFn:t=>t+.007*e.deltaTime},{name:"explode",explode:e=>{for(let t=0;t<8;t++)this.shootBullet(Object.assign(Object.assign({},i),{bulletPos:new o.Vector(e.body.x,e.body.y),angle:45*t,scale:.25,speed:5}))}}]})),s.nextBombTime=e.gameTime+s.reloadTime,s.bombs-=1}}updateCenterAttackState(){const{scene:e,body:t}=this,s=this.states.centerAttack;if(s.shots<=0)this.deactivateCenterAttackState();else if(e.gameTime>s.nextShotTime){const i=12,r=360/i;for(let h=0;h<i;h++){const i=new o.Vector(t.x,t.y),l=s.lastOffset+r*h,d=a.getOffsetByAngle(l,150),c=new o.Vector(i.x+d.x,i.y+d.y);this.scene.utils.createSphereBullet({pos:c,owner:n.EOwner.enemy,speed:0,angle:a.spreadAngle(l,20),sprite:"sphere-bullet-blue",explodeSprite:"explode-blue",damage:10,scale:.15,bodySize:32,explodeScale:1.35,states:[{name:"changeSize",time:50,scaleFn:t=>t+.01*e.deltaTime},{name:"changeSpeed",time:0,speedFn:()=>2}]})}s.nextShotTime=e.gameTime+s.reloadTime,s.shots-=1,s.lastOffset+=5+Math.random()*(r-10)}}shootBullet(e){var t,s;this.scene.utils.createSphereBullet({pos:e.bulletPos,owner:n.EOwner.enemy,speed:e.speed,angle:e.angle,sprite:e.sprite,explodeSprite:null!==(t=e.explodeSprite)&&void 0!==t?t:"explode-red",explodeScale:null!==(s=e.explodeScale)&&void 0!==s?s:1,damage:this.bulletDamage,scale:e.scale,bodySize:e.bodySize,states:e.states})}setRandomAttack(){const e=Math.random();e>.66?this.activateLaserDoubleAttackState():e>.33?this.activateSplashAttackState():this.activateExplodeAttackState()}getAttackPos(e){const{body:t}=this,s=new o.Vector(t.x,t.y),i=a.getOffsetByAngle(e,80);return new o.Vector(s.x+i.x,s.y+i.y)}isAttackExisted(){const{explodeAttack:e,laserDoubleAttack:t,splashAttack:s,centerAttack:i}=this.states;return e.active||t.active||s.active||i.active}}t.Boss1=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss2=void 0;const i=s(20),a=s(2),o=s(1),n=s(3),r=s(1),h=s(0),l=s(9),d=s(23),c=a.getDeviceType(),u=i.bossesConfig.bosses.chastener.paramsByDevice,m=u.ufoMaxCount[c],p=u.lasterShootingReloadTime[c],g=u.doubleShootingReloadTime[c],y=u.shootingReloadTime[c];class v extends d.Boss{constructor(e){super(e,h.EBossName.chastener),this.maxHp=0,this.hp=0,this.rewardedScore=0,this.scale=.3,this.bodySize=340,this.maxSpeed=1.2,this.speed=this.maxSpeed,this.changeSpeed=.01,this.rotateSpeed=1.25,this.bulletDamage=10,this.isInsideOfSafeArea=!1,this.behavioursArray=[],this.mainState="move",this.mainStateTime=0,this.states={move:{active:!0,targetPoint:this.scene.getGameCenter(),timeToChangeTargetPoint:0,stop:!1,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},laserShooting:{active:!0,reloadTime:0,side:0,methods:{activate:this.activateLaserShootingState.bind(this),deactivate:this.deactivateLaserShootingState.bind(this),update:this.updateLaserShootingState.bind(this)}},doubleShooting:{active:!0,reloadTime:0,methods:{activate:this.activateDoubleShootingState.bind(this),deactivate:this.deactivateDoubleShootingState.bind(this),update:this.updateDoubleShootingState.bind(this)}},spawn:{active:!0,reloadTime:0,methods:{activate:this.activateSpawnState.bind(this),deactivate:this.deactivateSpawnState.bind(this),update:this.updateSpawnState.bind(this)}},supportShooting:{active:!1,range:0,reloadTime:0,reloadTimeInterval:8,methods:{activate:this.activateSupportShootingState.bind(this),deactivate:this.deactivateSupportShootingState.bind(this),update:this.updateSupportShootingState.bind(this)}},waveShooting:{active:!1,reloadTime:0,methods:{activate:this.activateWaveShootingState.bind(this),deactivate:this.deactivateWaveShootingState.bind(this),update:this.updateWaveShootingState.bind(this)}},wavesPartialShooting:{active:!1,reloadTime:0,methods:{activate:this.activateWavesPartialShootingState.bind(this),deactivate:this.deactivateWavesPartialShootingState.bind(this),update:this.updateWavesPartialShootingState.bind(this)}},shooting:{active:!1,reloadTime:0,methods:{activate:this.activateShootingState.bind(this),deactivate:this.deactivateShootingState.bind(this),update:this.updateShootingState.bind(this)}},spiralShooting:{active:!1,currentAngle:0,reloadTime:7,methods:{activate:this.activateSpiralShootingState.bind(this),deactivate:this.deactivateSpiralShootingState.bind(this),update:this.updateSpiralShootingState.bind(this)}}},this.setPropertiesFromConfig();const t=this.scene.utils.getRandomPointOutside({distance:200});this.body=e.physics.add.image(t.x,t.y,"boss-2-ship"),this.body.setImmovable(!0),this.body.setScale(this.scale),this.body.setDepth(r.depths.boss),this.refreshBehavioursArray(),this.centerBody()}centerBody(){const{scale:e,bodySize:t}=this,s=a.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t);this.body.setCircle(t,s.x,s.y)}act(e,t){this.body.active&&(this.updateMainState(),this.updateStates(e,t))}updateMainState(){const{scene:e,mainState:t}=this;switch(this.mainStateTime+=e.deltaTime,t){case"move":if(this.mainStateTime>500&&(this.states.move.stop=!0),this.speed<=0){const e=this.behavioursArray.shift();this.setStopState(),this.deactivateAllStates(),1===e?(this.activateWaveShootingState(),this.activateShootingState(),this.activateSupportShootingState(100,12)):2===e?(this.activateWavesPartialShootingState(),this.activateShootingState(),this.activateSupportShootingState(100,12)):(this.activateSpiralShootingState(),this.activateShootingState(),this.activateSupportShootingState(180,6)),0===this.behavioursArray.length&&this.refreshBehavioursArray()}break;case"stop":this.mainStateTime>500&&(this.setMoveState(),this.deactivateAllStates(),this.activateMoveState(),this.activateLaserShootingState(),this.activateDoubleShootingState())}}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{"spawn"!==e&&this.states[e].methods.deactivate()})}setMoveState(){this.mainState="move",this.mainStateTime=0}setStopState(){this.mainState="stop",this.mainStateTime=0}activateMoveState(){const e=this.states.move;e.stop=!1,e.active=!0}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s,body:i,angle:r,rotateSpeed:h}=this,l=this.states.move,{targetPoint:d}=l;this.updateBase(e,t);const c=new n.Vector(i.x,i.y),u=new n.Vector(d.x,d.y),m=a.getAngleBetweenPointsInDegrees(u,c);this.angle=a.getNearestAngle(r,m,h*s.deltaTime),this.speed>0&&(this.body.angle=this.body.angle+this.speed/2*s.deltaTime),l.stop?this.speed=Math.max(this.speed-this.changeSpeed*s.deltaTime,0):this.speed=Math.min(this.speed+this.changeSpeed*s.deltaTime,this.maxSpeed),l.timeToChangeTargetPoint+=s.deltaTime,this.isOutsideSafeArea(o.enemySafeAreaPercentage.x,o.enemySafeAreaPercentage.y)?(l.timeToChangeTargetPoint=0,this.isInsideOfSafeArea&&(l.targetPoint=this.scene.utils.getSafeAreaPoint(),this.isInsideOfSafeArea=!1)):this.isInsideOfSafeArea=!0,l.timeToChangeTargetPoint>200&&(l.targetPoint=this.scene.utils.getRandomPos(o.enemySafeAreaPercentage.x,o.enemySafeAreaPercentage.y),l.timeToChangeTargetPoint=0)}activateLaserShootingState(){this.states.laserShooting.active=!0}deactivateLaserShootingState(){this.states.laserShooting.active=!1}updateLaserShootingState(){const{scene:e,body:t}=this;this.states.laserShooting.reloadTime+=this.scene.deltaTime;const s=this.states.laserShooting.side;if(this.states.laserShooting.reloadTime>=p){const i=e.player.body,o=new n.Vector(i.x,i.y),r=new n.Vector(t.x,t.y),h=a.getOffsetByAngle(this.angle-90*s,this.body.displayWidth/3.8),l=new n.Vector(r.x+h.x,r.y+h.y),d=a.getAngleBetweenPointsInDegrees(o,l);for(let e=0;e<3;e++)this.shootBullet(d+15*e-15,{bodySize:6,bulletSpeed:6,bulletPos:l,sprite:"laser-red",explodeSprite:"explode-red",scale:1});this.states.laserShooting.reloadTime=0,this.states.laserShooting.side+=1}}activateDoubleShootingState(){this.states.doubleShooting.active=!0}deactivateDoubleShootingState(){this.states.doubleShooting.active=!1}updateDoubleShootingState(){const{scene:e,body:t}=this;if(this.states.doubleShooting.reloadTime+=this.scene.deltaTime,this.states.doubleShooting.reloadTime>=g){const s=e.player.body,i=new n.Vector(s.x,s.y),o=new n.Vector(t.x,t.y),r=a.getAngleBetweenPointsInDegrees(i,o),h=10+70*Math.random();for(let e=0;e<2;e++)this.shootBullet(r+e*h-h/2,{bulletSpeed:4,bulletPos:o,scale:.5,sprite:"sphere-bullet",explodeSprite:"explode-red"});this.states.doubleShooting.reloadTime=0}}activateSpawnState(){this.states.spawn.active=!0}deactivateSpawnState(){this.states.spawn.active=!1}updateSpawnState(){const{scene:e}=this;this.states.spawn.reloadTime-=e.deltaTime,this.states.spawn.reloadTime<0&&(this.states.spawn.reloadTime=300,m-this.scene.enemies.length>0&&this.scene.utils.createEnemy(l.UFO,{pos:new n.Vector(this.body.x,this.body.y)}))}activateWaveShootingState(){this.states.waveShooting.active=!0}deactivateWaveShootingState(){this.states.waveShooting.active=!1}updateWaveShootingState(){const e=this.states.waveShooting;e.reloadTime-=this.scene.deltaTime,e.reloadTime<0&&(e.reloadTime=80,this.shootWave())}activateSupportShootingState(e,t){this.states.supportShooting.active=!0,this.states.supportShooting.range=e,this.states.supportShooting.reloadTimeInterval=t}deactivateSupportShootingState(){this.states.supportShooting.active=!1}updateSupportShootingState(){const{scene:e,body:t}=this,s=this.states.supportShooting;if(s.reloadTime-=e.deltaTime,s.reloadTime<0){s.reloadTime=s.reloadTimeInterval;const i=new n.Vector(t.x,t.y),o=e.player.body,r=new n.Vector(o.x,o.y),h=a.getAngleBetweenPointsInDegrees(r,new n.Vector(t.x,t.y));for(let e=0;e<u.supportShootingBulletsLoopCount[c];e++){const e=a.spreadAngle(h,s.range),t=.2+.25*Math.random();this.shootBullet(e,{bulletSpeed:5-8*t,bulletPos:i,scale:t,sprite:"sphere-bullet-yellow",explodeSprite:"explode-yellow"})}}}activateWavesPartialShootingState(){this.states.wavesPartialShooting.active=!0}deactivateWavesPartialShootingState(){this.states.wavesPartialShooting.active=!1}updateWavesPartialShootingState(){const e=this.states.wavesPartialShooting;e.reloadTime-=this.scene.deltaTime,e.reloadTime<0&&(e.reloadTime=40,this.shootPartialWave())}activateSpiralShootingState(){this.states.spiralShooting.active=!0}deactivateSpiralShootingState(){this.states.spiralShooting.active=!1}updateSpiralShootingState(){const{scene:e,body:t}=this,s=this.states.spiralShooting;if(s.reloadTime-=e.deltaTime,s.reloadTime<0){s.reloadTime=7;const e=new n.Vector(t.x,t.y);for(let t=0;t<3;t++)this.shootBullet(s.currentAngle+120*t,{bulletSpeed:5,bulletPos:e,scale:.4});s.currentAngle+=u.spiralShootingRange[c]}}activateShootingState(){this.states.shooting.active=!0}deactivateShootingState(){this.states.shooting.active=!1}updateShootingState(){const{scene:e,body:t}=this,s=new n.Vector(t.x,t.y),i=e.player.body,o=new n.Vector(i.x,i.y),r=a.getAngleBetweenPointsInDegrees(o,new n.Vector(t.x,t.y)),h=this.states.shooting;h.reloadTime-=e.deltaTime,h.reloadTime<0&&(h.reloadTime=y,this.shootBullet(a.spreadAngle(r,10),{bulletSpeed:6,bulletPos:s,scale:.2,sprite:"sphere-bullet-gray",explodeSprite:"explode-gray"}))}shootWave(){const{scene:e,body:t}=this,s=new n.Vector(t.x,t.y),i=e.player.body,o=new n.Vector(i.x,i.y),r=a.getAngleBetweenPointsInDegrees(o,new n.Vector(t.x,t.y)),h=u.waveBulletsCount[c];for(let e=0;e<h;e++){const t=r+20*(e-Math.round(h/2))+10,i=a.getOffsetByAngle(t,this.getRadialBulletOffset()),o=new n.Vector(s.x+i.x,s.y+i.y);this.shootBullet(r,{bulletSpeed:4,bulletPos:o,scale:.4})}}shootPartialWave(){const{body:e}=this,t=new n.Vector(e.x,e.y),s=60*Math.random();for(let e=0;e<6;e++)for(let i=0;i<5;i++){const o=60*e+15*(i-2)+s,r=a.getOffsetByAngle(o,this.getRadialBulletOffset()),h=new n.Vector(t.x+r.x,t.y+r.y);this.shootBullet(60*e+s,{bulletSpeed:4,bulletPos:h,scale:.4})}}shootBullet(e,t){var s,i,a;const{bulletDamage:o}=this,{bulletSpeed:n,bulletPos:r,scale:l}=t;this.scene.utils.createSphereBullet({pos:r,owner:h.EOwner.enemy,speed:n,angle:e,sprite:null!==(s=t.sprite)&&void 0!==s?s:"sphere-bullet",explodeSprite:null!==(i=t.explodeSprite)&&void 0!==i?i:"explode-red",damage:o,scale:l,bodySize:null!==(a=t.bodySize)&&void 0!==a?a:32})}updateBase(e,t){const{scene:s,body:i,angle:o}=this,{deltaTime:n}=s,r=a.angleToRadians(o);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}refreshBehavioursArray(){this.behavioursArray=[1,2,3].sort(()=>.5-Math.random())}getRadialBulletOffset(){return this.body.displayWidth/2.5}}t.Boss2=v},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss3=void 0;const i=s(20),a=s(15),o=s(2),n=s(3),r=s(1),h=s(0),l=s(23);o.getDeviceType(),i.bossesConfig.bosses.bomber.paramsByDevice;class d extends l.Boss{constructor(e){super(e,h.EBossName.bomber),this.maxHp=0,this.hp=0,this.rewardedScore=0,this.scale=.7,this.bodySize=100,this.maxSpeed=7,this.speed=this.maxSpeed,this.targetSpeed=this.maxSpeed,this.changeSpeed=.075,this.rotateSpeed=1.25,this.bulletDamage=10,this.targetAngle=0,this.lastShadowTime=0,this.shadowTime=50,this.mainState="bombard",this.mainStateTime=0,this.mainStates={bombard:{angleChanged:!1,stateCount:0,stateCountMax:o.getRandomInt(1,3)},attack:{moveOut:!1,moveOutTime:0}},this.states={move:{active:!0,isFixedAngle:!1,fixedAngle:0,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},bombard:{active:!0,time:0,shootTime:35,methods:{activate:this.activateBombardState.bind(this),deactivate:this.deactivateBombardState.bind(this),update:this.updateBombardState.bind(this)}},sideShooting:{active:!0,time:0,shootTime:15,methods:{activate:this.activateSideShootingState.bind(this),deactivate:this.deactivateSideShootingState.bind(this),update:this.updateSideShootingState.bind(this)}},rotateToPlayer:{active:!1,methods:{activate:this.activateRotateToPlayerState.bind(this),deactivate:this.deactivateRotateToPlayerState.bind(this),update:this.updateRotateToPlayerState.bind(this)}},attack:{active:!1,time:0,shootTime:14,side:-1,methods:{activate:this.activateAttackState.bind(this),deactivate:this.deactivateAttackState.bind(this),update:this.updateAttackState.bind(this)}},attack2:{active:!1,time:0,shootTime:25,methods:{activate:this.activateAttack2State.bind(this),deactivate:this.deactivateAttack2State.bind(this),update:this.updateAttack2State.bind(this)}},attack3:{active:!1,time:0,shootTime:50,methods:{activate:this.activateAttack3State.bind(this),deactivate:this.deactivateAttack3State.bind(this),update:this.updateAttack3State.bind(this)}},attack4:{active:!1,time:0,shootTime:80,side:-1,methods:{activate:this.activateAttack4State.bind(this),deactivate:this.deactivateAttack4State.bind(this),update:this.updateAttack4State.bind(this)}},attack5:{active:!1,time:0,shootTime:40,methods:{activate:this.activateAttack5State.bind(this),deactivate:this.deactivateAttack5State.bind(this),update:this.updateAttack5State.bind(this)}},attack6:{active:!1,time:0,shootTime:13,methods:{activate:this.activateAttack6State.bind(this),deactivate:this.deactivateAttack6State.bind(this),update:this.updateAttack6State.bind(this)}},attack7:{active:!1,time:0,shootTime:35,methods:{activate:this.activateAttack7State.bind(this),deactivate:this.deactivateAttack7State.bind(this),update:this.updateAttack7State.bind(this)}}},this.setPropertiesFromConfig();const t=this.scene.utils.getRandomPointOutside({distance:200});this.body=e.physics.add.image(t.x,t.y,"boss-3-ship"),this.body.setImmovable(!0),this.body.setScale(this.scale),this.body.setDepth(r.depths.boss),this.init()}init(){this.centerBody(),this.setAngleToCenter(),this.initCollisions(),this.setBombardState()}centerBody(){const{scale:e,bodySize:t}=this,s=o.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t);this.body.setCircle(t,s.x,s.y)}act(e,t){this.body.active&&(this.updateMainState(),this.updateStates(e,t),this.updateShadows())}updateMainState(){const{scene:e,mainState:t}=this;switch(this.mainStateTime+=e.deltaTime,t){case"bombard":if(this.scene.utils.isOutOfScene(this.pos)&&this.mainStateTime>150&&(this.mainStates.bombard.stateCount+=1,this.mainStates.bombard.stateCount<this.mainStates.bombard.stateCountMax?this.setBombardState():this.setAttackState()),this.scene.utils.isInArea(this.pos,25,25)&&!this.mainStates.bombard.angleChanged){this.mainStates.bombard.angleChanged=!0,this.shootRocket(this.angle);const e=o.getRandomInt(25,80),t=Math.random()>.5?1:-1;this.targetAngle=this.angle+t*e}break;case"attack":if(!this.states.rotateToPlayer.active&&this.scene.utils.isInArea(this.pos,45,45)){this.activateRotateToPlayerState(),this.activateMoveState({fixedAngle:this.angle,speed:2});const e=o.shuffleArray([this.activateAttackState,this.activateAttack2State,this.activateAttack6State]),t=o.shuffleArray([this.activateAttack4State,this.activateAttack5State]);e.pop().call(this),t.pop().call(this),this.shootRocket(this.angle),this.activateAttack3State()}this.mainStates.attack.moveOut&&this.mainStateTime>this.mainStates.attack.moveOutTime&&this.setMoveOutState(),this.scene.utils.isOutOfScene(this.pos)&&this.mainStateTime>150&&(Math.random()>.15?this.setAttackState():this.setBombardState());break;case"moveOut":this.scene.utils.isOutOfScene(this.pos)&&this.mainStateTime>150&&(this.mainStates.bombard.stateCountMax=o.getRandomInt(1,3),Math.random()<.15?this.setAttackState():this.setBombardState())}}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{"spawn"!==e&&this.states[e].methods.deactivate()})}setBombardState(){this.deactivateAllStates(),this.mainState="bombard",this.mainStateTime=0,this.mainStates.bombard.angleChanged=!1,this.setRandomPositionOutsideScene(),this.setAngleToCenter(),this.activateMoveState(),this.activateBombardState(),this.activateSideShootingState(),this.activateAttack7State(),this.shootWaveOutsideScene(this.pos,this.angle)}setAttackState(){this.deactivateAllStates(),this.mainState="attack",this.mainStateTime=0,this.mainStates.attack.moveOut=Math.random()>.5,this.mainStates.attack.moveOutTime=o.getRandomInt(150,300),this.setRandomPositionOutsideScene(),this.setAngleToCenter(),this.activateAttack7State(),this.activateMoveState({speed:5})}setMoveOutState(){this.deactivateAllStates(),this.mainState="moveOut",this.mainStateTime=0,this.activateMoveState(),this.activateBombardState(),this.activateSideShootingState()}activateMoveState(e={}){var t;const s=this.states.move;s.active=!0,e.fixedAngle?(s.fixedAngle=e.fixedAngle,s.isFixedAngle=!0):s.isFixedAngle=!1,this.targetSpeed=null!==(t=e.speed)&&void 0!==t?t:this.maxSpeed}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){this.updateBase(e,t),this.updateAngle(e,t)}activateBombardState(){this.states.bombard.active=!0}deactivateBombardState(){this.states.bombard.active=!1}updateBombardState(e,t){this.states.bombard.time+=this.scene.deltaTime,this.states.bombard.time>=this.states.bombard.shootTime&&(this.states.bombard.time=0,this.shootBomb())}activateSideShootingState(){this.states.sideShooting.active=!0}deactivateSideShootingState(){this.states.sideShooting.active=!1}updateSideShootingState(e,t){this.states.sideShooting.time+=this.scene.deltaTime,this.states.sideShooting.time>=this.states.sideShooting.shootTime&&(this.states.sideShooting.time=0,[90,-90].forEach(e=>{this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.triangle),{sprite:"triangle-bullet-aqua",explodeSprite:"explode-aqua",angle:this.angle-180+e,speed:5}))}))}activateRotateToPlayerState(){this.states.rotateToPlayer.active=!0}deactivateRotateToPlayerState(){this.states.rotateToPlayer.active=!1}updateRotateToPlayerState(){const{scene:e,body:t}=this;this.targetAngle=e.utils.getAngleToPlayer(new n.Vector(t.x,t.y))}activateAttackState(){this.states.attack.active=!0}deactivateAttackState(){this.states.attack.active=!1}updateAttackState(){if(this.states.attack.time+=this.scene.deltaTime,this.states.attack.time>=this.states.attack.shootTime){this.states.attack.time=0;const e=o.getOffsetByAngle(this.angle+90*this.states.attack.side,130);this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.laser),{sprite:"laser-aqua",explodeSprite:"explode-aqua",scale:1.2,angle:this.angle,minLifeTime:10,speed:8,pos:new n.Vector(this.body.x+e.x,this.body.y+e.y),states:[{name:"wait",time:25},{name:"explode",explode:e=>{const t=o.getRandomInt(10,30);[-1,1].forEach(s=>{this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.laser),{sprite:"laser-aqua",explodeSprite:"explode-aqua",angle:e.getAngle()+s*t,scale:.85,pos:new n.Vector(e.body.x,e.body.y)}))})}}]})),this.states.attack.side=0-this.states.attack.side}}activateAttack2State(){this.states.attack2.active=!0}deactivateAttack2State(){this.states.attack2.active=!1}updateAttack2State(){if(this.states.attack2.time+=this.scene.deltaTime,this.states.attack2.time>=this.states.attack2.shootTime){this.states.attack2.time=0;const e=o.getOffsetByAngle(this.angle-180,30),t=o.getRandomInt(5,40);[2*-t-t,0,t,2*t].forEach((t,s)=>{const i=s%2==0?new n.Vector(0,0):e;this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.triangle),{sprite:"triangle-bullet-aqua",explodeSprite:"explode-aqua",angle:this.angle+t,pos:new n.Vector(this.body.x+i.x,this.body.y+i.y)}))})}}activateAttack3State(){this.states.attack3.active=!0}deactivateAttack3State(){this.states.attack3.active=!1}updateAttack3State(){this.states.attack3.time+=this.scene.deltaTime,this.states.attack3.time>=this.states.attack3.shootTime&&(this.states.attack3.time=0,this.shootWaveOutsideScene(this.getPosOutsideBehind(200),this.angle,2))}activateAttack4State(){this.states.attack4.active=!0}deactivateAttack4State(){this.states.attack4.active=!1}updateAttack4State(){if(this.states.attack4.time+=this.scene.deltaTime,this.states.attack4.time>=this.states.attack4.shootTime){this.states.attack4.time=0;const e=o.getOffsetByAngle(this.angle+90*this.states.attack.side,130),t=new n.Vector(this.body.x+e.x,this.body.y+e.y);this.shootRocket(this.angle,t),this.states.attack4.side=0-this.states.attack4.side}}activateAttack5State(){this.states.attack5.active=!0}deactivateAttack5State(){this.states.attack5.active=!1}updateAttack5State(){this.states.attack5.time+=this.scene.deltaTime,this.states.attack5.time>=this.states.attack5.shootTime&&(this.states.attack5.time=0,[90,-90].forEach(e=>{[35,60,85].forEach(t=>{const s=o.getOffsetByAngle(this.angle+e,60+t);this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.laser),{minLifeTime:15,angle:this.angle,speed:o.getRandomInt(5,8),pos:new n.Vector(this.body.x+s.x,this.body.y+s.y)}))})}))}activateAttack6State(){this.states.attack6.active=!0}deactivateAttack6State(){this.states.attack6.active=!1}updateAttack6State(){if(this.states.attack6.time+=this.scene.deltaTime,this.states.attack6.time>=this.states.attack6.shootTime){this.states.attack6.time=0;const e=o.spreadAngle(this.angle,50);[1,2,3].forEach((t,s)=>{const i=o.getOffsetByAngle(e,15*s);this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.triangle),{sprite:"triangle-bullet-purple",explodeSprite:"explode-purple",minLifeTime:15,angle:o.spreadAngle(e,3),pos:new n.Vector(this.pos.x+i.x,this.pos.y+i.y)}))})}}activateAttack7State(){this.states.attack7.active=!0}deactivateAttack7State(){this.states.attack7.active=!1}updateAttack7State(){this.states.attack7.time+=this.scene.deltaTime,this.states.attack7.time>=this.states.attack7.shootTime&&(this.states.attack7.time=0,this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.laser),{sprite:"laser-gray",explodeSprite:"explode-gray",minLifeTime:15,speed:9,angle:this.scene.utils.getAngleToPlayer(this.pos)})))}setAngleToCenter(){this.angle=o.getAngleBetweenPointsInDegrees(this.scene.utils.getRandomPos(15,15),new n.Vector(this.body.x,this.body.y)),this.targetAngle=this.angle}updateShadows(){const{scene:e,lastShadowTime:t,shadowTime:s}=this,i=e.gameTime;i>t&&(this.lastShadowTime=i+s,this.createShadow())}createShadow(){const{scene:e,body:t,scale:s,angle:i}=this,o=.25*Math.max(this.maxSpeed-this.speed,0);e.effects.push(new a.Shadow(e,{pos:new n.Vector(t.x,t.y),sprite:"boss-3-ship",lifeTime:250,scale:s,angle:i+90,alpha:.4-o}))}setRandomPositionOutsideScene(){const e=this.scene.utils.getRandomPointOutside({distance:300});this.body.x=e.x,this.body.y=e.y}getPosOutsideBehind(e=0){const t=this.scene.getGameSize(),s=o.getOffsetByAngle(this.angle-180,t.width+1e3),i=new n.Vector(this.body.x+s.x,this.body.y+s.y);let a=0,r=0;i.x<-e&&(a=i.x+e),i.x>t.width+e&&(a=i.x-(t.width+e)),i.y<-e&&(r=i.y+e),i.y>t.height+e&&(r=i.y-(t.height+e));const h=Math.max(Math.abs(a),Math.abs(r)),l=o.getOffsetByAngle(this.angle,h);return new n.Vector(i.x+l.x,i.y+l.y)}updateBase(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=this.states.move.isFixedAngle?this.states.move.fixedAngle:a,h=o.angleToRadians(r);i.x+=this.speed*Math.cos(h)*n,i.y+=this.speed*Math.sin(h)*n,this.speed<this.targetSpeed?this.speed=Math.min(this.speed+this.changeSpeed,this.targetSpeed):this.speed=Math.max(this.speed-this.changeSpeed,this.targetSpeed)}updateAngle(e,t){const{scene:s,body:i}=this,{deltaTime:a}=s;this.angle=o.getNearestAngle(this.angle,this.targetAngle,this.rotateSpeed*a),i.angle=this.angle+90}shootWaveOutsideScene(e,t,s=0){const i=o.getOffsetByAngle(t+90,100);for(let a=-8;a<8;a++){if(a<s&&a>-s)continue;const o=new n.Vector(e.x+i.x*a,e.y+i.y*a);this.scene.utils.isInArea(o,50,50)||this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.sphere),{sprite:"sphere-bullet-purple",explodeSprite:"explode-purple",angle:t,pos:new n.Vector(e.x+i.x*a,e.y+i.y*a),minLifeTime:150,speed:5}))}}shootBomb(){this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.sphere),{sprite:"sphere-bullet-aqua",explodeSprite:"explode-aqua",angle:0,speed:0,states:[{name:"changeSize",scaleFn:e=>e+.005,time:50},{name:"explode",explode:e=>{const t=o.getRandomInt(0,45);this.scene.shakeScreen();for(let s=0;s<12;s++)this.shootBullet(Object.assign(Object.assign({},r.defaultBulletParams.sphere),{sprite:"sphere-bullet-aqua",explodeSprite:"explode-aqua",angle:t+30*s,scale:.3,pos:new n.Vector(e.body.x,e.body.y)}))}}]}))}shootRocket(e,t){this.scene.utils.createRocketBullet(Object.assign(Object.assign({},r.defaultBulletParams.rocket),{sprite:"rocket-bullet-purple",explodeSprite:"explode-purple",pos:t||this.pos,owner:h.EOwner.enemy,angle:e,damage:this.bulletDamage}))}shootBullet(e){const t={owner:h.EOwner.enemy,pos:this.pos,damage:this.bulletDamage};this.scene.utils.createSphereBullet(Object.assign(Object.assign({},t),e))}}t.Boss3=d},function(e,t,s){"use strict";function i(e,t,s){return{pluralName:e+".plural",reward:t,level:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.enemiesConfig=void 0,t.enemiesConfig={coinChance:.5,ships:{bot:i("bots",3,1),hunter:i("hunters",10,2),ufo:i("ufo",10,3),flyer:i("flyers",12,6),destroyer:i("destroyers",16,7),stealth:i("stealths",10,8),"laser-ship":i("laser-ships",22,12),defender:i("defender",24,13),"missile-carrier":i("missile-carriers",22,11)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boostersConfig=void 0,t.boostersConfig={spawnAdditionalTime:2,spawnIntervalRangeTime:10,lifeTime:7,types:{speed:{additionalSpeed:1},damage:{additionalXDamage:2},regenerator:{hpPerSecond:5}}}},function(e,t,s){"use strict";function i(e,t,s=1.5){const i=[e];for(let e=0;e<t-1;e++)i.push(Math.floor(i[i.length-1]*s));return i}function a(e,t){return{maxLevel:e.length+1,price:e,valuePerLevel:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.storeConfig=void 0;const o={maxHealth:a(i(100,10,1.5),10),damage:a(i(100,10,2),2),explosionResistance:a(i(100,9,2),10),movementSpeed:a(i(100,10,2),.4),attackSpeed:a(i(100,10,2),32),bonusesTime:a(i(100,10,1.5),2),fortune:a(i(100,9,2),5)};t.storeConfig={products:o}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playerConfig=void 0,t.playerConfig={movementSpeed:5,attackSpeed:320,damage:10,maxHealth:100,explosionResistance:0,bonusesTime:10,fortune:50,revive:{immortalityTime:3e3,healthPercentage:50},shadowIntervalTime:50,bodyOffset:6,movePointerParams:{range:5,speed:4},anglePointerParams:{range:1,speed:40}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fireflyConfig=void 0;const i=s(2);t.fireflyConfig={maxCountPerLevel:2,spawnTimeInterval:i.getSeconds(20),spawnTimeIntervalRange:i.getSeconds(20),alphaChange:.008,bodySize:18,depth:10,cameraFlashDuration:i.getSeconds(3),hp:4,reward:2,speed:4,rotateSpeed:3,scale:.5,targetTimeInterval:500,targetTimeIntervalRange:500,lifeTime:i.getSeconds(5),lifeTimeRange:i.getSeconds(5),increaseSpeedOnHit:1,decreaseTargetTimeIntervalOnHit:100,decreaseTargetTimeIntervalRangeOnHit:100,increaseRewardPerLevel:.5}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalResultsScene=t.SurvivalPreviewScene=t.ControlsScene=t.StoreScene=t.FinalScene=t.LeaderboardsScene=t.ContactsScene=t.LoadingScene=t.AdScene=t.HistoryScene=t.InfoScene=t.PreloadScene=t.GameScene=t.FailScene=t.WinScene=t.PreviewScene=t.MenuScene=t.Scene=void 0;var i=s(6);Object.defineProperty(t,"Scene",{enumerable:!0,get:function(){return i.Scene}});var a=s(126);Object.defineProperty(t,"MenuScene",{enumerable:!0,get:function(){return a.MenuScene}});var o=s(127);Object.defineProperty(t,"PreviewScene",{enumerable:!0,get:function(){return o.PreviewScene}});var n=s(128);Object.defineProperty(t,"WinScene",{enumerable:!0,get:function(){return n.WinScene}});var r=s(129);Object.defineProperty(t,"FailScene",{enumerable:!0,get:function(){return r.FailScene}});var h=s(130);Object.defineProperty(t,"GameScene",{enumerable:!0,get:function(){return h.GameScene}});var l=s(179);Object.defineProperty(t,"PreloadScene",{enumerable:!0,get:function(){return l.PreloadScene}});var d=s(180);Object.defineProperty(t,"InfoScene",{enumerable:!0,get:function(){return d.InfoScene}});var c=s(181);Object.defineProperty(t,"HistoryScene",{enumerable:!0,get:function(){return c.HistoryScene}});var u=s(182);Object.defineProperty(t,"AdScene",{enumerable:!0,get:function(){return u.AdScene}});var m=s(183);Object.defineProperty(t,"LoadingScene",{enumerable:!0,get:function(){return m.LoadingScene}});var p=s(184);Object.defineProperty(t,"ContactsScene",{enumerable:!0,get:function(){return p.ContactsScene}});var g=s(185);Object.defineProperty(t,"LeaderboardsScene",{enumerable:!0,get:function(){return g.LeaderboardsScene}});var y=s(186);Object.defineProperty(t,"FinalScene",{enumerable:!0,get:function(){return y.FinalScene}});var v=s(187);Object.defineProperty(t,"StoreScene",{enumerable:!0,get:function(){return v.StoreScene}});var S=s(189);Object.defineProperty(t,"ControlsScene",{enumerable:!0,get:function(){return S.ControlsScene}});var b=s(190);Object.defineProperty(t,"SurvivalPreviewScene",{enumerable:!0,get:function(){return b.SurvivalPreviewScene}});var f=s(191);Object.defineProperty(t,"SurvivalResultsScene",{enumerable:!0,get:function(){return f.SurvivalResultsScene}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UI=void 0;const i=s(12),a=s(3),o=s(1),n=s(21);t.UI=class{constructor(e){this.scene=e}drawOriginalText(e){const{scene:t}=this,{x:s,y:i,text:a,fontSize:n,origin:r,color:h,align:l,maxWidth:d,depth:c,alpha:u,lineSpacing:m}=e,p={fontFamily:o.DEFAULT_FONT,fontSize:1.5*n+"px",lineSpacing:m||5,color:"#fff",fontWeight:500};l&&(p.align=l),d&&(p.wordWrap={width:1.35*d});const g=t.add.text(s,i,a,p);return g.setScale(.65),r&&g.setOrigin(r[0],r[1]),u&&g.setAlpha(u),h&&g.setTint(h),c&&g.setDepth(c),g}drawBitmapText(e){const{scene:t}=this,{x:s,y:i,text:a,fontSize:n,origin:r,alignCenter:h,maxWidth:l,tint:d,depth:c,isDynamic:u,alpha:m,letterSpacing:p}=e,g=u?t.add.dynamicBitmapText(s,i,o.SECONDARY_FONT,a,n):t.add.bitmapText(s,i,o.SECONDARY_FONT,a,n);return r&&g.setOrigin(r[0],r[1]),p&&g.setLetterSpacing(p),h&&g.setCenterAlign(),l&&g.setMaxWidth(l),d&&g.setTint(d),c&&g.setDepth(c),m&&g.setAlpha(m),g}drawDynamicBitmapText(e){return this.drawBitmapText(Object.assign(Object.assign({},e),{isDynamic:!0}))}drawImage(e){const{scene:t}=this,{x:s,y:i,texture:a,scale:o,depth:n,origin:r}=e,h=t.add.image(s,i,a);return o&&h.setScale(o),n&&h.setDepth(n),r&&h.setOrigin(r[0],r[1]),h}drawRainbowText(e){const{scene:t}=this,{x:s,y:r}=e,h=i.__rest(e,["x","y"]);return new n.UIRainbowText(t,Object.assign({pos:new a.Vector(s,r),fontSize:23,color:o.colors.green},h))}drawButton(e){const{scene:t}=this,{x:s,y:r}=e,h=i.__rest(e,["x","y"]);return new n.UIRectButton(t,Object.assign({pos:new a.Vector(s,r),width:o.defaultButtonParams.width,height:o.defaultButtonParams.height},h))}drawArcButton(e){const{scene:t}=this,{x:s,y:o}=e,r=i.__rest(e,["x","y"]);return new n.UIArcButton(t,Object.assign({pos:new a.Vector(s,o)},r))}drawCosmons(e){const{scene:t}=this,{x:s,y:o}=e,r=i.__rest(e,["x","y"]);return new n.UICosmons(t,Object.assign({pos:new a.Vector(s,o)},r))}drawIndicator(e){const{scene:t}=this,{x:s,y:o}=e,r=i.__rest(e,["x","y"]);return new n.UIIndicator(t,Object.assign({pos:new a.Vector(s,o)},r))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIPauseButton=t.UIRectButton=t.UIArcButton=void 0;var i=s(118);Object.defineProperty(t,"UIArcButton",{enumerable:!0,get:function(){return i.UIArcButton}});var a=s(119);Object.defineProperty(t,"UIRectButton",{enumerable:!0,get:function(){return a.UIRectButton}});var o=s(120);Object.defineProperty(t,"UIPauseButton",{enumerable:!0,get:function(){return o.UIPauseButton}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIArcButton=void 0;const i=s(1);t.UIArcButton=class{constructor(e,t){this.scene=e,this.params=t,this.init()}init(){const{scene:e,params:t}=this,s=new Phaser.Geom.Circle(t.pos.x,t.pos.y,t.arc),a=e.add.graphics({lineStyle:{width:2,color:i.colors.white},fillStyle:{color:i.colors.white}}).setInteractive(s,Phaser.Geom.Circle.Contains);a.on("pointerdown",()=>{var e,s;null===(s=null===(e=t.callbacks)||void 0===e?void 0:e.onPointerDown)||void 0===s||s.call(e)}),a.strokeCircleShape(s),t.render()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRectButton=void 0;const i=s(1),a=i.colors.white;t.UIRectButton=class{constructor(e,t){this.fixedColor=null,this.isDisabled=!1,this.isHovered=!1,this.scene=e,this.params=t,this.pos=t.pos,this.isDisabled=Boolean(t.isDisabled),this.isVisible=void 0===t.isVisible||t.isVisible,this.init()}init(){const{scene:e,params:t,isDisabled:s}=this,o=s?.5:1;this.text=this.scene.ui.drawOriginalText({x:t.pos.x,y:t.pos.y,depth:t.depth||0,fontSize:i.fontSizes.text,origin:[.5,.5],align:"center",alpha:o,text:t.text}),this.width=t.responsive?this.text.displayWidth+2*t.responsive.paddingX:t.width;const n=t.pos.x-this.width/2,r=t.pos.y-t.height/2;this.rectShape=new Phaser.Geom.Rectangle(n,r,this.width,t.height),this.graphics=e.add.graphics({lineStyle:{width:2,color:a},fillStyle:{color:a}}).setInteractive(this.rectShape,Phaser.Geom.Rectangle.Contains).setAlpha(o),t.depth&&this.graphics.setDepth(t.depth),this.draw(),this.initListeners()}draw(){this.graphics.clear();const{isDisabled:e,fixedColor:t,isVisible:s}=this,o=this.isDisabled?.5:1;let n=this.isHovered&&!e?i.colors.green:a;t&&(n=t),s?(this.graphics.lineStyle(2,n),this.graphics.strokeRectShape(this.rectShape),this.graphics.setDepth(this.params.depth||1),this.graphics.setAlpha(o),this.text.visible=!0):(this.graphics.setDepth(-1),this.text.visible=!1),this.text.tint=n,this.text.setAlpha(o)}updateListeners(){const{isHovered:e,isVisible:t,isDisabled:s}=this,i=this.scene.getMousePosition(),a=new Phaser.Geom.Circle(i.x,i.y,2),o=Phaser.Geom.Intersects.CircleToRectangle(a,this.rectShape);!e||o&&t&&!s?!e&&o&&t&&!s&&this.onPointerOver():this.onPointerOut()}initListeners(){const{graphics:e,params:t}=this;e.on("pointerdown",()=>{var e,s;!this.isDisabled&&this.isVisible&&(t.noDefaultCursorAfterClick||(document.body.style.cursor="default"),null===(s=null===(e=t.callbacks)||void 0===e?void 0:e.onPointerDown)||void 0===s||s.call(e))}),e.on("pointerover",()=>{this.onPointerOver(),this.draw()}),e.on("pointerout",()=>{this.onPointerOut(),this.draw()})}onPointerOver(){this.isVisible&&!this.isDisabled&&(this.isHovered=!0,document.body.style.cursor="pointer")}onPointerOut(){this.isHovered&&(this.isHovered=!1,document.body.style.cursor="default")}updatePosition(e,t){const{params:s}=this,i=e-this.width/2,a=t-s.height/2;this.rectShape.x=i,this.rectShape.y=a,this.pos.x=e,this.pos.y=t,this.text.x=e,this.text.y=t,this.draw()}updateYPosition(e){const{params:t}=this,s=e-t.height/2;this.rectShape.y=s,this.pos.y=e,this.text.y=e,this.draw()}hide(){this.isVisible=!1,this.updateListeners(),this.draw()}show(){this.isVisible=!0,this.updateListeners(),this.draw()}setFixedColor(e){this.fixedColor=e,this.draw()}setDisabled(e){this.isDisabled=e,this.updateListeners(),this.draw()}unfixColor(){this.fixedColor=null,this.draw()}getSize(){return{width:this.width,height:this.params.height}}getParams(){return this.params}getPosition(){return this.pos}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIPauseButton=void 0;const i=s(3),a=s(1);t.UIPauseButton=class{constructor(e,t){this.isPaused=!1,this.isHovered=!1,this.scene=e,this.params=t,this.pos=t.pos,this.isDisabled=Boolean(t.isDisabled),this.init()}init(){const{scene:e,params:t}=this;this.sprite=e.add.sprite(0,0,"pause-button",1),this.sprite.setScale(.5),this.sprite.setDepth(t.depth),this.sprite.setInteractive(),this.sprite.on("pointerdown",()=>{this.isDisabled||(this.isPaused=!this.isPaused,this.params.callbacks.onChange(this.isPaused),this.draw())}),this.sprite.on("pointerover",()=>{this.isDisabled||(this.onPointerOver(),this.draw())}),this.sprite.on("pointerout",()=>{this.onPointerOut(),this.draw()}),this.draw()}onPointerOver(){this.isHovered=!0,document.body.style.cursor="pointer"}onPointerOut(){this.isHovered=!1,document.body.style.cursor="default"}draw(){const{pos:e,isPaused:t,isDisabled:s}=this;this.sprite.x=e.x,this.sprite.y=e.y,this.sprite.setFrame(t?0:1),this.sprite.setAlpha(s?.5:1),this.isHovered?this.sprite.setTint(a.colors.green):this.sprite.setTint(a.colors.white)}updateListeners(){const{pos:e,isDisabled:t,isHovered:s}=this,i=this.scene.getMousePosition(),a=new Phaser.Geom.Circle(i.x,i.y,2),o=new Phaser.Geom.Circle(e.x,e.y,this.sprite.displayHeight/2),n=Phaser.Geom.Intersects.CircleToCircle(a,o);!s||n&&!t?s||!n||t||this.onPointerOver():this.onPointerOut()}setPosition(e,t){this.pos=new i.Vector(e,t),this.draw()}setDisabled(e){this.isDisabled=e,this.updateListeners(),this.draw()}getPosition(){return this.pos}getSize(){return{width:this.sprite.displayWidth,height:this.sprite.displayHeight}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UICosmons=void 0;const i=s(3),a=s(18);class o extends a.UIComponent{constructor(e,t){super(e),this.params=t,this.pos=t.pos,this.isCentered=t.isCentered,this.init()}init(){const{scene:e,params:t}=this,{pos:s,value:i,depth:a,prefix:o}=t,n=this.getTextOffset();this.starImage=e.ui.drawImage({x:0,y:0,texture:"coin-gold",origin:[0,.5],depth:a}),o&&(this.prefixBitmapText=e.ui.drawBitmapText({x:s.x+this.starImage.width+12-4,y:s.y+4+1,text:o,fontSize:22,origin:[0,.5],depth:a})),this.valueText=e.ui.drawBitmapText({x:s.x+this.starImage.width+12+n,y:s.y+4,text:i.toString(),fontSize:22,origin:[0,.5],depth:a}),this.updatePosition(s.x,s.y)}getTextOffset(){return this.params.prefix?12:0}getHalfWidth(){const e=this.getTextOffset();return(this.starImage.width+12+this.valueText.width+e)/2}updatePosition(e,t){const{params:s,isCentered:a}=this,{prefix:o}=s,n=o?12:0,r=a?e-this.getHalfWidth():e,h=t-3,l=new i.Vector(r,h);this.starImage.x===l.x&&this.starImage.y===l.y||(this.starImage.x=l.x,this.starImage.y=l.y,this.prefixBitmapText&&(this.prefixBitmapText.x=l.x+this.starImage.width+12-4,this.prefixBitmapText.y=l.y+4+1),this.valueText.x=l.x+this.starImage.width+12+n,this.valueText.y=l.y+4,this.pos=new i.Vector(e,t))}updateValue(e){this.valueText.setText(e.toString()),this.updatePosition(this.pos.x,this.pos.y)}setCentered(e){this.isCentered=e}hide(){this.valueText.visible=!1,this.starImage.visible=!1}show(){this.valueText.visible=!0,this.starImage.visible=!0}getPosition(){return this.pos}getHeight(){return this.starImage.displayHeight}}t.UICosmons=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRainbowText=void 0;const i=s(3),a=s(18);class o extends a.UIComponent{constructor(e,t){super(e),this.rainbowColorIdx=0,this.rainbowColorOffset=0,this.delay=0,this.rainbowWave=0,this.params=t,this.init()}init(){const{scene:e}=this,{text:t,pos:s,color:i,fontSize:a}=this.params;this.rainbowCallback=this.rainbowCallback.bind(this),this.rainbowText=e.ui.drawDynamicBitmapText({x:s.x,y:s.y,text:t,fontSize:a,origin:[.5,.5],alignCenter:!0,tint:i}),this.rainbowText.setDisplayCallback(this.rainbowCallback)}update(){this.updateRainbow()}updateRainbow(){this.rainbowColorIdx=0,6==this.delay++&&(this.rainbowColorOffset=(this.rainbowColorOffset+1)%4,this.delay=0)}rainbowCallback(e){return this.rainbowColorIdx=(this.rainbowColorIdx+1)%4,e.y=2*Math.cos(this.rainbowWave+this.rainbowColorIdx),this.rainbowWave+=.005,e}setPosition(e,t){this.rainbowText.x=e,this.rainbowText.y=t}getPosition(){return new i.Vector(this.rainbowText.x,this.rainbowText.y)}}t.UIRainbowText=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRewardedModal=void 0;const i=s(3),a=s(1),o=s(18),n=s(38),r=550,h=200;class l extends o.UIComponent{constructor(e,t){super(e),this.isModalInteractive=!0,this.params=t,this.pos=t.pos,this.init()}init(){const{scene:e}=this;this.graphics=e.add.graphics({lineStyle:{width:3,color:a.colors.white},fillStyle:{color:a.colors.black}}),this.graphics.setDepth(a.depths.modal),this.circleProgress=new n.UICircleProgress(e,{pos:new i.Vector(0,0),depth:a.depths.modalContent}),this.text=this.scene.ui.drawOriginalText({x:0,y:0,text:this.scene.game.i18n.getText("rewardedModal"),fontSize:18,align:"center",origin:[.5,.5],maxWidth:r,color:a.colors.white,depth:a.depths.modalContent}),this.drawWatchButton(0,0),this.drawFinishButton(0,0),this.updateContentPositions(),this.hide()}show(){const{scene:e,pos:t}=this;this.endTime=e.sceneTime+5e3,this.draw(),this.text.text=this.scene.game.i18n.getText("rewardedModal"),this.text.y=t.y-40,this.watchButton.show(),this.finishButton.show(),this.text.visible=!0,this.isModalInteractive=!0,this.isVisible=!0}hide(){this.graphics.clear(),this.watchButton.hide(),this.finishButton.hide(),this.circleProgress.hide(),this.text.visible=!1,this.isModalInteractive=!1,this.isVisible=!1}update(){const{scene:e,endTime:t,isVisible:s}=this;if(!s||!this.isModalInteractive)return;const i=(t-e.sceneTime)/5e3;this.circleProgress.update({percentage:i,color:a.colors.yellow}),i<=0&&this.params.onProgressEnd()}drawWatchButton(e,t){this.watchButton=this.scene.ui.drawButton({x:e,y:t,width:140,depth:a.depths.modalContent,height:a.defaultButtonParams.height,text:this.scene.game.i18n.getText("watch"),isVisible:!1,callbacks:{onPointerDown:()=>{let e=!1;this.isModalInteractive&&(this.isModalInteractive=!1,this.drawAdLoadingState(),this.scene.game.adManager.showRewardedVideo({onRewarded:()=>{e=!0},onClose:()=>{e?this.params.onRewarded():this.params.onCancelReward()}}))}}})}drawFinishButton(e,t){this.finishButton=this.scene.ui.drawButton({x:e,y:t,width:140,depth:a.depths.modalContent,height:a.defaultButtonParams.height,text:this.scene.game.i18n.getText("exit"),isVisible:!1,callbacks:{onPointerDown:()=>{this.isModalInteractive&&this.params.onExit()}}})}drawAdLoadingState(){const{graphics:e,pos:t}=this;e.clear();const s=new Phaser.Geom.Rectangle(t.x-r/2,t.y-h/2+h/4,r,h/2);e.strokeRectShape(s),e.fillRectShape(s),this.watchButton.hide(),this.finishButton.hide(),this.circleProgress.hide(),this.text.text=this.scene.game.i18n.getText("adLoading"),this.text.y=t.y}draw(){const{graphics:e,pos:t}=this;e.clear();const s=new Phaser.Geom.Rectangle(t.x-r/2,t.y-h/2,r,h);e.strokeRectShape(s),e.fillRectShape(s)}updateContentPositions(){const{pos:e}=this;this.circleProgress.setPosition(e.x,e.y+25),this.text.x=e.x,this.text.y=e.y-40,this.watchButton.updatePosition(e.x-70-50,e.y+25),this.finishButton.updatePosition(e.x+70+50,e.y+25)}setPosition(e){this.pos=e,this.updateContentPositions(),this.isVisible&&this.draw()}}t.UIRewardedModal=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UITabs=void 0;const i=s(1),a=s(18);class o extends a.UIComponent{constructor(e,t){super(e),this.buttons=[],this.activeTabIndex=-1,this.params=t,this.activeTabIndex=t.activeTabIndex,this.init()}init(){const{scene:e,params:t,buttons:s}=this;t.tabs.forEach((a,o)=>{const n=e.ui.drawButton({x:t.pos.x,y:t.pos.y,noDefaultCursorAfterClick:!0,responsive:{paddingX:30},height:i.defaultButtonParams.height,text:e.game.i18n.getText(a.textI18nKey),callbacks:{onPointerDown:()=>{t.onClick(a),this.setActiveTabIndex(o)}}});s.push(n)});let a=0;for(let e=1;e<s.length;e++){const i=s[e-1],o=s[e];a=20+a+i.getSize().width/2+o.getSize().width/2,o.updatePosition(t.pos.x+a,o.getParams().pos.y)}const o=(s.reduce((e,t)=>e+20+t.getSize().width,0)-s[0].getSize().width-20)/2;s.forEach(e=>{e.updatePosition(e.getParams().pos.x-o,e.getParams().pos.y)}),this.setActiveTabIndex(this.activeTabIndex)}setActiveTabIndex(e){var t,s;null===(t=this.buttons[this.activeTabIndex])||void 0===t||t.unfixColor(),this.activeTabIndex=e,null===(s=this.buttons[e])||void 0===s||s.setFixedColor(i.colors.green)}setDisabled(e){this.buttons.forEach(t=>{t.setDisabled(e)})}}t.UITabs=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIIndicator=void 0;const i=s(1),a=s(18),o=5,n=20,r=5;class h extends a.UIComponent{constructor(e,t){super(e),this.params=t,this.pos=t.pos,this.value=t.value,this.maxValue=t.max,this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),this.init()}init(){this.draw()}draw(){const{graphics:e,pos:t,value:s,maxValue:a}=this;e.clear();const h=a*(o+r)-r,l=t.x-h/2,d=t.y;for(let t=0;t<a;t++){const a=new Phaser.Geom.Rectangle(l+t*o+t*r,d,o,n),h=s<t?i.colors.red:i.colors.green;e.lineStyle(2,h),e.strokeRectShape(a)}}hide(){this.graphics.clear()}show(){this.draw()}updatePosition(e){this.pos=e,this.draw()}setValue(e){this.value=e,this.draw()}setMaxValue(e){this.maxValue=e,this.draw()}}t.UIIndicator=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MenuScene=void 0;const i=s(5),a=s(1),o=s(0),n=s(2),r=s(6);let h=!1;class l extends r.Scene{constructor(){super({key:o.ESceneName.menu})}preload(){this.load.image("coin-gold","assets/images/bonus/star-gold.png"),this.load.image("question-mark","assets/images/interface/question-mark.png"),h||(this.load.bitmapFont(a.SECONDARY_FONT,"assets/fonts/atari/bitmap/gem.png","assets/fonts/atari/bitmap/gem.xml"),h=!0)}create(){this.graphics=this.add.graphics({lineStyle:{width:3,color:a.colors.white},fillStyle:{color:a.colors.white}}),this.drawTitle(),this.drawVersionText(),this.drawSubtitle(),this.cosmons=this.ui.drawCosmons({x:0,y:0,value:this.getData().money,isCentered:!0,depth:100}),this.drawPlayerLevelText(),this.drawLevelText(),this.drawStoreButton(),this.drawLeaderboardButton(),this.drawStartButton(),this.drawContactsButton(),this.drawWorkshopButton(),this.drawSurvivalButton(),this.drawLastUpdatedText(),this.getSettings().isMobile,this.draw()}update(){this.rainbowText.update()}drawTitle(){this.titleText=this.ui.drawBitmapText({x:0,y:0,text:i.mainConfig.gameTitle,fontSize:32,origin:[.5,.5]})}drawVersionText(){this.versionText=this.ui.drawOriginalText({x:0,y:0,text:"v1.0.0",fontSize:14,origin:[.5,.5]})}drawPlayerLevelText(){var e;this.playerLevelText=this.ui.drawOriginalText({x:0,y:0,text:((null===(e=this.getData().player)||void 0===e?void 0:e.level)+1||1).toString(),fontSize:20,origin:[.5,.5]})}drawSubtitle(){this.rainbowText=this.ui.drawRainbowText({x:0,y:0,text:i.mainConfig.gameSubtitle})}drawLevelText(){const{getText:e}=this.game.i18n,t=this.getData().level+1;this.levelText=this.ui.drawOriginalText({x:0,y:0,text:`${e("nextLevel")}: ${t}. ${e(`level${t}Title`)}`,fontSize:19,origin:[.5,.5]})}drawPlayerLevel(){const{graphics:e}=this,t=this.cosmons.getPosition(),s=t.x-this.cosmons.getHalfWidth()-25-20,i=t.y,a=new Phaser.Geom.Circle(s,i,25);this.playerLevelText.x=s,this.playerLevelText.y=i,e.strokeCircleShape(a)}drawStartButton(){this.startButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("gameStart"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.ad),this.getSettings().isMobile&&setTimeout(()=>{n.showFullscreen(this.game.canvas)},a.FULLSCREEN_TIMEOUT_DELAY)}}})}drawContactsButton(){this.contactsButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("contacts"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{text:this.game.i18n.getTemplateText("contactDeveloper.template",{args:{email:a.DEVELOPER_EMAIL}}),textSize:a.fontSizes.text})}}})}drawStoreButton(){this.storeButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("store"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.store)}}})}drawLeaderboardButton(){this.leaderboardButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("leaderboard"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.leaderboards)}}})}drawWorkshopButton(){this.workshopButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("workshop"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{text:this.game.i18n.getText("soon"),textSize:a.fontSizes.title})}}})}drawSurvivalButton(){this.survivalButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("survival"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.suvivalPreview,{})}}})}drawRankedBossesButton(){this.rankedBossesButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("rankedBosses"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{text:this.game.i18n.getText("soon"),textSize:a.fontSizes.title})}}})}drawLastUpdatedText(){const{getText:e}=this.game.i18n,t=this.getSettings().isMobile,s=t?[1,.5]:[.5,.5],a=new Date(i.env.buildTime).toLocaleString();this.lastUpdatedText=this.ui.drawOriginalText({x:0,y:0,text:t?a:`${e("lastUpdated")}: ${a}`,fontSize:t?14:16,origin:s})}drawInfoButton(e,t){this.ui.drawArcButton({x:e,y:t,arc:20,render:()=>{this.add.text(e,t,"?",{font:"22px Arial",fill:"#fff"}).setOrigin(.5)},callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{})}}})}initContentPositions(){const e=this.getGameCenter();this.titleText.x=e.x,this.titleText.y=e.y-5,this.rainbowText.setPosition(e.x,this.titleText.y+50),this.cosmons.updatePosition(e.x+25+20,this.rainbowText.getPosition().y+55),this.levelText.x=e.x,this.levelText.y=this.cosmons.getPosition().y+65;const t=this.levelText.y+a.defaultButtonParams.spaceY,s=this.levelText.y+a.defaultButtonParams.spaceY+a.defaultButtonParams.spaceY;this.storeButton.updatePosition(e.x-a.defaultButtonParams.width190-a.defaultButtonParams.spaceX,t),this.leaderboardButton.updatePosition(e.x+a.defaultButtonParams.width190+a.defaultButtonParams.spaceX,t),this.contactsButton.updatePosition(e.x-a.defaultButtonParams.width190-a.defaultButtonParams.spaceX,s),this.workshopButton.updatePosition(e.x+a.defaultButtonParams.width190+a.defaultButtonParams.spaceX,s),this.survivalButton.updatePosition(e.x,s),this.startButton.updatePosition(e.x,t)}draw(){const{graphics:e}=this,t=this.getGameCenter(),s=this.getGameSize(),{isMobile:i}=this.getSettings(),{fullscreenXOffset:a,fullscreenYOffset:o}=this.getResizeParams();e.clear(),this.initContentPositions();const n=(this.survivalButton.getPosition().y-this.titleText.y)/2;this.titleText.y=this.titleText.y-n,this.titleText.x=this.titleText.x-this.versionText.width/2,this.rainbowText.setPosition(t.x,this.rainbowText.getPosition().y-n),this.cosmons.updatePosition(this.cosmons.getPosition().x,this.cosmons.getPosition().y-n),this.levelText.y=this.levelText.y-n,this.storeButton.updatePosition(this.storeButton.getPosition().x,this.storeButton.getPosition().y-n),this.leaderboardButton.updatePosition(this.leaderboardButton.getPosition().x,this.leaderboardButton.getPosition().y-n),this.startButton.updatePosition(t.x,this.startButton.getPosition().y-n),this.contactsButton.updatePosition(this.contactsButton.getPosition().x,this.contactsButton.getPosition().y-n),this.workshopButton.updatePosition(this.workshopButton.getPosition().x,this.workshopButton.getPosition().y-n),this.survivalButton.updatePosition(this.survivalButton.getPosition().x,this.survivalButton.getPosition().y-n),i?(this.lastUpdatedText.x=s.width-20-a,this.lastUpdatedText.y=25+o):(this.lastUpdatedText.x=t.x,this.lastUpdatedText.y=s.height-35),this.lastUpdatedText,this.versionText.x=this.titleText.x+this.titleText.width/2+this.versionText.width/2,this.versionText.y=this.titleText.y+4,this.drawPlayerLevel()}onGameResize(){this.draw()}}t.MenuScene=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewScene=void 0;const i=s(1),a=s(5),o=s(0),n=s(6),r=[i.defaultUISpacings.textY];class h extends n.Scene{constructor(){super({key:o.ESceneName.preview})}init(e){this.params=e}create(){const e=this.getData().level,t=this.getGameCenter();this.titleText=this.ui.drawOriginalText({x:t.x,y:t.y,text:`${e+1}. ${this.game.i18n.getText(`level${e+1}Title`)}`,fontSize:32,origin:[.5,0],align:"center"}),this.missionText=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.translations.getMissionText(a.levelsConfig.levels[e].mode),fontSize:18,align:"center",origin:[.5,0],color:i.colors.green}),this.missionText.y=this.titleText.y+this.titleText.displayHeight+r[0],this.drawGoButton(this.missionText.y+this.missionText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText),this.updateContentPositions()}drawGoButton(e){const t=this.getGameSize();this.goButton=this.ui.drawButton({x:t.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("go"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.loading,{})}}})}updateContentPositions(){const e=(this.goButton.getPosition().y+i.defaultButtonParams.height/2-this.titleText.y)/2;this.titleText.y-=e,this.missionText.y-=e,this.goButton.updatePosition(this.goButton.getPosition().x,this.goButton.getPosition().y-e)}}t.PreviewScene=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WinScene=void 0;const i=s(5),a=s(1),o=s(0),n=s(2),r=s(6),h=[a.defaultUISpacings.textY,a.defaultUISpacings.cosmonsY,70];class l extends r.Scene{constructor(){super({key:o.ESceneName.win}),this.menuButton=null,this.storeButton=null,this.isLastLevel=!1}init(e){this.params=e}create(){const e=this.getData(),{money:t,isFlawlessVictory:s}=this.params;this.isLastLevel=i.mainConfig.totalLevelsCount<=e.level+1;const a=s?Math.ceil(.5*t):0,o=t+a,n={currentLevel:e.level,money:t,totalMoney:o,flawlessVictoryMoney:a};this.drawTitle(0,0),this.drawStats(0,0,n),this.drawCosmons(0,0,n.totalMoney),this.drawNextButton(0,0),this.isLastLevel?(this.menuButton=null,this.storeButton=null):(this.drawStoreButton(0,0),this.drawMenuButton(0,0)),this.draw(),this.updateData(o)}drawTitle(e,t){const{getText:s}=this.game.i18n;this.titleText=this.ui.drawOriginalText({x:e,y:t,text:s("winTitle"),origin:[.5,0],fontSize:28,color:a.colors.green})}drawStats(e,t,s){const i=this.params,{getText:a}=this.game.i18n,o=Math.floor(i.time/1e3),r=[`${a("stars")}: ${i.money} (+${i.money})`,`${a("killed")}: ${i.totalKills}`,`${a("score")}: ${i.score}`,`${a("time")}: ${n.getTimeStringFromSeconds(o)}`,`${a("flawlessVictory")}: ${s.flawlessVictoryMoney} (+${s.flawlessVictoryMoney})`,`${a("totalStars")}: ${s.totalMoney}`].join("\n");this.statsText=this.ui.drawOriginalText({x:e,y:t,text:r,fontSize:18,origin:[.5,0],align:"center"})}drawCosmons(e,t,s){this.cosmons=this.ui.drawCosmons({x:e,y:t,isCentered:!0,value:s,prefix:"+",depth:100})}drawNextButton(e,t){const{getText:s}=this.game.i18n;this.nextButton=this.ui.drawButton({x:e,y:t,text:this.isLastLevel?s("next2"):s("next"),responsive:{paddingX:a.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.isLastLevel?this.scene.start(o.ESceneName.final):this.scene.start(o.ESceneName.ad)}}})}drawMenuButton(e,t){const{getText:s}=this.game.i18n;this.menuButton=this.ui.drawButton({x:e,y:t,text:s("goToMenu"),responsive:{paddingX:a.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}})}drawStoreButton(e,t){const{getText:s}=this.game.i18n;this.storeButton=this.ui.drawButton({x:e,y:t,text:s("store"),responsive:{paddingX:a.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.store)}}})}updateData(e){const{params:t}=this,s=this.getData(),{level:i}=s,{leaderboards:a}=this.game;n.sendMetrikaGoal(o.EGoalTargetName.levelCompleted,{level:i+1}),a.addLeaderboardScore(t.score),this.isLastLevel?this.setData("level",0):(this.setData("level",i+1),this.setData("player",{level:i+1})),this.setData("money",s.money+e),this.game.localStorage.setGameData({money:s.money,level:s.level,player:s.player})}initContentPositions(){var e,t;const s=this.getGameCenter();this.titleText.x=s.x,this.titleText.y=s.y,this.statsText.x=s.x,this.statsText.y=this.titleText.y+this.titleText.displayHeight+h[0],this.cosmons.updatePosition(s.x,this.statsText.y+this.statsText.displayHeight+h[1]);const i=Math.round(a.defaultButtonParams.width/2)+Math.round(a.defaultButtonParams.spaceX/2),o=this.cosmons.getPosition().y+h[2];this.nextButton.updatePosition(s.x+i,o),null===(e=this.storeButton)||void 0===e||e.updatePosition(s.x-i,o),null===(t=this.menuButton)||void 0===t||t.updatePosition(s.x-i,o)}draw(){const e=this.getGameCenter();this.initContentPositions();const t=(this.nextButton.getPosition().y+a.defaultButtonParams.height/2-this.titleText.y)/2;this.titleText.y-=t,this.statsText.y-=t,this.cosmons.updatePosition(this.cosmons.getPosition().x,this.cosmons.getPosition().y-t);const s=this.nextButton.getParams().pos.y-t;if(this.menuButton&&this.storeButton){this.storeButton.updatePosition(e.x,s);const t=this.storeButton.getSize().width,i=this.nextButton.getSize().width,o=this.menuButton.getSize().width;this.nextButton.updatePosition(e.x+i/2+t/2+a.defaultButtonParams.spaceX,s),this.menuButton.updatePosition(e.x-o/2-t/2-a.defaultButtonParams.spaceX,s)}else this.nextButton.updatePosition(e.x,s)}onGameResize(){this.draw()}}t.WinScene=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FailScene=void 0;const i=s(1),a=s(2),o=s(0),n=s(6),r=[i.defaultUISpacings.textY,i.defaultUISpacings.cosmonsY,70];class h extends n.Scene{constructor(){super({key:o.ESceneName.fail})}preload(){}init(e){this.params=e}create(){const e=this.getData(),{getText:t}=this.game.i18n,{score:s,money:a}=this.params,{leaderboards:o}=this.game;o.addLeaderboardScore(s),this.setData("money",e.money+a),this.game.localStorage.setGameData({money:e.money}),this.titleText=this.ui.drawOriginalText({x:0,y:0,text:t("failTitle"),origin:[.5,0],fontSize:28,color:i.colors.red}),this.drawStats(),this.drawCosmons(),this.drawTryAgainButton(),this.drawMenuButton(),this.draw()}drawStats(){const e=this.params,{getText:t}=this.game.i18n,s=Math.floor(e.time/1e3),i=[`${t("stars")}: ${e.money}`,`${t("killed")}: ${e.totalKills}`,`${t("score")}: ${e.score}`,`${t("time")}: ${a.getTimeStringFromSeconds(s)}`].join("\n");this.statsText=this.ui.drawOriginalText({x:0,y:0,text:i,fontSize:18,origin:[.5,0],align:"center"})}drawCosmons(){this.cosmons=this.ui.drawCosmons({x:0,y:0,isCentered:!0,value:this.params.money,prefix:"+",depth:100})}drawMenuButton(){const{getText:e}=this.game.i18n;this.menuButton=this.ui.drawButton({x:0,y:0,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:e("goToMenu"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}})}drawTryAgainButton(){const{getText:e}=this.game.i18n;this.tryAgainButton=this.ui.drawButton({x:0,y:0,text:e("tryAgain"),responsive:{paddingX:i.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.loading,{})}}})}initContentPositions(){var e;const t=this.getGameCenter();this.titleText.y=t.y,this.titleText.x=t.x,this.statsText.x=t.x,this.statsText.y=this.titleText.y+this.titleText.displayHeight+r[0],this.cosmons.updatePosition(t.x,this.statsText.y+this.statsText.displayHeight+r[1]);const s=this.cosmons.getPosition().y+r[2];this.tryAgainButton.updatePosition(t.x+this.tryAgainButton.getSize().width/2+i.defaultButtonParams.spaceX/2,s),null===(e=this.menuButton)||void 0===e||e.updatePosition(t.x-this.menuButton.getSize().width/2-i.defaultButtonParams.spaceX/2,s)}draw(){this.initContentPositions();const e=(this.menuButton.getPosition().y+i.defaultButtonParams.height/2-this.titleText.y)/2;this.titleText.y-=e,this.statsText.y-=e,this.cosmons.updatePosition(this.cosmons.getPosition().x,this.cosmons.getPosition().y-e),this.menuButton.updatePosition(this.menuButton.getPosition().x,this.menuButton.getPosition().y-e),this.tryAgainButton.updatePosition(this.tryAgainButton.getPosition().x,this.tryAgainButton.getPosition().y-e)}onGameResize(){this.draw()}}t.FailScene=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;var i=s(131);Object.defineProperty(t,"GameScene",{enumerable:!0,get:function(){return i.GameScene}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;const i=s(5),a=s(2),o=s(132),n=s(6),r=s(170),h=s(21),l=s(0),d=s(171),c=s(177),u=s(178);let m=!1;class p extends n.Scene{constructor(){super({key:l.ESceneName.game}),this.enemies=[],this.bullets=[],this.effects=[],this.bonuses=[],this.instances=[],this.boss=null,this.lives=2,this.money=0,this.score=0,this.stats=c.getInitialGameStats(),this.isWon=!1,this.isFail=!1,this.gameTime=0,this.deltaTime=0,this.isPaused=!1}init(e){this.params=e}create(){const{isSurvival:e}=this.params;this.resetState(),e||a.sendMetrikaGoal(l.EGoalTargetName.levelStart,{level:this.getData().level+1});const t=this.getGameSize(),s=1+a.getRandomInt(0,1),i="background-"+s,o=this.getSettings().isMobile?u.backgroundOffset[s]:{x:0,y:0};this.physics.world.setBounds(0,0,t.width,t.height),this.background=this.add.image(o.x,o.y,i).setOrigin(0,0),this.updateBackgroundColor(),this.player=new r.Player(this),this.utils=new d.Utils(this),this.rewardedModal=new h.UIRewardedModal(this,{pos:this.getGameCenter(),onProgressEnd:()=>{this.destroyPlayer()},onRewarded:()=>{this.revivePlayer(),this.services.interface.hideModalOverlay()},onCancelReward:()=>{this.destroyPlayer()},onExit:()=>{this.destroyPlayer()}}),this.initListeners(),this.initServices(),this.getSettings().isMobile&&this.initPointers(),this.shakeCamera=this.cameras.add(0,0,t.width,t.height),m=!0}initListeners(){const e=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.M),t=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Q),s=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.B),o=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.F);e.on("down",()=>{this.player.body.active&&!this.isPaused&&this.scene.start(l.ESceneName.menu)}),t.on("down",()=>{i.IS_DEV&&this.player.body.active&&this.setPause(!this.isPaused)}),s.on("down",()=>{i.IS_DEV&&this.player.body.active&&this.updateBackgroundColor()}),o.on("down",()=>{i.IS_DEV&&this.player.body.active&&a.showFullscreen(this.game.canvas)})}initServices(){const{isSurvival:e}=this.params;this.services={stars:new o.StarsService(this,{count:20}),meteors:new o.MeteorsService(this,{}),interface:new o.InterfaceService(this,{}),level:new o.LevelService(this,{isSurvival:e}),comets:new o.CometsService(this,{}),bonuses:new o.BonusesService(this,{}),logger:new o.LoggerService(this,{}),firefly:new o.FireflyService(this,{})}}initPointers(){const e=this.getGameSize();m||this.input.addPointer(1),this.input.on("pointerdown",t=>{const s=new Phaser.Geom.Circle(i.mainConfig.touch.areaOffset,e.height-i.mainConfig.touch.areaOffset,i.mainConfig.touch.areaSize),a=(new Phaser.Geom.Circle(e.width-i.mainConfig.touch.areaOffset,e.height-i.mainConfig.touch.areaOffset,i.mainConfig.touch.areaSize),new Phaser.Geom.Circle(t.x,t.y,i.mainConfig.touch.pointerRadius));Phaser.Geom.Intersects.CircleToCircle(s,a)?this.player.setPointer("left",t):this.player.setPointer("right",t)},this),this.input.on("pointerup",e=>{this.player.pointers.left===e&&this.player.onLeftPointerUp(),this.player.pointers.right===e&&this.player.onRightPointerUp()},this)}update(e,t){var s;this.updateSceneTime(e,t),this.rewardedModal.update(),this.isPaused||(this.deltaTime=t/i.mainConfig.scene.delta,this.gameTime+=15*this.deltaTime,this.enemies.forEach(s=>{s.act(e,t)}),this.bullets.forEach(s=>{s.act(e,t)}),this.effects.forEach(e=>{e.act()}),Object.keys(this.services).forEach(s=>{this.services[s].act(e,t)}),this.bonuses.forEach(e=>{e.act()}),this.instances.forEach(s=>{s.act(e,t)}),null===(s=this.boss)||void 0===s||s.act(e,t),this.player.act(e,t))}resetState(){this.bullets=[],this.enemies=[],this.effects=[],this.bonuses=[],this.instances=[],this.boss=null,this.score=0,this.money=0,this.text="",this.lives=2,this.stats=c.getInitialGameStats(),this.isWon=!1,this.isFail=!1,this.setPause(!1),this.gameTime=0}onFail(){this.isFail=!0,this.services.interface.onFail(),this.shakeScreen(),setTimeout(()=>{this.params.isSurvival?this.scene.start(l.ESceneName.survivalResults,{money:this.money,score:this.score,totalKills:this.getStats().totalKills,time:this.gameTime}):this.scene.start(l.ESceneName.fail,{money:this.money,score:this.score,totalKills:this.getStats().totalKills,time:this.gameTime})},i.mainConfig.scene.failTimeoutTime)}onWin(){this.isWon||this.isFail||(this.isWon=!0,setTimeout(()=>{this.isFail||this.scene.start(l.ESceneName.win,{money:this.money,score:this.score,isFlawlessVictory:this.player.hp===this.player.maxHp,totalKills:this.getStats().totalKills,time:this.gameTime})},i.mainConfig.scene.winTimeoutTime))}onPlayerZeroHp(){this.services.interface.draw(),this.isFail=!0,this.lives>0?(this.lives-=1,this.showFailRewardedModal()):this.player.destroy()}destroyPlayer(){this.setPause(!1),this.services.interface.hideModalOverlay(),this.rewardedModal.hide(),this.player.destroy()}showFailRewardedModal(){this.setPause(!0),this.services.interface.showModalOverlay(),this.rewardedModal.show()}revivePlayer(){this.setPause(!1),this.isFail=!1,this.isWon=!1,this.rewardedModal.hide(),this.player.revive()}shakeScreen(){this.shakeCamera.shake(500,.003)}updateBackgroundColor(){this.background.setTint(a.getRandomHexColor(),a.getRandomHexColor(),a.getRandomHexColor(),a.getRandomHexColor())}isBoosterActive(){return null!==this.player.currentBooster}getLevelMode(){const e=this.getData().level;return i.levelsConfig.levels[e].mode}getActiveBooster(){return this.player.currentBooster}getStats(){return this.stats}setPause(e){this.isPaused=e}onGameResize(){this.services.interface.onGameResize(),this.rewardedModal.setPosition(this.getGameCenter())}}t.GameScene=p},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=t.BonusesService=t.FireflyService=t.CometsService=t.LevelService=t.InterfaceService=t.LoggerService=t.MeteorsService=t.StarsService=void 0;var i=s(133);Object.defineProperty(t,"StarsService",{enumerable:!0,get:function(){return i.StarsService}});var a=s(135);Object.defineProperty(t,"MeteorsService",{enumerable:!0,get:function(){return a.MeteorsService}});var o=s(137);Object.defineProperty(t,"LoggerService",{enumerable:!0,get:function(){return o.LoggerService}});var n=s(138);Object.defineProperty(t,"InterfaceService",{enumerable:!0,get:function(){return n.InterfaceService}});var r=s(139);Object.defineProperty(t,"LevelService",{enumerable:!0,get:function(){return r.LevelService}});var h=s(164);Object.defineProperty(t,"CometsService",{enumerable:!0,get:function(){return h.CometsService}});var l=s(166);Object.defineProperty(t,"FireflyService",{enumerable:!0,get:function(){return l.FireflyService}});var d=s(168);Object.defineProperty(t,"BonusesService",{enumerable:!0,get:function(){return d.BonusesService}});var c=s(11);Object.defineProperty(t,"Service",{enumerable:!0,get:function(){return c.Service}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarsService=void 0;const i=s(134),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.stars=[],this.params=t,this.init()}init(){const{scene:e}=this,{count:t}=this.params;for(let s=0;s<t;s++)this.stars.push(new i.Star(e,{initialAlphaCoef:500*s}))}act(e,t){this.update(e,t)}update(e,t){this.stars.forEach(s=>{s.act(e,t)})}}t.StarsService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Star=void 0;t.Star=class{constructor(e,t){const s=e.getGameSize();this.scene=e,this.body=e.ui.drawImage({x:Math.random()*s.width,y:Math.random()*s.height,texture:"star"}),this.initialCoef=t.initialAlphaCoef,this.body.setDepth(0),this.body.setScale(.25+.25*Math.random())}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:i,initialCoef:a,lastRelocationTime:o}=this,n=s.gameTime;i.angle+=4*s.deltaTime,i.alpha=Math.sin((n+a)/1500);const r=this.scene.getGameSize();n>o&&i.alpha<=.5&&(i.x=Math.random()*r.width,i.y=Math.random()*r.height,this.lastRelocationTime=n+1e3)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeteorsService=void 0;const i=s(3),a=s(136),o=s(2),n=s(11);class r extends n.Service{constructor(e,t){super(e),this.meteors=[],this.meteorIntervalTime=1e3,this.meteorIntervalTimeRange=1e3,this.lastMeteorTime=0,this.maxCount=25,this.params=t,this.init()}init(){for(let e=0;e<o.getRandomInt(5,8);e++)this.spawnMeteor({outside:!1});for(let e=0;e<o.getRandomInt(3,5);e++)this.spawnMeteor({outside:!0})}act(e,t){this.update(e,t)}update(e,t){const s=this.scene.getGameSize(),{scene:i,maxCount:a}=this,{deltaTime:o,gameTime:n}=i;n>this.lastMeteorTime&&this.meteors.length<a&&this.spawnMeteor({outside:!0}),this.meteors.forEach(e=>{const{body:t,speed:i}=e;t.angle+=.5*i.x*o,t.x+=i.x*o,t.y+=i.y*o,(t.x>s.width+200||t.y>s.height+200)&&(this.meteors=this.meteors.filter(t=>t!==e),t.destroy())})}spawnMeteor({outside:e}){const{scene:t,meteorIntervalTime:s,meteorIntervalTimeRange:n}=this,r=t.gameTime,h=.5+1*Math.random(),l=this.scene.getGameSize(),d=o.angleToRadians(45),c=.25+2.5*Math.random(),u=new i.Vector(c*Math.cos(d),c*Math.sin(d)),m=Math.random()>.5?"x":"y",p=e?{x:"x"===m?Math.random()*(.75*l.width)-200:-200,y:"y"===m?Math.random()*(.75*l.height)-200:-200}:{x:l.width*Math.random(),y:l.height*Math.random()};this.meteors.push(new a.Meteor(t,p,u,{spriteIndex:1+Math.floor(4*Math.random()),alpha:.25+.4*Math.random(),scale:h})),this.lastMeteorTime=Math.random()*n+r+s*h}}t.MeteorsService=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Meteor=void 0;t.Meteor=class{constructor(e,t,s,i){this.scene=e,this.body=e.ui.drawImage({x:t.x,y:t.y,texture:"meteor-"+i.spriteIndex}),this.speed=s,this.body.setAlpha(i.alpha),this.body.setDepth(5),this.body.setScale(i.scale,i.scale)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerService=void 0;const i=s(5),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.lastLogTime=0,this.params=t,this.init()}init(){}act(){this.update()}update(){const e=this.scene,t=e.gameTime;t>this.lastLogTime&&i.IS_DEV&&(console.group("Stats"),console.log("effects: "+e.effects.length),console.log("enemies: "+e.enemies.length),console.log("bullets: "+e.bullets.length),console.groupEnd(),console.log("Total kills: ",e.getStats().kills),this.lastLogTime=t+2e3)}}t.LoggerService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterfaceService=void 0;const i=s(5),a=s(1),o=s(3),n=s(0),r=s(21),h=s(11),l=20,d=20,c=20,u=20,m=55,p=40,g=20,y=21,v=20,S=200,b=12,f={[n.EBoosterType.damage]:a.colors.red,[n.EBoosterType.speed]:a.colors.yellow,[n.EBoosterType.regenerator]:a.colors.green,[n.EBoosterType.shield]:a.colors.aqua};class x extends h.Service{constructor(e,t){super(e),this.isOverlayVisible=!1,this.backgroundParams={initialAlpha:0,changeTime:15e3,canChangeColor:!1},this.params=t,this.init()}init(){const{scene:e}=this,t=this.scene.getGameSize();this.pauseButton=new r.UIPauseButton(e,{pos:new o.Vector(0,0),depth:a.depths.graphics,callbacks:{onChange:t=>{e.setPause(t)}}}),this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),this.graphicsOverlay=e.add.graphics({fillStyle:{color:a.colors.gray2}}),this.graphicsOverlay.setDepth(a.depths.overlay),this.graphicsOverlay.setAlpha(.5),this.counterText=this.scene.ui.drawBitmapText({x:0,y:0,text:"0",fontSize:24,origin:[1,.5],depth:a.depths.graphics,letterSpacing:3}),this.debugText=this.scene.ui.drawBitmapText({x:0,y:0,text:"",fontSize:16,origin:[0,.5],depth:a.depths.graphics}),this.cosmons=this.scene.ui.drawCosmons({x:0,y:0,value:0,isCentered:!1,depth:a.depths.graphics}),this.playerHealthbar=new Phaser.Geom.Rectangle(0,0,t.width,b),this.bossHealthbar=new Phaser.Geom.Rectangle(0,0,t.width,b),this.graphics.setDepth(a.depths.graphics),this.initBooster(),this.boosterCircleProgress=new r.UICircleProgress(this.scene,{pos:new o.Vector(0,0)}),this.backgroundParams.initialAlpha=Math.random()*(5*this.backgroundParams.changeTime),e.getSettings().isMobile&&this.initTouchAreas(),this.updatePositions()}initBooster(){const e=this.scene.ui.drawImage({x:0,y:0,texture:"bonus-speed",scale:.6,depth:a.depths.graphics});this.booster={image:e}}initTouchAreas(){this.leftTouchArea=this.scene.ui.drawImage({x:0,y:0,texture:"touch-area",scale:.022*i.mainConfig.touch.areaSize}),this.rightTouchArea=this.scene.ui.drawImage({x:0,y:0,texture:"touch-area",scale:.022*i.mainConfig.touch.areaSize})}act(){this.draw(),this.update()}draw(){const{scene:e,graphics:t}=this,{player:s,boss:i}=e;t.clear(),this.drawStatus(),this.drawHealthbar({firstColor:a.colors.green,secondColor:a.colors.red,healthbarRect:this.playerHealthbar,hp:s.hp,maxHp:s.maxHp}),i&&this.drawHealthbar({firstColor:a.colors.white,secondColor:a.colors.red,healthbarRect:this.bossHealthbar,hp:i.hp,maxHp:i.maxHp,fromLeft:!0}),this.drawCosmons(),this.drawBoosters(),e.getSettings().isMobile&&this.drawPointers(),this.drawDebugPanel()}update(){this.updateBackground()}updateBackground(){const{scene:e,backgroundParams:t}=this,s=.25*(1+Math.sin((t.initialAlpha+e.gameTime)/t.changeTime));s>.4?this.backgroundParams.canChangeColor=!0:this.backgroundParams.canChangeColor&&s<.01&&(this.backgroundParams.canChangeColor=!1,e.updateBackgroundColor()),e.background.setAlpha(s)}drawStatus(){const{scene:e,counterText:t}=this;i.levelsConfig.levels[e.getData().level].mode.type!==n.EGameMode.boss?t.setText(e.text):t.setText("")}drawHealthbar(e){const{graphics:t}=this,{healthbarRect:s,firstColor:i,secondColor:o,hp:n,maxHp:r}=e;let h=n/r;e.fromLeft&&(h=1-h),t.fillStyle(o),s.width=S,t.fillRectShape(s),t.fillStyle(i),s.width=Math.max(S*h,0),t.fillRectShape(s),t.lineStyle(2,a.colors.white),s.width=S,t.strokeRectShape(s)}drawCosmons(){const{scene:e,cosmons:t}=this;t.updateValue(e.money),this.updateCosmonsPosition()}drawBoosters(){const{scene:e,booster:t}=this,{gameTime:s,player:i}=e;if(e.isBoosterActive()){t.image.visible=!0;const a=e.getActiveBooster()||"";t.image.setTexture(a);const o=(i.boosterParams.endTime-s)/(1e3*i.bonusesTime);this.boosterCircleProgress.update({percentage:o,color:f[a]})}else t.image.visible=!1,this.boosterCircleProgress.hide()}drawPointers(){const{graphics:e,scene:t}=this,s=t.player.pointers,a=this.scene.input.pointer1,o=this.scene.input.pointer2;!a.isDown||s.left!==a&&s.right!==a||e.strokeCircle(a.x,a.y,i.mainConfig.touch.pointerSize),!o.isDown||s.left!==o&&s.right!==o||e.strokeCircle(o.x,o.y,i.mainConfig.touch.pointerSize)}drawDebugPanel(){const{scene:e}=this;e.getQueryParam("fps")&&this.debugText.setText("FPS: "+this.scene.game.loop.actualFps.toFixed(2))}showModalOverlay(){const{graphicsOverlay:e,scene:t}=this;e.clear();const s=t.getGameSize(),i=new Phaser.Geom.Rectangle(0,0,s.width,s.height);e.fillRectShape(i),this.isOverlayVisible=!0,this.pauseButton.setDisabled(!0)}hideModalOverlay(){const{graphicsOverlay:e}=this;e.clear(),this.isOverlayVisible=!1,this.pauseButton.setDisabled(!1)}updatePositions(){const e=this.scene.getGameSize(),{fullscreenYOffset:t,fullscreenXOffset:s}=this.scene.getResizeParams();this.leftTouchArea&&(this.leftTouchArea.x=i.mainConfig.touch.areaOffset,this.leftTouchArea.y=e.height-i.mainConfig.touch.areaOffset),this.rightTouchArea&&(this.rightTouchArea.x=e.width-i.mainConfig.touch.areaOffset,this.rightTouchArea.y=e.height-i.mainConfig.touch.areaOffset);const a=this.pauseButton.getSize();this.pauseButton.setPosition(a.width/2+l+s,a.height/2+d+t);const o=this.pauseButton.getPosition();this.playerHealthbar.x=o.x+a.width/2+c,this.playerHealthbar.y=o.y-b/2,this.booster.image.x=this.playerHealthbar.x+S+p,this.booster.image.y=o.y,this.boosterCircleProgress.setPosition(this.playerHealthbar.x+S+p,o.y),this.counterText.x=e.width-v-s,this.counterText.y=o.y,this.debugText.x=o.x,this.debugText.y=o.y+g,this.bossHealthbar.x=e.width-S-y-s,this.bossHealthbar.y=o.y-b/2,this.updateCosmonsPosition()}updateCosmonsPosition(){const{scene:e,cosmons:t}=this,s=this.pauseButton.getPosition();e.isBoosterActive()?t.updatePosition(this.playerHealthbar.x+S+u+m,s.y):t.updatePosition(this.playerHealthbar.x+S+u,s.y)}onGameResize(){this.isOverlayVisible&&this.showModalOverlay(),this.updatePositions(),this.draw()}onFail(){this.pauseButton.setDisabled(!0)}}t.InterfaceService=x},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LevelService=void 0;const i=s(140),a=s(163),o=s(11);class n extends o.Service{constructor(e,t){super(e),this.params=t,this.init()}init(){const{scene:e}=this;if(this.params.isSurvival)this.currentLevel=new a.SurvivalLevel(e);else{const t=e.getData().level;this.currentLevel=new i.levels[t](e)}}act(){this.update()}update(){const{scene:e,currentLevel:t}=this,s=t.checkForWin();e.text=t.getTextByMode(),t.update(),s&&e.onWin()}}t.LevelService=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.levels=void 0;const i=s(141),a=s(149),o=s(150),n=s(151),r=s(152),h=s(153),l=s(154),d=s(155),c=s(156),u=s(157),m=s(158),p=s(159),g=s(160),y=s(161),v=s(162);t.levels=[i.Level1,a.Level2,o.Level3,n.Level4,r.Level5,h.Level6,l.Level7,d.Level8,c.Level9,u.Level10,m.Level11,p.Level12,g.Level13,y.Level14,v.Level15]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level1=void 0;const i=s(5),a=s(9),o=s(8);class n extends o.Level{constructor(e){super(e,0);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[0];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&e.utils.createEnemy(a.Bot)}}t.Level1=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalMode=t.BossMode=t.WavesMode=t.TimeMode=t.EnemyKillsMode=t.TotalKillsMode=t.Mode=void 0;var i=s(14);Object.defineProperty(t,"Mode",{enumerable:!0,get:function(){return i.Mode}});var a=s(143);Object.defineProperty(t,"TotalKillsMode",{enumerable:!0,get:function(){return a.TotalKillsMode}});var o=s(144);Object.defineProperty(t,"EnemyKillsMode",{enumerable:!0,get:function(){return o.EnemyKillsMode}});var n=s(145);Object.defineProperty(t,"TimeMode",{enumerable:!0,get:function(){return n.TimeMode}});var r=s(146);Object.defineProperty(t,"WavesMode",{enumerable:!0,get:function(){return r.WavesMode}});var h=s(147);Object.defineProperty(t,"BossMode",{enumerable:!0,get:function(){return h.BossMode}});var l=s(148);Object.defineProperty(t,"SurvivalMode",{enumerable:!0,get:function(){return l.SurvivalMode}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TotalKillsMode=void 0;const i=s(14);class a extends i.Mode{getStatus(){const e=this.scene.getStats(),t=Number(this.modeParams.target);return{value:t-e.totalKills,text:`${e.totalKills}/${t}`}}}t.TotalKillsMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnemyKillsMode=void 0;const i=s(14);class a extends i.Mode{getStatus(){const e=this.scene.getStats(),t=this.modeParams.target,s=Object.values(t).reduce((e,t)=>e+t,0),i=Object.keys(t).reduce((s,i)=>{const a=t[i];return s+Math.min(a,e.kills[i]||0)},0);return{value:s-i,text:`${i}/${s}`}}}t.EnemyKillsMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeMode=void 0;const i=s(14);class a extends i.Mode{getStatus(){const e=Math.ceil(this.scene.gameTime/1e3);return{value:Number(this.modeParams.target)-e,text:`${e}/${this.modeParams.target}`}}}t.TimeMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavesMode=void 0;const i=s(14);class a extends i.Mode{constructor(e,t){super(e,t),this.waveNumber=0,this.maxEnemies=0,this.setLevelState(0)}setLevelState(e){const t=this.scene.getSettings().isMobile,s=this.modeParams;if(e>=s.target.length)this.waveNumber=e,this.enemies=[],this.maxEnemies=0;else{const i=s.target[e].maxEnemies;this.waveNumber=e,this.enemies=[...s.target[e].enemies],this.maxEnemies=t?i-1:i}}getStatus(){const e=this.modeParams.target.length;return{value:e-this.waveNumber,text:`${Math.min(e,this.waveNumber+1)}/${e}`}}spawn(){const{maxEnemies:e,enemies:t}=this,s=this.modeParams.target.length,i=this.scene.enemies.length;if(i<e){const e=t.shift();e?this.scene.utils.createEnemy(e):i<=0&&this.waveNumber<s&&this.setLevelState(this.waveNumber+1)}}}t.WavesMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BossMode=void 0;const i=s(14);class a extends i.Mode{constructor(e,t){super(e,t),this.spawnBoss()}spawnBoss(){const{scene:e}=this,t=new this.modeParams.target(e);e.boss=t}getStatus(){const e=this.scene.boss.hp;return{value:e,text:`${e}/${this.scene.boss.maxHp}`}}}t.BossMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalMode=void 0;const i=s(1),a=s(2),o=s(14);class n extends o.Mode{getStatus(){const{gameTime:e}=this.scene,t=Math.floor(e/i.time.second),s=99*i.time.minute/1e3;return{value:1,text:`${this.scene.score} / ${a.getTimeStringFromSeconds(Math.min(t,s))}`}}}t.SurvivalMode=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level2=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,1);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[1];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,s=[a.Bot];return Math.random()>.15&&t<1&&s.push(a.Hunter),s}}t.Level2=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level3=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,2);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[2];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,s=e.enemies.filter(e=>e.name===o.EEnemyName.ufo).length,i=[a.Bot];return Math.random()>.4&&(t<1&&i.push(a.Hunter),s<1&&i.push(a.UFO)),i}}t.Level3=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level4=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,3)}update(){super.update()}spawn(){}}t.Level4=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level5=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,4)}spawn(){}}t.Level5=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level6=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,5);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[5];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.bot).length,s=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,i=e.enemies.filter(e=>e.name===o.EEnemyName.ufo).length,n=e.enemies.filter(e=>e.name===o.EEnemyName.flyer).length,r=[];return t<1&&r.push(a.Bot),s<1&&r.push(a.Hunter),i<1&&r.push(a.UFO),n<1&&r.push(a.Flyer),t>0&&s<2&&Math.random()>.4&&r.push(a.Hunter),t>0&&i<2&&Math.random()>.4&&r.push(a.UFO),r}}t.Level6=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level7=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,6);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[6];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.bot).length,s=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,i=e.enemies.filter(e=>e.name===o.EEnemyName.ufo).length,n=e.enemies.filter(e=>e.name===o.EEnemyName.flyer).length,r=e.enemies.filter(e=>e.name===o.EEnemyName.destroyer).length,h=[];return t<1&&Math.random()>.5&&h.push(a.Bot),s<1&&h.push(a.Hunter),i<1&&h.push(a.UFO),n<1&&h.push(a.Flyer),r<1&&h.push(a.Destroyer),n<2&&Math.random()>.4&&h.push(a.Flyer),r>0&&s<2&&Math.random()>.6&&h.push(a.Hunter),r>0&&i<2&&Math.random()>.6&&h.push(a.UFO),h}}t.Level7=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level8=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,7);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[7];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,s=e.enemies.filter(e=>e.name===o.EEnemyName.ufo).length,i=e.enemies.filter(e=>e.name===o.EEnemyName.flyer).length,n=e.enemies.filter(e=>e.name===o.EEnemyName.destroyer).length,r=e.enemies.filter(e=>e.name===o.EEnemyName.stealth).length,h=[];return r<1&&h.push(a.Stealth),t<1&&h.push(a.Hunter),s<1&&h.push(a.UFO),i<1&&h.push(a.Flyer),n<1&&h.push(a.Destroyer),r>0&&i<2&&h.push(a.Flyer),r>0&&n<2&&h.push(a.Destroyer),h}}t.Level8=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level9=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,8)}update(){super.update()}spawn(){}}t.Level9=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level10=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,9)}spawn(){}}t.Level10=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level11=void 0;const i=s(0),a=s(8),o=[{type:i.EEnemyName.missileCarrier,chance:70,max:1},{type:i.EEnemyName.stealth,chance:70,max:2},{type:i.EEnemyName.destroyer,chance:40,max:3},{type:i.EEnemyName.flyer,chance:30,max:3},{type:i.EEnemyName.ufo,chance:10},{type:i.EEnemyName.hunter,chance:2},{type:i.EEnemyName.bot,chance:0}];class n extends a.Level{constructor(e){super(e,10),this.spawnTimeInterval=this.spawnTimeInterval-500}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<5&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.scene.utils.getEnemyFromConfig(o);t&&e.utils.createEnemy(this.scene.utils.getEnemiesMap()[t.type])}}t.Level11=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level12=void 0;const i=s(0),a=s(8),o=[{type:i.EEnemyName.laserShip,chance:60,max:1},{type:i.EEnemyName.missileCarrier,chance:60,max:2},{type:i.EEnemyName.stealth,chance:60,max:2},{type:i.EEnemyName.destroyer,chance:40,max:3},{type:i.EEnemyName.flyer,chance:30,max:3},{type:i.EEnemyName.ufo,chance:10},{type:i.EEnemyName.hunter,chance:2},{type:i.EEnemyName.bot,chance:0}];class n extends a.Level{constructor(e){super(e,11),this.spawnTimeInterval=this.spawnTimeInterval-500}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<5&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.scene.utils.getEnemyFromConfig(o);t&&e.utils.createEnemy(this.scene.utils.getEnemiesMap()[t.type])}}t.Level12=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level13=void 0;const i=s(0),a=s(8),o=[{type:i.EEnemyName.defender,chance:60,max:1},{type:i.EEnemyName.laserShip,chance:45,max:2},{type:i.EEnemyName.missileCarrier,chance:45,max:2},{type:i.EEnemyName.stealth,chance:40,max:2},{type:i.EEnemyName.destroyer,chance:30,max:3},{type:i.EEnemyName.flyer,chance:20,max:3},{type:i.EEnemyName.ufo,chance:10},{type:i.EEnemyName.hunter,chance:2},{type:i.EEnemyName.bot,chance:0}];class n extends a.Level{constructor(e){super(e,12),this.spawnTimeInterval=this.spawnTimeInterval-500}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<5&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.scene.utils.getEnemyFromConfig(o);t&&e.utils.createEnemy(this.scene.utils.getEnemiesMap()[t.type])}}t.Level13=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level14=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,13),this.spawnTimeInterval=this.spawnTimeInterval-500}spawn(){}}t.Level14=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level15=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,14)}spawn(){}}t.Level15=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalLevel=void 0;const i=s(9),a=s(8),o=s(5),n=s(2),r=s(1),h={bot:i.Bot,hunter:i.Hunter,ufo:i.UFO,defender:i.Defender,flyer:i.Flyer,stealth:i.Stealth,"laser-ship":i.LaserShip,"missile-carrier":i.MissileCarrier,destroyer:i.Destroyer};class l extends a.Level{constructor(e){super(e,0,{isSurvival:!0}),this.spawnIntervalLimit=500,this.nextUpdateSpawnIntervalTime=0,this.nextUpdateMaxEnemiesCountTime=0,this.spawnIntervalUpdateLevel=1,this.maxEnemiesUpdateLevel=1;const t=this.scene.getSettings().isMobile,s=this.scene.getData().player.level,i=t?6:7;this.maxEnemiesCount=2+Math.floor(s/3),this.enemiesLimit=i+Math.floor(s/2),this.availableEnemies=function(e){return Object.entries(o.enemiesConfig.ships).reduce((t,s)=>{const i=s[0];return s[1].level<=e+1&&h[i]?[...t,h[i]]:t},[])}(s)}spawn(){const{scene:e}=this,{enemies:t,gameTime:s}=e;if(t.length<this.maxEnemiesCount){const t=this.availableEnemies[n.getRandomInt(0,this.availableEnemies.length-1)];e.utils.createEnemy(t)}s>this.nextUpdateSpawnIntervalTime&&(this.spawnIntervalUpdateLevel+=1,this.spawnTimeInterval=Math.max(this.spawnTimeInterval-100,this.spawnIntervalLimit),this.nextUpdateSpawnIntervalTime=e.gameTime+r.time.second*(this.spawnIntervalUpdateLevel/2*20)),s>this.nextUpdateMaxEnemiesCountTime&&(this.maxEnemiesUpdateLevel+=1,this.maxEnemiesCount=Math.min(this.maxEnemiesCount+1,this.enemiesLimit),this.nextUpdateMaxEnemiesCountTime=e.gameTime+r.time.second*(this.maxEnemiesUpdateLevel/2*30))}}t.SurvivalLevel=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CometsService=void 0;const i=s(165),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.comets=[],this.count=15,this.params=t,this.init()}init(){const{scene:e,count:t}=this;for(let s=0;s<t;s++)this.comets.push(new i.Comet(e,{}))}act(e,t){this.update(e,t)}update(e,t){const s=this.scene.getGameSize(),{deltaTime:i}=this.scene;this.comets.forEach(e=>{const{body:t}=e;t.y+=e.speed*i,t.y>s.height+100&&(e.updateParams(),e.refreshPosition())})}}t.CometsService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Comet=void 0;const i=s(2);t.Comet=class{constructor(e,t){this.speed=3;const s=e.getGameSize();this.scene=e,this.body=e.ui.drawImage({x:i.getRandomInt(0,s.width),y:i.getRandomInt(0,s.height),texture:"comet"}),this.updateParams()}updateParams(){const{body:e}=this;e.setAlpha(.15+.3*Math.random()),e.setScale(.2,.75+.5*Math.random()),this.speed=i.getRandomInt(3,7)}refreshPosition(){const{body:e}=this,t=this.scene.getGameSize();e.x=i.getRandomInt(0,t.width),e.y=-100}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FireflyService=void 0;const i=s(5),a=s(3),o=s(167),n=s(11);class r extends n.Service{constructor(e,t){super(e),this.nextSpawnTime=0,this.fireflyersCreatedCount=0,this.params=t,this.updateNextSpawnTime()}act(e,t){this.update(e,t)}update(e,t){const{scene:s}=this,{gameTime:a}=s;this.scene.getStats();this.fireflyersCreatedCount<i.fireflyConfig.maxCountPerLevel&&a>=this.nextSpawnTime&&(this.spawnFirefly(),this.updateNextSpawnTime())}updateNextSpawnTime(e=i.fireflyConfig.spawnTimeInterval,t=i.fireflyConfig.spawnTimeIntervalRange){const{scene:s}=this,{gameTime:a}=s;this.nextSpawnTime=a+e+t*Math.random()}spawnFirefly(){const{scene:e}=this,t=this.scene.getGameSize(),s=new o.Firefly(e,{pos:new a.Vector(t.width*Math.random(),t.height*Math.random())});this.fireflyersCreatedCount+=1,this.scene.instances.push(s)}}t.FireflyService=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Firefly=void 0;const i=s(5),a=s(3),o=s(2),n=s(0),r=s(31);t.Firefly=class{constructor(e,t){this.targetTimeInterval=i.fireflyConfig.targetTimeInterval,this.targetTimeIntervalRange=i.fireflyConfig.targetTimeIntervalRange,this.hp=i.fireflyConfig.hp,this.scale=i.fireflyConfig.scale,this.bodySize=i.fireflyConfig.bodySize,this.speed=i.fireflyConfig.speed,this.rotateSpeed=i.fireflyConfig.rotateSpeed,this.angle=0,this.targetAngle=0,this.lastChangeTargetTime=0,this.lifeTime=0,this.scene=e,this.params=t,this.init()}init(){const{scene:e,params:t,scale:s}=this,a=e.gameTime;this.body=e.physics.add.image(t.pos.x,t.pos.y,"firefly"),this.body.setScale(s),this.body.setDepth(i.fireflyConfig.depth),this.body.setImmovable(!0),this.body.setAlpha(0),this.lifeTime=a+i.fireflyConfig.lifeTime+Math.random()*i.fireflyConfig.lifeTimeRange,this.initCollisions()}initCollisions(){const{scene:e}=this;e.bullets.forEach(t=>{e.physics.add.collider(this.body,t.body,()=>{t.owner===n.EOwner.player&&this.hit()})})}act(e,t){this.update(e,t)}update(e,t){const{scene:s,lifeTime:a}=this,o=s.gameTime;o>this.lastChangeTargetTime&&this.updateTarget(),this.updateBase(e,t),this.updateBodySize(),o>=a?this.body.alpha>i.fireflyConfig.alphaChange?this.body.setAlpha(this.body.alpha-i.fireflyConfig.alphaChange*s.deltaTime):this.destroy():this.body.alpha<1&&this.body.setAlpha(this.body.alpha+i.fireflyConfig.alphaChange*s.deltaTime)}updateBase(e,t){const{scene:s,body:i,angle:a,targetAngle:n,rotateSpeed:r}=this;this.body.angle=a-90;const h=o.angleToRadians(a);i.x+=this.speed*Math.cos(h)*s.deltaTime,i.y+=this.speed*Math.sin(h)*s.deltaTime,this.angle=o.getNearestAngle(a,n,r*s.deltaTime)}updateBodySize(){const{scene:e,scale:t,bodySize:s}=this,{gameTime:i}=e,a=t+.02*Math.sin(i/200);this.body.setScale(a);const n=o.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,a,s);this.body.setCircle(s,n.x,n.y)}updateTarget(){const{scene:e,targetTimeInterval:t,targetTimeIntervalRange:s}=this,i=e.gameTime;this.defineTarget();const a=t+Math.random()*s;this.lastChangeTargetTime=i+a}defineTarget(){const e=this.scene.utils.getRandomPos(10,20);this.setTarget(e)}setTarget(e){const{body:t}=this;this.targetAngle=o.getAngleBetweenPointsInDegrees(e,t)}onHit(){this.speed+=i.fireflyConfig.increaseSpeedOnHit,this.targetTimeInterval-=i.fireflyConfig.decreaseTargetTimeIntervalOnHit,this.targetTimeIntervalRange-=i.fireflyConfig.decreaseTargetTimeIntervalRangeOnHit,this.updateTarget()}hit(){const{scene:e,body:t}=this;this.hp-=1,this.onHit(),this.hp<=0&&(this.destroy(),e.effects.push(new r.FireflyExplode(e,{pos:new a.Vector(t.x,t.y),scale:t.scale})))}destroy(){const{body:e}=this;this.scene.instances=this.scene.instances.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BonusesService=void 0;const i=s(5),a=s(3),o=s(169),n=s(39),r=s(2),h=s(11);class l extends h.Service{constructor(e,t){super(e),this.prevTotalKills=0,this.params=t,this.init()}init(){this.updateNextSpawnTime()}act(e,t){this.update(e,t)}update(e,t){const{scene:s}=this,{gameTime:i}=s;if(i>=this.nextSpawnTime){const e=s.getStats().totalKills;e-2+1>this.prevTotalKills&&"boss"!==this.scene.getLevelMode().type&&(this.spawnBonus(),this.prevTotalKills=e),this.updateNextSpawnTime()}}spawnBonus(){const{scene:e}=this,t=e.getGameSize(),s=n.boosters[r.getRandomInt(0,3)];e.bonuses.push(new o.Booster(e,new a.Vector(r.getRandomInt(50,t.width-50),r.getRandomInt(i.mainConfig.scene.minYPos,t.height-50)),s))}updateNextSpawnTime(){const{scene:e}=this,{gameTime:t}=e,s=1e3*i.boostersConfig.spawnIntervalRangeTime,a=1e3*i.boostersConfig.spawnAdditionalTime+1e3*e.player.bonusesTime;this.nextSpawnTime=t+a+Math.random()*s}}t.BonusesService=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Booster=t.Bonus=void 0;var i=s(27);Object.defineProperty(t,"Bonus",{enumerable:!0,get:function(){return i.Bonus}});var a=s(39);Object.defineProperty(t,"Booster",{enumerable:!0,get:function(){return a.Booster}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const i=s(5),a=s(3),o=s(0),n=s(15),r=s(0),h=s(2),l=s(1);let d,c,u,m;t.Player=class{constructor(e){this.scale=.6,this.bodySize=14,this.fullBodySize=28,this.bulletSpeed=10,this.maxHp=0,this.hp=0,this.movementSpeed=0,this.attackSpeed=0,this.damage=0,this.explosionResistance=0,this.bonusesTime=0,this.fortune=0,this.lastFireTime=0,this.lastAttackTime=0,this.angle=0,this.immortalityTime=0,this.autoRotate=0,this.pointers={left:null,right:null},this.prevPointersPos={left:{x:0,y:0},right:{x:0,y:0}},this.pointerValues={isLeftTouched:!1,isRightTouched:!1,left:{x:0,y:0},right:{x:0,y:0}},this.currentBooster=null,this.boosterParams={endTime:0,nextShadowTime:0,nextRegenerationTime:0},this.shieldBodySize=80,this.scene=e;const t=this.scene.getGameSize();this.body=this.scene.physics.add.image(t.width/2,t.height/2,"player-ship"),this.lastAttackTime=e.gameTime+100,this.init(),this.initProperties()}init(){const{scene:e,scale:t}=this;this.body.setScale(t),this.body.setDepth(l.depths.player),this.body.setImmovable(!0),this.initShield(),d=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),c=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),u=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),m=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.updateGeomCircle()}initProperties(){const e=this.scene.getData();this.maxHp=i.playerConfig.maxHealth+i.storeConfig.products.maxHealth.valuePerLevel*e.store.maxHealth,this.hp=this.maxHp,this.movementSpeed=i.playerConfig.movementSpeed+i.storeConfig.products.movementSpeed.valuePerLevel*e.store.movementSpeed,this.attackSpeed=i.playerConfig.attackSpeed-i.storeConfig.products.attackSpeed.valuePerLevel*e.store.attackSpeed,this.damage=i.playerConfig.damage+i.storeConfig.products.damage.valuePerLevel*e.store.damage,this.explosionResistance=i.playerConfig.explosionResistance+i.storeConfig.products.explosionResistance.valuePerLevel*e.store.explosionResistance,this.bonusesTime=i.playerConfig.bonusesTime+i.storeConfig.products.bonusesTime.valuePerLevel*e.store.bonusesTime,this.fortune=i.playerConfig.fortune+i.storeConfig.products.fortune.valuePerLevel*e.store.fortune,h.debugLog("player",this)}initShield(){this.shieldBody=this.scene.physics.add.image(300,300,"shield"),this.shieldBody.setImmovable(!0)}act(e,t){this.update(e,t)}update(e,t){this.updateBoosters(e,t),this.body.active&&(this.updateBody(e,t),this.updateShooting(e,t),this.updateMovement(e,t),this.updateAngle(e,t),this.updateGeomCircle())}updateGeomCircle(){const e=h.getOffsetByAngle(this.angle,i.playerConfig.bodyOffset/2);this.geomCircle=new Phaser.Geom.Circle(this.body.x+e.x,this.body.y+e.y,this.fullBodySize*this.scale)}updateBody(e,t){const{scale:s,bodySize:a}=this,o=h.getOffsetByAngle(this.angle,i.playerConfig.bodyOffset),n=h.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,s,a,o);this.body.setCircle(a,n.x,n.y)}updateShooting(e,t){const{scene:s,lastAttackTime:i}=this,{gameTime:a}=s;if(s.getSettings().isMobile)a>i&&this.shoot(this.angle);else{s.input.activePointer.isDown&&this.shoot(this.angle)}}updateMovement(e,t){const{scene:s,body:o,pointerValues:n,prevPointersPos:r}=this,{deltaTime:h}=s,l=this.scene.getGameSize(),{movePointerParams:p}=i.playerConfig;let g=this.movementSpeed*h;if(s.getSettings().isMobile){if(this.pointers.left&&this.pointers.left.isDown){const e=this.pointers.left,t=new a.Vector(e.x,e.y);n.isLeftTouched||(this.prevPointersPos.left={x:t.x,y:t.y},this.pointerValues.left={x:0,y:0},n.isLeftTouched=!0);const s=r.left;this.pointerValues.left.x=Math.max(Math.min(this.pointerValues.left.x+(e.x-s.x)/p.speed,p.range),-p.range),this.pointerValues.left.y=Math.max(Math.min(this.pointerValues.left.y+(e.y-s.y)/p.speed,p.range),-p.range),this.prevPointersPos.left={x:t.x,y:t.y},o.x+=this.pointerValues.left.x,o.y+=this.pointerValues.left.y}}else{const e=s.input.keyboard.createCursorKeys(),t=e.down.isDown||c.isDown,i=e.up.isDown||m.isDown,a=e.left.isDown||d.isDown,n=e.right.isDown||u.isDown;(i||t)&&(n||a)&&(g*=.8),i?o.y-=g:t&&(o.y+=g),n?o.x+=g:a&&(o.x-=g)}const y=this.body.displayWidth/2;o.x<y&&(o.x=y),o.y<i.mainConfig.scene.minYPos&&(o.y=i.mainConfig.scene.minYPos),o.x>l.width-y&&(o.x=l.width-y),o.y>l.height-y&&(o.y=l.height-y)}updateAngle(e,t){const{scene:s,body:o,pointerValues:n,prevPointersPos:r}=this,{anglePointerParams:l}=i.playerConfig,d=s.input.activePointer,c=new a.Vector(o.x,o.y);if(s.getSettings().isMobile){if(this.angle+=this.autoRotate,this.pointers.right&&this.pointers.right.isDown){const e=this.pointers.right,t=new a.Vector(e.x,e.y),s=h.getOffsetByAngle(this.angle,1);n.isRightTouched||(this.prevPointersPos.right={x:t.x,y:t.y},this.pointerValues.right={x:s.x,y:s.y},n.isRightTouched=!0);const i=r.right;this.pointerValues.right.x=Math.max(Math.min(this.pointerValues.right.x+(e.x-i.x)/l.speed,l.range),-l.range),this.pointerValues.right.y=Math.max(Math.min(this.pointerValues.right.y+(e.y-i.y)/l.speed,l.range),-l.range),this.prevPointersPos.right={x:t.x,y:t.y};const o=new a.Vector(this.pointerValues.right.x,this.pointerValues.right.y);this.angle=h.getAngleBetweenPointsInDegrees(o,new a.Vector(0,0))}}else this.angle=h.angleToDegrees(h.getAngleBetweenPointsInRadians(new a.Vector(d.x,d.y),c));this.body.angle=this.angle+90}updateBoosters(e,t){const{scene:s,boosterParams:a}=this,{gameTime:o}=s;this.currentBooster===r.EBoosterType.speed&&o>a.nextShadowTime&&(this.createShadow(),this.boosterParams.nextShadowTime=o+i.playerConfig.shadowIntervalTime),this.currentBooster===r.EBoosterType.regenerator&&o>a.nextRegenerationTime&&(a.nextRegenerationTime=o+1e3,this.updateHp(i.boostersConfig.types.regenerator.hpPerSecond),this.hp>=this.maxHp&&this.destroyBooster()),this.updateShieldBooster(),o>a.endTime&&this.destroyBooster()}updateShieldBooster(){const{shieldBodySize:e}=this;this.shieldBody.x=this.body.x,this.shieldBody.y=this.body.y,this.shieldBody.angle=this.body.angle;const t=h.getOffsetByRadians(h.angleToRadians(this.angle)+Math.PI,25),s=h.getBodyPosWithOffset(this.shieldBody.displayWidth,this.shieldBody.displayHeight,1,e,t);this.shieldBody.setCircle(e,s.x,s.y),this.shieldBody.visible=this.currentBooster===r.EBoosterType.shield}shoot(e){const{scene:t,body:s,bulletSpeed:i,damage:n}=this,{gameTime:r}=t;if(r>this.lastAttackTime){this.scene.game.soundManager.play(o.ESoundName.playerLaser);const t=this.scene.getSettings().isMobile&&!this.scene.boss;this.scene.utils.createSphereBullet({pos:new a.Vector(s.x,s.y),owner:o.EOwner.player,speed:i,angle:e,sprite:"laser-green",explodeSprite:"explode-green",damage:n,target:t?this.getNearestEnemy(this.getEnemiesForAutoSight()):void 0}),this.lastAttackTime=r+this.attackSpeed}}hit(e,t={}){const{type:s}=t,{scene:i,immortalityTime:a}=this;if(i.gameTime<a||this.hp<=0)return;let o=e;"explode"===s&&(o=Math.round(e-e*(this.explosionResistance/100))),h.debugLog("damage",o),this.updateHp(-o),this.hp<=0&&!i.getQueryParam("immortality",!0)&&this.scene.onPlayerZeroHp()}createShadow(){const{scene:e,body:t,scale:s}=this;e.effects.push(new n.Shadow(e,{pos:new a.Vector(t.x,t.y),sprite:"player-ship",lifeTime:250,scale:s,angle:this.angle+90,alpha:.4}))}setPointer(e,t){this.pointers[e]=t}setBooster(e){const{gameTime:t}=this.scene;switch(this.destroyBooster(),this.currentBooster=e,this.boosterParams.endTime=t+1e3*this.bonusesTime,e){case r.EBoosterType.speed:this.movementSpeed+=i.boostersConfig.types.speed.additionalSpeed;break;case r.EBoosterType.damage:this.damage*=i.boostersConfig.types.damage.additionalXDamage;break;case r.EBoosterType.regenerator:this.boosterParams.nextRegenerationTime=t+1e3}}setAutoRotate(e){this.autoRotate=e*(this.scene.game.settings.queryParams["rotation-speed"]||4)}updateHp(e){this.hp=Math.max(Math.min(this.maxHp,this.hp+e),0)}hitShield(e){if(this.currentBooster===r.EBoosterType.shield){const t=new a.Vector(e.body.x,e.body.y),s=new a.Vector(this.body.x,this.body.y),i=h.getDistanceBetweenPoints(t,s),o=h.getAngleDiff(this.angle,e.getAngle());i<70&&o>45&&e.explode()}}destroyBooster(){const{currentBooster:e}=this;switch(e){case r.EBoosterType.speed:this.movementSpeed-=i.boostersConfig.types.speed.additionalSpeed;break;case r.EBoosterType.damage:this.damage/=i.boostersConfig.types.damage.additionalXDamage}this.currentBooster=null}revive(){const{scene:e}=this;this.hp=this.maxHp*(i.playerConfig.revive.healthPercentage/100),this.immortalityTime=e.gameTime+i.playerConfig.revive.immortalityTime}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),this.scene.game.soundManager.play(o.ESoundName.explode),this.destroyBooster(),t.destroy(),e.onFail()}updateFire(){const{scene:e,body:t,angle:s,lastFireTime:i}=this,o=e.gameTime,r=h.angleToRadians(s+180);o>i&&(e.effects.push(new n.Fire(e,{pos:new a.Vector(t.x+45*Math.cos(r+.4),t.y+45*Math.sin(r+.4)),angle:r})),e.effects.push(new n.Fire(e,{pos:new a.Vector(t.x+45*Math.cos(r-.4),t.y+45*Math.sin(r-.4)),angle:r})),this.lastFireTime=o+75)}getEnemiesForAutoSight(e=20){const{body:t}=this,s=this.angle,i=[];return this.scene.enemies.forEach(o=>{const n=h.getAngleBetweenPointsInDegrees(new a.Vector(o.body.x,o.body.y),new a.Vector(t.x,t.y));Math.abs(s-n)<e&&i.push(o)}),i}getNearestEnemy(e){const{body:t}=this,s=[];if(e.forEach(e=>{const i=h.getDistanceBetweenPoints(new a.Vector(t.x,t.y),new a.Vector(e.body.x,e.body.y));s.push(i)}),0!==s.length)return e[h.getIndexOfMinNumber(s)]}getMovementAngle(){const e=this.scene.input.keyboard.createCursorKeys();let t=0,s=0;return(e.down.isDown||c.isDown)&&(s=1),(e.up.isDown||m.isDown)&&(s=-1),(e.left.isDown||d.isDown)&&(t=-1),(e.right.isDown||u.isDown)&&(t=1),h.getAngleBetweenPointsInDegrees(new a.Vector(t,s),new a.Vector(0,0))}onLeftPointerUp(){this.pointers.left=null,this.pointerValues.isLeftTouched=!1}onRightPointerUp(){this.pointers.right=null,this.pointerValues.isRightTouched=!1}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const i=s(1),a=s(3),o=s(172),n=s(2),r=s(15),h=s(24),l=s(9);t.Utils=class{constructor(e){this.createEnemy=(e,t={})=>{var s;const{scene:i}=this,a=new e(i,{pos:null!==(s=t.pos)&&void 0!==s?s:this.getRandomPointOutside()});i.stats.enemiesCount[a.name]+=1,i.enemies.push(a)},this.scene=e}getRandomPos(e=0,t=0){const s=this.scene.getGameSize(),i=s.width*(e/100),o=s.height*(t/100),n=i+Math.random()*(s.width-2*i),r=o+Math.random()*(s.height-2*o);return new a.Vector(n,r)}getAngleToPlayer(e){const{scene:t}=this,{player:s}=t,i=new a.Vector(s.body.x,s.body.y);return n.getAngleBetweenPointsInDegrees(i,new a.Vector(e.x,e.y))}getAngleToFuturePlayerPos(e,t=150){const s=this.scene.player,i=s.getMovementAngle(),o=n.getOffsetByAngle(i,t);return n.getAngleBetweenPointsInDegrees(new a.Vector(s.body.x+o.x,s.body.y+o.y),e)}getRandomPointOutside(e={}){const{scene:t}=this,s=t.getGameSize(),i=e.distance||50,o={x:s.width,y:s.height},n=Math.random()>.5?"y":"x",r=[-i,o[n]+i][Math.floor(2*Math.random())],h={x:"x"===n?r:Math.random()*s.width,y:"y"===n?r:Math.random()*s.height};return new a.Vector(h.x,h.y)}getSafeAreaPoint(){const e=this.scene.getGameSize(),t=e.width*(i.enemySafeAreaPercentage.x/100),s=e.height*(i.enemySafeAreaPercentage.y/100),o=e.width/2-t+Math.random()*(2*t),n=e.height/2-s+Math.random()*(2*s);return new a.Vector(o,n)}isInArea(e,t=0,s=0){const{x:i,y:a}=e,o=this.scene.getGameSize(),n=o.width*(t/100),r=o.height*(s/100);return i<o.width/2+n&&i>o.width/2-n&&a<o.height/2+r&&a>o.height/2-r}isOutOfScene(e,t=200){const{x:s,y:i}=e,a=this.scene.getGameSize();return s<-t||s>a.width+t||i<-t||i>a.height+t}getEnemiesMap(){return{bot:l.Bot,hunter:l.Hunter,ufo:l.UFO,defender:l.Defender,flyer:l.Flyer,stealth:l.Stealth,"laser-ship":l.LaserShip,"missile-carrier":l.MissileCarrier,destroyer:l.Destroyer}}getEnemyFromConfig(e){const t=100*Math.random(),s=this.scene.stats.enemiesCount;return e.find(e=>t>e.chance&&(!e.max||e.max>s[e.type]))}createTripleExplode(e,t){const s=360*Math.random()/3;for(let i=0;i<3;i++){const o=n.angleToRadians(120*i+s),r={pos:new a.Vector(e+30*Math.cos(o),t+30*Math.sin(o)),sprite:"explode-orange",scaleCoef:1,withDamage:!0};this.createExplodeEffect(r)}}createBonus(e,t,s){const{scene:i}=this;i.bonuses.push(new o.Coin(i,{pos:new a.Vector(e,t),cost:s}))}createSphereBullet(e){const{scene:t}=this;t.bullets.push(new h.SphereBullet(t,e))}createRocketBullet(e){const{scene:t}=this;t.bullets.push(new h.RocketBullet(t,e))}createRayBullet(e){const{scene:t}=this;t.bullets.push(new h.RayBullet(t,e))}createExplodeEffect(e){const{scene:t}=this;t.effects.push(new r.Explode(t,e))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;const i=s(2),a=s(5),o=s(27),n={0:{sprite:"coin-bronze",xFactor:1},1:{sprite:"coin-silver",xFactor:1.5},2:{sprite:"coin-gold",xFactor:2}},r=i.getSeconds(2);class h extends o.Bonus{constructor(e,t){super(e),this.lifeTime=5e3;const s=n[(()=>{const e=Math.random();return e>.5?0:e>.2?1:2})()],i=t.pos.y<a.mainConfig.scene.minYPos?a.mainConfig.scene.minYPos:t.pos.y;this.cost=Math.floor(t.cost*s.xFactor),this.body=this.scene.physics.add.image(t.pos.x,i,s.sprite),this.circle=new Phaser.Geom.Circle(t.pos.x,i,16),this.creationTime=e.gameTime,this.lifeTime+=Math.random()*r,this.init()}init(){this.body.setDepth(10)}act(){this.update()}update(){const{scene:e,body:t}=this,s=e.gameTime;t.angle+=3*Math.sin(.003*s),s>this.creationTime+this.lifeTime&&this.destroy(),Phaser.Geom.Intersects.CircleToCircle(this.circle,e.player.geomCircle)&&(e.money+=this.cost,this.destroy())}}t.Coin=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bullet=void 0;const i=s(9),a=s(0);t.Bullet=class{constructor(e,t){this.scene=e,this.name=t.name,this.pos=t.pos,this.owner=t.owner,this.damage=t.damage,this.minLifeTime=t.minLifeTime||0}act(e,t){}update(e,t){const{body:s}=this;this.minLifeTime>0&&(this.minLifeTime-=1);const i=this.scene.getGameSize();this.minLifeTime<=0&&(s.x+s.width<0||s.x-s.width>i.width||s.y+s.height<0||s.y-s.height>i.height)&&this.destroy()}initCollisions(){const{scene:e,owner:t,damage:s}=this,{boss:o}=e;t===a.EOwner.player?(e.enemies.forEach(t=>{t instanceof i.Defender&&e.physics.add.overlap(this.body,t.shieldBody,()=>{t.hitShield(this)}),e.physics.add.collider(this.body,t.body,()=>{this.explode(),t.damage(s)})}),e.bullets.forEach(t=>{"rocket"===t.name&&t.owner===a.EOwner.enemy&&e.physics.add.collider(this.body,t.body,()=>{t.hit(s),this.explode()})}),e.instances.forEach(t=>{e.physics.add.collider(this.body,t.body,()=>{t.hit(),this.explode()})}),o&&e.physics.add.collider(this.body,o.body,()=>{this.explode(),o.damage(s)})):(e.physics.add.collider(this.body,e.player.body,()=>{this.explode(),e.player.hit(s)}),e.physics.add.overlap(this.body,e.player.shieldBody,()=>{e.player.hitShield(this)}))}getAngle(){return this.angle}explode(){}destroy(){const{body:e}=this;this.scene.bullets=this.scene.bullets.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sphere=void 0;const i=s(3),a=s(2),o=s(24),n=s(1),r={scale:1,bodySize:6,states:[]};class h extends o.Bullet{constructor(e,t){super(e,{name:"sphere",pos:t.pos,owner:t.owner,damage:t.damage,minLifeTime:t.minLifeTime}),this.currentStateIndex=0,this.depth=n.depths.bullets,this.body=e.physics.add.image(t.pos.x,t.pos.y,t.sprite),t.tint&&this.body.setTint(t.tint),this.params=Object.assign(Object.assign({},r),a.excludeUndefinedValues(t)),this.currentState=this.params.states[0],this.speed=t.speed,this.scale=this.params.scale,this.angle=t.angle,this.init()}init(){const{body:e,params:t,depth:s}=this,{angle:i,scale:a}=t;e.setAngle(i+90),e.setDepth(s),e.setOrigin(.5,.5),e.setScale(a),this.updateBodyCenter(),this.initCollisions()}updateBodyCenter(){const{params:e,scale:t}=this,{bodySize:s}=e,o=a.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,t,s,new i.Vector(0,0));this.body.setCircle(s,o.x,o.y)}updateAngle(){const{body:e}=this,{target:t}=this.params;t&&t.body.active&&(this.angle=a.getAngleBetweenPointsInDegrees(new i.Vector(t.body.x,t.body.y),new i.Vector(e.x,e.y)),e.setAngle(this.angle+90))}act(e,t){this.body.setScale(this.scale),this.updateBodyCenter(),this.updateState(e,t),this.updateAngle(),this.updateMovement(e,t),super.update(e,t)}updateState(e,t){const{scene:s,body:i,currentState:a}=this;if(a)switch(a.name){case"wait":a.time-=s.deltaTime,a.time<=0&&this.setNextState();break;case"changeState":a.time-=s.deltaTime,a.cb(this),a.time<=0&&this.setNextState();break;case"changeSize":a.time-=s.deltaTime,this.scale=a.scaleFn(this.scale),a.time<=0&&this.setNextState();break;case"changeAngle":{const e=a.angleFn();i.setAngle(a.angleFn()),this.angle=e,this.setNextState();break}case"changeSpeed":a.time-=s.deltaTime,this.speed=Math.max(a.speedFn(this.speed),0),a.time<=0&&this.setNextState();break;case"explode":a.explode(this),this.destroy()}}setNextState(){this.currentStateIndex+=1,this.currentState=this.params.states[this.currentStateIndex]}updateMovement(e,t){const{scene:s,body:i,speed:o,angle:n}=this,{deltaTime:r}=s,h=a.angleToRadians(n);i.x+=o*Math.cos(h)*r,i.y+=o*Math.sin(h)*r}draw(){}explode(){const{body:e,params:t}=this;this.scene.utils.createExplodeEffect({pos:new i.Vector(e.x,e.y),sprite:t.explodeSprite,scaleCoef:t.explodeScale||1}),this.destroy()}}t.Sphere=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rocket=void 0;const i=s(3),a=s(0),o=s(2),n=s(24),r=s(15);class h extends n.Bullet{constructor(e,t){super(e,{name:"rocket",pos:t.pos,owner:t.owner,damage:t.damage}),this.hp=40,this.depth=10,this.speed=2,this.maxSpeed=5,this.scale=1,this.bodySize=10,this.rotateSpeed=1.3,this.lifeTime=0,this.nextShadowTime=0,this.body=e.physics.add.image(t.pos.x,t.pos.y,t.sprite),this.params=t,this.angle=t.angle,this.lifeTime=e.gameTime+5e3,this.init()}init(){const{body:e,params:t,depth:s,scale:i}=this,{angle:a}=t;e.setAngle(a+90),e.setDepth(s),e.setOrigin(.5,.5),e.setScale(i),e.setImmovable(!0),this.updateBodyCenter(),this.initCollisions(),this.initBulletsCollisions()}initBulletsCollisions(){const{scene:e}=this;e.bullets.forEach(t=>{t.owner===a.EOwner.player&&e.physics.add.collider(this.body,t.body,()=>{this.hit(t.damage),t.explode()})})}updateBodyCenter(){const{scale:e,bodySize:t}=this,s=o.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t,new i.Vector(0,0));this.body.setCircle(t,s.x,s.y)}act(e,t){this.body.setScale(this.scale),this.updateBodyCenter(),this.updateMovement(e,t),this.updateSpeed(),this.updateAngle(),this.updateShadow(),this.updateLifeTime(),super.update(e,t)}updateMovement(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=o.angleToRadians(a);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateSpeed(){this.speed<this.maxSpeed&&(this.speed+=.03*this.scene.deltaTime)}updateAngle(){const{scene:e,angle:t,body:s}=this,a=e.player.body,n=new i.Vector(a.x,a.y),r=o.getAngleBetweenPointsInDegrees(n,s);this.angle=o.getNearestAngle(t,r,this.rotateSpeed*e.deltaTime),this.body.angle=t+90}updateShadow(){const{scene:e}=this,{gameTime:t}=e;t>this.nextShadowTime&&(this.createShadow(),this.nextShadowTime=t+70)}updateLifeTime(){const{scene:e}=this;e.gameTime>this.lifeTime&&this.explode(!1)}createShadow(){const{scene:e,body:t}=this,s=o.getOffsetByAngle(this.angle-180,10);e.effects.push(new r.Shadow(e,{pos:new i.Vector(t.x+s.x,t.y+s.y),sprite:"rocket-shadow",lifeTime:250,scale:.75,angle:this.angle+90,alpha:.4}))}draw(){}explode(e=!0){const{scene:t,body:s,params:a}=this;e&&t.utils.createExplodeEffect({pos:new i.Vector(s.x,s.y),sprite:a.explodeSprite,scaleCoef:1}),t.utils.createTripleExplode(s.x,s.y);const n=90*Math.random();for(let e=0;e<3;e++){const i=o.getOffsetByAngle(n+120*e,75);t.utils.createTripleExplode(s.x+i.x,s.y+i.y)}t.shakeScreen(),this.destroy()}hit(e){this.hp-=e,this.hp<=0&&this.explode(!1)}}t.Rocket=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ray=void 0;const i=s(3),a=s(2),o=s(24);class n extends o.Bullet{constructor(e,t){super(e,{name:"ray",pos:t.pos,owner:t.owner,damage:t.damage}),this.depth=10,this.delay=0,this.lifeTime=50,this.reload=0,this.body=e.add.image(t.pos.x,t.pos.y,t.sprite),this.params=t,this.angle=t.angle,this.delay=t.delay,this.init()}init(){const{body:e,params:t,depth:s}=this;e.setAngle(t.angle),e.setDepth(s),e.setOrigin(0,.5),e.setScale(this.scene.getGameSize().width/this.body.width,1),this.initLine()}initLine(){const{body:e}=this,t=a.getOffsetByAngle(this.angle,this.scene.getGameSize().width);this.line=new Phaser.Geom.Line(e.x,e.y,e.x+t.x,e.y+t.y)}act(e,t){this.updateCollisions(),this.delay>0?(this.body.setAlpha(.15),this.delay-=this.scene.deltaTime):(this.body.setAlpha(1),this.lifeTime-=this.scene.deltaTime,this.lifeTime<=0&&this.destroy()),this.params.isLaserActive()||this.destroy(),super.update(e,t)}updateCollisions(){const{scene:e,body:t}=this,s=e.player,{gameTime:o}=e;if(Phaser.Geom.Intersects.LineToCircle(this.line,s.geomCircle)&&s.body.active){const e=new i.Vector(t.x,t.y),n=new i.Vector(s.body.x,s.body.y),r=a.getDistanceBetweenPoints(e,n);o>this.reload&&this.delay<=0&&(s.hit(this.params.damage),this.reload=o+500,this.explode()),this.body.setScale(r/this.body.width,1)}else this.body.setScale(this.scene.getGameSize().width/this.body.width,1)}destroy(){super.destroy(),this.params.onDestroy()}explode(){const{scene:e,body:t,params:s}=this,o=e.player,n=new i.Vector(t.x,t.y),r=new i.Vector(o.body.x,o.body.y),h=a.getDistanceBetweenPoints(n,r),l=a.getOffsetByAngle(this.angle,h);e.utils.createExplodeEffect({pos:new i.Vector(t.x+l.x,t.y+l.y),sprite:s.explodeSprite,scaleCoef:1})}}t.Ray=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialGameStats=void 0;t.getInitialGameStats=()=>({totalKills:0,kills:{bot:0,destroyer:0,hunter:0,flyer:0,ufo:0,stealth:0,"missile-carrier":0,"laser-ship":0,defender:0},enemiesCount:{bot:0,destroyer:0,hunter:0,flyer:0,ufo:0,stealth:0,"missile-carrier":0,"laser-ship":0,defender:0}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backgroundOffset=void 0,t.backgroundOffset={1:{x:0,y:0},2:{x:0,y:-200}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreloadScene=void 0;const i=s(0),a=s(6);class o extends a.Scene{constructor(){super({key:i.ESceneName.preload})}create(){this.startGame()}startGame(){this.game.i18n.loadLang(this.game.settings.lang).then(()=>{this.game.i18n.setCurrentLang(this.game.settings.lang),this.ui.drawOriginalText({x:0,y:-100,text:this.game.i18n.getText("gameStart"),fontSize:1,origin:[.5,.5]}),setTimeout(()=>{this.scene.start(i.ESceneName.menu)},50)})}}t.PreloadScene=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfoScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.info})}init(e){this.params=Object.assign({buttonYSpacing:0},e)}create(){const{params:e}=this,t=this.getGameSize(),s=this.getGameCenter(),a=t.width/2;this.text=this.ui.drawOriginalText({x:a,y:s.y,text:this.params.text,fontSize:this.params.textSize,align:"center",origin:[.5,0],maxWidth:t.width/1.5,color:i.colors.white}),this.drawBackButton(this.text.y+this.text.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText+e.buttonYSpacing),this.updateContentPositions()}drawBackButton(e){const t=this.getGameSize();this.backButton=this.ui.drawButton({x:t.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.params.backButtonText||this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.menu)}}})}updateContentPositions(){const{params:e}=this,t=(this.text.displayHeight+i.defaultButtonParams.height+i.defaultButtonParams.spaceYText+e.buttonYSpacing)/2;this.text.y-=t,this.backButton.updatePosition(this.backButton.getPosition().x,this.backButton.getPosition().y-t)}}t.InfoScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.history})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=this.getSettings().isMobile;this.historyText=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.i18n.getText("history"),fontSize:i.fontSizes.text,align:"center",origin:[.5,0],maxWidth:s?.8*e.width:.6*e.width,color:i.colors.white}),this.drawNextButton(this.historyText.y+this.historyText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText+15),this.updateContentPositions()}drawNextButton(e){const{params:t}=this,s=this.getGameSize();this.nextButton=this.ui.drawButton({x:s.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:t.isMenuScene?this.game.i18n.getText("back"):this.game.i18n.getText("next2"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.controls)}}})}updateContentPositions(){const e=(this.nextButton.getPosition().y+i.defaultButtonParams.height/2-this.historyText.y)/2;this.historyText.y-=e,this.nextButton.updatePosition(this.nextButton.getPosition().x,this.nextButton.getPosition().y-e)}}t.HistoryScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.ad}),this.pendingRequest=!1}init(e){this.params=e}create(){const e=this.getGameSize();this.text=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("adLoading"),fontSize:i.fontSizes.textMedium,align:"center",origin:[.5,.5],maxWidth:e.width,color:i.colors.white}),this.draw(),this.showAd()}showAd(){const{wasHistoryShown:e}=this.getData();this.pendingRequest||(this.pendingRequest=!0,this.game.adManager.showFullscreenVideo({onClose:()=>{e?this.scene.start(a.ESceneName.preview):(this.scene.start(a.ESceneName.history,{isMenuScene:!1}),this.setData("wasHistoryShown",!0)),this.pendingRequest=!1},onError:()=>{}}))}draw(){const e=this.getGameCenter();this.text.x=e.x,this.text.y=e.y}onGameResize(){this.draw()}}t.AdScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.loading}),this.isResourcesLoaded=!1}init(e){this.params=e}preload(){const e=this.getGameSize(),t=this.getGameCenter();this.text=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.i18n.getText("loadingGameResources"),fontSize:18,align:"center",origin:[.5,.5],maxWidth:.6*e.width,color:i.colors.white}),this.progressText=this.ui.drawOriginalText({x:t.x,y:this.text.y+this.text.displayHeight+i.defaultUISpacings.textY,text:"0%",fontSize:18,align:"center",origin:[.5,.5],maxWidth:.6*e.width,color:i.colors.white}),this.updateContentPositions(),this.load.on("progress",e=>{this.onLoadingProgress(e)}),this.isResourcesLoaded&&this.onLoadingComplete(),this.load.on("complete",()=>{this.onLoadingComplete()}),this.load.image("background-1","assets/images/background/bg-1.jpg"),this.load.image("background-2","assets/images/background/bg-2.jpg"),this.load.image("player-ship","assets/images/ships/player-ship.png"),this.load.image("enemy-bot-ship","assets/images/ships/enemy-ship-2.png"),this.load.image("enemy-hunter-ship","assets/images/ships/enemy-hunter.png"),this.load.image("enemy-ufo","assets/images/ships/enemy-ufo.png"),this.load.image("enemy-flyer","assets/images/ships/enemy-flyer.png"),this.load.image("enemy-destroyer-ship","assets/images/ships/enemy-destroyer.png"),this.load.image("enemy-stealth-ship","assets/images/ships/enemy-stealth.png"),this.load.image("enemy-missile-carrier-ship","assets/images/ships/enemy-missile-carrier.png"),this.load.image("enemy-laser-ship","assets/images/ships/enemy-laser-ship.png"),this.load.image("enemy-defender-ship","assets/images/ships/enemy-defender-ship.png"),this.load.image("boss-1-ship","assets/images/ships/boss-1-ship.png"),this.load.image("boss-2-ship","assets/images/ships/mothership.png"),this.load.image("boss-3-ship","assets/images/ships/boss-3-ship.png"),this.load.image("laser-green","assets/images/bullets/laser-green-3.png"),this.load.image("laser-red","assets/images/bullets/laser-red-2.png"),this.load.image("laser-aqua","assets/images/bullets/laser-aqua.png"),this.load.image("laser-gray","assets/images/bullets/laser-gray.png"),this.load.image("sphere-bullet","assets/images/bullets/sphere-bullet.png"),this.load.image("sphere-bullet-yellow","assets/images/bullets/sphere-bullet-yellow.png"),this.load.image("sphere-bullet-gray","assets/images/bullets/sphere-bullet-gray.png"),this.load.image("sphere-bullet-blue","assets/images/bullets/sphere-bullet-blue.png"),this.load.image("sphere-bullet-purple","assets/images/bullets/sphere-bullet-purple.png"),this.load.image("sphere-bullet-aqua","assets/images/bullets/sphere-bullet-aqua.png"),this.load.image("rocket-bullet","assets/images/bullets/rocket.png"),this.load.image("rocket-bullet-blue","assets/images/bullets/rocket-blue.png"),this.load.image("rocket-bullet-purple","assets/images/bullets/rocket-purple.png"),this.load.image("ray-bullet-red","assets/images/bullets/ray-red.png"),this.load.image("triangle-bullet-red","assets/images/bullets/triangle-red.png"),this.load.image("triangle-bullet-aqua","assets/images/bullets/triangle-aqua.png"),this.load.image("triangle-bullet-purple","assets/images/bullets/triangle-purple.png"),this.load.image("explode-green","assets/images/effects/explode-green.png"),this.load.image("explode-red","assets/images/effects/explode-red.png"),this.load.image("explode-orange","assets/images/effects/explode-orange.png"),this.load.image("explode-gray","assets/images/effects/explode-gray.png"),this.load.image("explode-yellow","assets/images/effects/explode-yellow.png"),this.load.image("explode-aqua","assets/images/effects/explode-aqua.png"),this.load.image("explode-blue","assets/images/effects/explode-blue.png"),this.load.image("explode-purple","assets/images/effects/explode-purple.png"),this.load.image("star","assets/images/effects/star-4.png"),this.load.image("fire","assets/images/effects/fire.png"),this.load.image("comet","assets/images/effects/comet.png"),this.load.image("meteor-1","assets/images/effects/meteor-gray-1.png"),this.load.image("meteor-2","assets/images/effects/meteor-gray-2.png"),this.load.image("meteor-3","assets/images/effects/meteor-gray-3.png"),this.load.image("meteor-4","assets/images/effects/meteor-gray-4.png"),this.load.image("shield","assets/images/effects/shield.png"),this.load.image("rocket-shadow","assets/images/effects/rocket-shadow.png"),this.load.image("coin-bronze","assets/images/bonus/star-bronze.png"),this.load.image("coin-silver","assets/images/bonus/star-silver.png"),this.load.image("bonus-speed","assets/images/bonus/bonus-speed.png"),this.load.image("bonus-shield","assets/images/bonus/bonus-shield.png"),this.load.image("bonus-damage","assets/images/bonus/bonus-damage.png"),this.load.image("bonus-regenerator","assets/images/bonus/bonus-regenerator.png"),this.load.image("touch-area","assets/images/controls/touch-area.png"),this.load.spritesheet("pause-button","assets/images/controls/pause-button.png",{frameWidth:78,frameHeight:78}),this.load.image("firefly","assets/images/other/firefly.png")}onLoadingProgress(e){this.progressText.text=(100*e).toFixed(0)+"%"}onLoadingComplete(){this.isResourcesLoaded?this.scene.start(a.ESceneName.game,{isSurvival:this.params.isSurvival}):(this.isResourcesLoaded=!0,setTimeout(()=>{this.scene.start(a.ESceneName.game,{isSurvival:this.params.isSurvival})},100))}updateContentPositions(){const e=(this.text.displayHeight+this.progressText.displayHeight+i.defaultUISpacings.textY)/2;this.text.y-=e,this.progressText.y-=e}}t.LoadingScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContactsScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.contacts})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=e.width/2,a=t.y-50;this.text=this.ui.drawOriginalText({x:s,y:t.y,text:this.game.i18n.getTemplateText("contactDeveloper.template",{args:{email:i.DEVELOPER_EMAIL}}),fontSize:i.fontSizes.text,align:"center",origin:[.5,.5],maxWidth:e.width,color:i.colors.white}),this.text.y=a,this.drawBackButton(a+i.defaultButtonParams.spaceY)}drawBackButton(e){const t=this.getGameSize();this.ui.drawButton({x:t.width/2,y:e,width:i.defaultButtonParams.width120,height:i.defaultButtonParams.height,text:this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.menu)}}})}}t.ContactsScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaderboardsScene=void 0;const i=s(3),a=s(1),o=s(2),n=s(0),r=s(21),h=s(6),l=[{textI18nKey:"score",key:n.ELeaderboardName.main},{textI18nKey:n.ELeaderboardName.survival,key:n.ELeaderboardName.survival},{textI18nKey:n.ELeaderboardName.level,key:n.ELeaderboardName.level}],d=350,c=35,u=140,m=140,p=80,g=80,y=(a.defaultUIPositions.bottom,15);class v extends h.Scene{constructor(){super({key:n.ESceneName.leaderboards}),this.currentTextIndex=0,this.texts=[],this.isAnyLeaderboardFetching=!1,this.leaderboardsData={}}init(e){this.params=e,this.isAnyLeaderboardFetching=!1,this.leaderboardsData={},this.selectedTabIndex=void 0,this.texts=[],this.updateSceneUniqueId()}create(){const e=this.getGameCenter();this.initTexts(),this.graphics=this.add.graphics({lineStyle:{width:2,color:a.colors.white}}),this.chooseLeaderboardText=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("chooseLeaderboard"),fontSize:a.fontSizes.text,align:"center",origin:[.5,0],color:a.colors.white}),this.loadingText=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("loadingLeaderboards"),fontSize:a.fontSizes.text,align:"center",origin:[.5,0],color:a.colors.white}),this.loadingErrorText=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("loadingLeaderboardsError"),fontSize:a.fontSizes.text,align:"center",origin:[.5,0],color:a.colors.white}),this.drawBackButton(),this.tabs=new r.UITabs(this,{activeTabIndex:-1,pos:new i.Vector(e.x,p),tabs:l,onClick:e=>{this.onTabChange(e.key)}}),this.initContentPositions(),this.updateSceneState(),this.draw()}get selectedLeaderboard(){if(this.selectedTabIndex)return this.leaderboardsData[this.selectedTabIndex]}onTabChange(e){if(this.selectedTabIndex=e,!this.selectedLeaderboard){this.isAnyLeaderboardFetching=!0,this.tabs.setDisabled(!0);const t=this.sceneUniqueId;this.game.leaderboards.getLeaderboardEntries(e).then(s=>{this.isTheSameScene(t,n.ESceneName.leaderboards)&&(this.leaderboardsData[e]={entries:s},this.isAnyLeaderboardFetching=!1,this.updateSceneState(),this.draw())}).catch(s=>{console.error(s),this.isTheSameScene(t,n.ESceneName.leaderboards)&&(this.leaderboardsData[e]={isLoadingFailed:!0}),this.isAnyLeaderboardFetching=!1,this.updateSceneState(),this.draw()}).finally(()=>{this.tabs.setDisabled(!1)})}this.updateSceneState(),this.draw()}drawBackButton(){this.backButton=this.ui.drawButton({x:0,y:0,responsive:{paddingX:a.defaultButtonParams.paddingX},height:a.defaultButtonParams.height,text:this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.scene.start(n.ESceneName.menu)}}})}drawLeaderboard(e,t,s,i,r,h){var l;const{graphics:c}=this;for(let u=0;u<r;u++){const r=i[u],m=new Phaser.Geom.Rectangle(t,s+h*u,d,h);if(c.strokeRectShape(m),!r)continue;let p=a.colors.white;(null===(l=this.game.leaderboards.getPlayerEntry(n.ELeaderboardName.main))||void 0===l?void 0:l.player.uniqueID)===r.player.uniqueID&&(p=a.colors.green),e&&(0===u&&(p=a.colors.gold),1===u&&(p=a.colors.silver),2===u&&(p=a.colors.bronze));const g=this.getNextText();g.visible=!0,g.x=y+t,g.y=s+h/2+h*u,g.text=r.rank+".  "+(o.getEllipsisText(r.player.publicName,20)||this.game.i18n.getText("anonymousShip")),g.setTint(p),g.setOrigin(0,.5);const v=this.getNextText();v.visible=!0,v.x=t+d-y,v.y=s+h/2+h*u,v.text=r.score.toString(),v.setTint(p),v.setOrigin(1,.5)}}getNextText(){return this.currentTextIndex++,this.texts[this.currentTextIndex%this.texts.length]}initTexts(){for(let e=0;e<40;e++)this.texts.push(this.ui.drawOriginalText({x:100,y:100,text:"123",fontSize:a.fontSizes.textSmall,align:"center",origin:[0,.5],color:a.colors.white}))}initContentPositions(){const e=this.getGameSize(),t=this.getGameCenter();this.chooseLeaderboardText.x=t.x,this.chooseLeaderboardText.y=t.y,this.loadingText.x=t.x,this.loadingText.y=t.y,this.loadingErrorText.x=t.x,this.loadingErrorText.y=t.y,this.backButton.updatePosition(t.x,e.height-g)}updateSceneState(){var e;this.loadingText.visible=!1,this.loadingErrorText.visible=!1,this.chooseLeaderboardText.visible=!1,this.isAnyLeaderboardFetching&&(this.loadingText.visible=!0),!this.isAnyLeaderboardFetching&&(null===(e=this.selectedLeaderboard)||void 0===e?void 0:e.isLoadingFailed)&&(this.loadingErrorText.visible=!0),this.isAnyLeaderboardFetching||this.selectedLeaderboard||(this.chooseLeaderboardText.visible=!0)}draw(){var e,t,s,i;const a=this.getGameSize(),o=this.getGameCenter();if(this.graphics.clear(),this.texts.forEach(e=>{e.visible=!1}),!this.isAnyLeaderboardFetching&&(null===(e=this.selectedLeaderboard)||void 0===e?void 0:e.entries)){const e=null===(s=null===(t=this.selectedLeaderboard)||void 0===t?void 0:t.entries)||void 0===s?void 0:s.entries,r=u,h=a.height-r-m;let l=h/10,p=10;l<c&&(p=Math.floor(h/c),l=h/p);const g=p+p;let y=e;const v=null===(i=this.game.leaderboards.getPlayerEntry(n.ELeaderboardName.main))||void 0===i?void 0:i.player.uniqueID,S=e.findIndex(e=>e.player.uniqueID===v);if(-1!==S){const t=g-Math.min(e.length-S,4);S>t&&(y=[...e.slice(0,t-3),...e.slice(S-3)])}this.drawLeaderboard(!0,o.x-d,r,y.slice(0,p),p,l),this.drawLeaderboard(!1,o.x,r,y.slice(p,p+p),p,l)}}onGameResize(){this.initContentPositions(),this.draw()}}t.LeaderboardsScene=v},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FinalScene=void 0;const i=s(1),a=s(2),o=s(0),n=s(6);class r extends n.Scene{constructor(){super({key:o.ESceneName.final})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter();this.text=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.i18n.getText("finalVictory"),fontSize:i.fontSizes.text,align:"center",origin:[.5,1],maxWidth:e.width/1.5,color:i.colors.white}),this.drawBackButton(0,0),this.drawWaitButton(0,0),this.draw()}drawBackButton(e,t){this.backButton=this.ui.drawButton({x:e,y:t,width:i.defaultButtonParams.width120,height:i.defaultButtonParams.height,text:this.game.i18n.getText("goToMenu"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}})}drawWaitButton(e,t){const s=this.getData();this.waitButton=this.ui.drawButton({x:e,y:t,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("wait"),isDisabled:s.isWaitButtonPressed,callbacks:{onPointerDown:()=>{this.text.text=this.game.i18n.getText("thanksForWaiting"),this.setData("isWaitButtonPressed",!0),this.game.localStorage.setGameData({isWaitButtonPressed:!0}),this.waitButton.setDisabled(!0),a.sendMetrikaGoal(o.EGoalTargetName.waitNextLevels,{isPressed:!0}),this.draw()}}})}draw(){const e=this.getGameCenter();this.text.y=e.y+(this.text.displayHeight-i.defaultButtonParams.height-i.defaultButtonParams.spaceYText)/2;const t=this.text.y+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText,s=this.waitButton.getSize().width,a=(i.defaultButtonParams.width120/2+s/2+i.defaultButtonParams.spaceX)/2;this.backButton.updatePosition(e.x-a,t),this.waitButton.updatePosition(e.x+a,t)}onGameResize(){this.draw()}}t.FinalScene=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreScene=void 0;const i=s(3),a=s(1),o=s(0),n=s(5),r=s(21),h=s(40),l=s(188),d=s(6);class c extends d.Scene{constructor(){super({key:o.ESceneName.store}),this.productsControls=[],this.currentProducts=[],this.productsState={},this.currentProductSection=h.EStoreSection.characteristics,this.currentPage=0,this.maxPages=1}init(e){this.params=e}create(){const e=this.getGameCenter();this.deviceType=this.game.settings.deviceType,this.currentProductSection=h.EStoreSection.characteristics,this.currentPage=0,this.graphics=this.add.graphics({lineStyle:{width:2,color:a.colors.white}}),this.playerMoney=this.ui.drawCosmons({x:25,y:40,value:this.getData().money,isCentered:!1,depth:100}),this.titleStoreText=this.ui.drawOriginalText({x:e.x,y:l.uiPositions.titleTop,text:this.game.i18n.getText("store"),fontSize:a.fontSizes.title,align:"center",origin:[.5,.5],color:a.colors.white}),this.soonText=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("soon"),fontSize:22,align:"center",origin:[.5,.5],color:a.colors.white}).setVisible(!1),this.paginationText=this.ui.drawOriginalText({x:0,y:0,text:"",fontSize:16,align:"center",origin:[.5,.5],color:a.colors.white}),this.tabs=new r.UITabs(this,{pos:new i.Vector(e.x,l.uiPositions.tabsTop[this.deviceType]+a.defaultButtonParams.height/2),tabs:l.storeTabs,activeTabIndex:0,onClick:e=>{this.onTabChange(e.key)}}),this.initControls(),this.initProducts(),this.updateCurrentProducts(),this.draw()}updateMobilePositions(){const e=this.getGameSize(),t=this.getGameCenter(),{fullscreenYOffset:s}=this.getResizeParams();if(this.game.settings.isMobile){this.titleStoreText.setVisible(!1),this.menuButton.updatePosition(l.uiSpacings.mobile.buttonBorderX,e.height-a.defaultButtonParams.height/2-l.uiSpacings.mobile.buttonBorderY-s);const i=e.height-s-a.defaultButtonParams.height/2-l.uiSpacings.mobile.buttonBorderY;this.prevStoreSectionButton.updatePosition(e.width-l.uiSpacings.mobile.buttonBorderX,i),this.nextStoreSectionButton.updatePosition(e.width-l.uiSpacings.mobile.buttonBorderX,i-a.defaultButtonParams.height-l.uiSpacings.mobile.nextButtonBottom);const o=this.nextStoreSectionButton.getPosition().y,n=this.prevStoreSectionButton.getPosition().y;this.paginationText.y=o+(n-o)/2,this.paginationText.x=e.width-l.uiSpacings.mobile.buttonBorderX,this.playerMoney.setCentered(!0),this.playerMoney.updatePosition(t.x,e.height-l.uiSpacings.mobile.playerCosmonsBottom-s),this.soonText.y=l.uiPositions.storeTop[this.deviceType]+(e.height-l.uiSpacings.mobile.playerCosmonsBottom-l.uiPositions.storeTop[this.deviceType]-l.uiSpacings.mobile.productBottom-7)/2}}initControls(){this.menuButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width120,height:a.defaultButtonParams.height,text:this.game.i18n.getText("goToMenu"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}}),this.prevStoreSectionButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width120,height:a.defaultButtonParams.height,text:this.game.i18n.getText("back"),noDefaultCursorAfterClick:!0,callbacks:{onPointerDown:()=>{this.onPaginationChange(-1)}}}),this.nextStoreSectionButton=this.ui.drawButton({x:0,y:0,width:a.defaultButtonParams.width120,height:a.defaultButtonParams.height,text:this.game.i18n.getText("next2"),noDefaultCursorAfterClick:!0,callbacks:{onPointerDown:()=>{this.onPaginationChange(1)}}})}initProducts(){const e=this.getMaxProductsCount();for(let t=0;t<e;t++){const e=this.ui.drawOriginalText({x:0,y:0,text:"",fontSize:14,align:"center",maxWidth:50,origin:[.5,.5],color:a.colors.white}),s=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("maximum"),align:"center",fontSize:14,maxWidth:l.storeParams.productWidth,origin:[.5,0],color:a.colors.white}).setVisible(!1),i=this.ui.drawOriginalText({x:0,y:0,text:"",align:"center",fontSize:14,maxWidth:l.storeParams.productWidth-10,origin:[.5,0],color:a.colors.white}).setVisible(!1),o=this.ui.drawCosmons({x:0,y:0,value:0,isCentered:!0,depth:100}),n=this.ui.drawIndicator({x:0,y:0,value:0,max:0}),r=this.ui.drawButton({x:0,y:0,width:l.storeParams.descriptionButtonWidth,height:l.storeParams.descriptionButtonWidth,text:"?",callbacks:{onPointerDown:()=>{this.onDescriptionButtonClick(t)}}}),h=this.ui.drawButton({x:0,y:0,depth:1,width:l.storeParams.buyButtonWidth,height:l.storeParams.buyButtonHeight,text:this.game.i18n.getText("buy"),noDefaultCursorAfterClick:!0,callbacks:{onPointerDown:()=>{this.onBuyProduct(t)}}}),d=this.ui.drawButton({x:0,y:0,width:l.storeParams.buyButtonWidth,height:l.storeParams.buyButtonHeight,text:this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.onBackDescriptionButtonClick(t)}}});d.hide(),this.productsControls[t]={nameText:e,maximumText:s,descriptionText:i,buyButton:h,cosmonsPrice:o,stateIndicator:n,descriptionButton:r,backDescriptionButton:d}}}updateCurrentProducts(){const e=this.getMaxProductsCount(),t=l.allStoreProducts[this.currentProductSection].slice(this.currentPage*e,this.currentPage*e+e);this.currentProducts=t,this.productsState={}}drawProducts(){const{graphics:e,currentProducts:t}=this;e.clear();const s=l.allStoreProducts[this.currentProductSection],i=this.getMaxProductsCount();for(let e=0;e<i;e++){t[e]?this.drawProduct(e):this.hideProduct(e)}t.length<=0?this.soonText.setVisible(!0):this.soonText.setVisible(!1),this.maxPages=Math.ceil(s.length/i)||1,this.paginationText.text=`${this.currentPage+1} / ${this.maxPages}`,this.updatePaginationButtons()}drawProduct(e,t=!0){var s;const{graphics:o}=this,r=this.getGameCenter(),h=this.getData(),d=this.currentProducts.length*l.storeParams.productWidth,c=r.x-d/2,u=l.uiPositions.storeTop[this.deviceType],m=c+e*l.storeParams.productWidth,p=u,g=this.getAvailableHeight(),y=this.productsControls[e],v=this.currentProducts[e],S=n.storeConfig.products[v.key],b=m+l.storeParams.productWidth/2,f=p+g-l.uiSpacings.product.buyButtonBottom,x=h.store[v.key],T=S.maxLevel,w=S.price[x];if(y.nameText.x=b,y.nameText.y=p+l.uiSpacings.product.nameTextTop,y.nameText.text=this.game.i18n.getText(v.i18nName),y.maximumText.x=b,y.maximumText.y=p+l.uiSpacings.product.maximumTextTop,y.descriptionText.x=b,y.descriptionText.y=p+l.uiSpacings.product.descriptionTextTop,y.descriptionText.text=this.game.i18n.getText(v.i18nDescription||"")||this.game.i18n.getText("noDescription"),w&&(y.cosmonsPrice.updatePosition(b,p+l.uiSpacings.product.cosmonsPriceTop),y.cosmonsPrice.updateValue(w)),y.stateIndicator.updatePosition(new i.Vector(b,f-l.uiSpacings.product.indicatorBottom)),y.stateIndicator.setMaxValue(S.maxLevel),y.stateIndicator.setValue(x),y.descriptionButton.updatePosition(m+l.storeParams.descriptionButtonWidth/2+l.uiSpacings.product.paddingX,f),y.buyButton.updatePosition(m+l.storeParams.buyButtonWidth+a.defaultButtonParams.height/2,f),y.backDescriptionButton.updatePosition(b,f),h.money<w||x>=T-1?y.buyButton.setDisabled(!0):y.buyButton.setDisabled(!1),y.maximumText.setVisible(!1),t){const e=new Phaser.Geom.Rectangle(m,p,l.storeParams.productWidth,g),t=new Phaser.Geom.Line(m,p+l.uiSpacings.product.nameLineTop,m+l.storeParams.productWidth,p+l.uiSpacings.product.nameLineTop);o.strokeRectShape(e),o.strokeLineShape(t)}(null===(s=this.productsState[e])||void 0===s?void 0:s.isDescriptionVisible)?(this.hideProduct(e),y.nameText.visible=!0,y.descriptionText.visible=!0,y.backDescriptionButton.show()):(this.showProduct(e),w||(y.cosmonsPrice.hide(),y.maximumText.setVisible(!0)))}updatePaginationButtons(){const e=0===this.currentPage,t=this.currentPage>=this.maxPages-1;this.prevStoreSectionButton.setDisabled(e),this.nextStoreSectionButton.setDisabled(t)}hideProduct(e){const t=this.productsControls[e];t.nameText.visible=!1,t.descriptionText.visible=!1,t.maximumText.visible=!1,t.buyButton.hide(),t.descriptionButton.hide(),t.stateIndicator.hide(),t.cosmonsPrice.hide(),t.backDescriptionButton.hide()}showProduct(e){const t=this.productsControls[e];t.nameText.visible=!0,t.descriptionText.visible=!1,t.buyButton.show(),t.descriptionButton.show(),t.stateIndicator.show(),t.cosmonsPrice.show(),t.backDescriptionButton.hide()}getMaxProductsCount(){const e=this.getGameSize();let t=Math.floor((e.width-2*l.uiSpacings.storeWidth[this.deviceType])/l.storeParams.productWidth);return"mobile"===this.deviceType&&t>l.MAX_MOBILE_PRODUCTS_COUNT&&(t=l.MAX_MOBILE_PRODUCTS_COUNT),t}getAvailableHeight(){const e=this.getGameSize(),t=l.uiPositions.storeTop[this.deviceType],{fullscreenYOffset:s}=this.getResizeParams();let i=0;return i="mobile"===this.deviceType?e.height-(t+l.uiSpacings.mobile.playerCosmonsBottom+l.uiSpacings.mobile.productBottom+s):e.height-(t+l.uiSpacings.bottom+a.defaultButtonParams.height/2+a.defaultButtonParams.spaceY),i<l.storeParams.productMinHeight&&(i=l.storeParams.productMinHeight),i}getProductPrice(e){const t=this.getData(),s=this.currentProducts[e],i=n.storeConfig.products[s.key],a=t.store[s.key];return i.price[a]}onTabChange(e){this.currentProductSection=e,this.currentPage=0,this.updateCurrentProducts(),this.drawProducts()}onPaginationChange(e){const t=this.currentPage;this.currentPage=Math.min(Math.max(this.currentPage+e,0),this.maxPages-1),t!==this.currentPage&&(this.updateCurrentProducts(),this.drawProducts())}onDescriptionButtonClick(e){this.productsState[e]={isDescriptionVisible:!0},this.drawProduct(e,!1)}onBackDescriptionButtonClick(e){this.productsState[e]={isDescriptionVisible:!1},this.drawProduct(e,!1)}onBuyProduct(e){const t=this.getData(),s=this.currentProducts[e],i=this.getProductPrice(e),a=t.money-i,o=t.store[s.key]+1;this.setData("money",a),this.setData("store",Object.assign(Object.assign({},t.store),{[s.key]:o})),this.game.localStorage.setGameData({money:a,store:Object.assign(Object.assign({},t.store),{[s.key]:o})}),this.playerMoney.updateValue(a),this.drawProducts()}draw(){const e=this.getGameCenter(),t=this.getMaxProductsCount()*l.storeParams.productWidth,s=e.x-t/2,i=l.uiPositions.storeTop[this.deviceType]+this.getAvailableHeight()+a.defaultButtonParams.spaceY;this.soonText.x=e.x,this.soonText.y=l.uiPositions.storeTop[this.deviceType]+(i-l.uiPositions.storeTop[this.deviceType]-a.defaultButtonParams.height)/2,this.menuButton.updatePosition(s+a.defaultButtonParams.width120/2,i),this.prevStoreSectionButton.updatePosition(s+t-a.defaultButtonParams.width120/2-a.defaultButtonParams.width120-a.defaultButtonParams.spaceX-45,i),this.nextStoreSectionButton.updatePosition(s+t-a.defaultButtonParams.width120/2,i),this.paginationText.y=i,this.paginationText.x=s+t-a.defaultButtonParams.width120-35,this.drawProducts(),this.updateMobilePositions()}onGameResize(){this.draw()}}t.StoreScene=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_MOBILE_PRODUCTS_COUNT=t.allStoreProducts=t.storeTabs=t.storeParams=t.uiPositions=t.uiSpacings=void 0;const i=s(1),a=s(32),o=s(40);function n(e){return{key:e,i18nName:e,i18nDescription:e+"Description"}}t.uiSpacings={bottom:i.defaultUIPositions.bottom,product:{paddingX:25,nameTextTop:30,descriptionTextTop:80,maximumTextTop:86,nameLineTop:60,cosmonsPriceTop:95,indicatorBottom:65,descriptionButton:55,buyButtonBottom:45},storeWidth:{desktop:100,mobile:150},mobile:{productBottom:45,playerCosmonsBottom:45,buttonBorderX:100,buttonBorderY:37,nextButtonBottom:55,padinationTextBottom:25}},t.uiPositions={titleTop:i.defaultUIPositions.top,tabsTop:{desktop:130,mobile:37},storeTop:{desktop:130+i.defaultButtonParams.spaceY,mobile:45+i.defaultButtonParams.spaceY}},t.storeParams={productMinHeight:250,productWidth:220,descriptionButtonWidth:40,buyButtonHeight:40,buyButtonWidth:115},t.storeTabs=[{textI18nKey:o.EStoreSection.characteristics,key:o.EStoreSection.characteristics},{textI18nKey:o.EStoreSection.ships,key:o.EStoreSection.ships},{textI18nKey:o.EStoreSection.weapons,key:o.EStoreSection.weapons},{textI18nKey:o.EStoreSection.boosters,key:o.EStoreSection.boosters}],t.allStoreProducts={characteristics:[n(a.EPlayerStoreProduct.maxHealth),n(a.EPlayerStoreProduct.damage),n(a.EPlayerStoreProduct.movementSpeed),n(a.EPlayerStoreProduct.attackSpeed),n(a.EPlayerStoreProduct.explosionResistance),n(a.EPlayerStoreProduct.bonusesTime),n(a.EPlayerStoreProduct.fortune)],ships:[],weapons:[],boosters:[]},t.MAX_MOBILE_PRODUCTS_COUNT=2},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlsScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.controls})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=this.getSettings().isMobile;this.descriptionText=this.ui.drawOriginalText({x:t.x,y:t.y,text:s?this.game.i18n.getText("controlsDescriptionMobile"):this.game.i18n.getText("controlsDescription"),fontSize:i.fontSizes.text,align:"center",origin:[.5,0],lineSpacing:10,maxWidth:s?.8*e.width:.6*e.width,color:i.colors.white}),this.drawNextButton(this.descriptionText.y+this.descriptionText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText+15),this.updateContentPositions()}drawNextButton(e){const t=this.getGameSize();this.nextButton=this.ui.drawButton({x:t.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("next2"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.preview)}}})}updateContentPositions(){const e=(this.nextButton.getPosition().y+i.defaultButtonParams.height/2-this.descriptionText.y)/2;this.descriptionText.y-=e,this.nextButton.updatePosition(this.nextButton.getPosition().x,this.nextButton.getPosition().y-e)}}t.ControlsScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalPreviewScene=void 0;const i=s(1),a=s(0),o=s(6);class n extends o.Scene{constructor(){super({key:a.ESceneName.suvivalPreview})}create(){const e=this.getGameSize(),t=this.getGameCenter();let s=t.y;this.titleText=this.ui.drawOriginalText({x:t.x,y:s,text:this.game.i18n.getText("attention")+"!",fontSize:i.fontSizes.title,align:"center",origin:[.5,0],maxWidth:e.width/1.5,color:i.colors.white}),s+=this.titleText.displayHeight+i.defaultUISpacings.textY,this.text=this.ui.drawOriginalText({x:t.x,y:s,text:this.game.i18n.getText("survivalDescription"),fontSize:i.fontSizes.text,align:"center",origin:[.5,0],maxWidth:e.width/1.5,color:i.colors.white}),s+=this.text.displayHeight+i.defaultUISpacings.textY,this.playerLevelText=this.ui.drawOriginalText({x:t.x,y:s,text:`${this.game.i18n.getText("playerLevel")}: ${this.getData().player.level+1}`,fontSize:i.fontSizes.text,align:"center",origin:[.5,0],maxWidth:e.width/1.5,color:i.colors.white}),s+=this.playerLevelText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText,this.drawGoButton(s),this.updateContentPositions()}drawGoButton(e){const t=this.getGameCenter();this.goButton=this.ui.drawButton({x:t.x,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("go"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.loading,{isSurvival:!0})}}})}updateContentPositions(){const e=(this.goButton.getPosition().y-this.titleText.y)/2;this.titleText.y-=e,this.text.y-=e,this.playerLevelText.y-=e,this.goButton.updatePosition(this.goButton.getPosition().x,this.goButton.getPosition().y-e)}}t.SurvivalPreviewScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalResultsScene=void 0;const i=s(1),a=s(0),o=s(2),n=s(6);class r extends n.Scene{constructor(){super({key:a.ESceneName.survivalResults})}init(e){this.params=e}create(){const{params:e}=this,{getText:t}=this.game.i18n,s=this.getData().player.level+1,i=Math.floor(e.time/1e3),a=e.score+i,n=Math.round(a*((10+s)/10)-a),r=a+n,h=[`${t("stars")}: ${e.money}`,`${t("killed")}: ${e.totalKills}`,`${t("score")}: ${e.score} (+${e.score})`,`${t("time")}: ${o.getTimeStringFromSeconds(i)} (+${i})`,`${t("playerLevel")}: ${this.getData().player.level+1} (+${n})`,`${t("totalScore")}: ${r}`].join("\n");this.drawTitle(),this.drawStats(h),this.drawCosmons(),this.drawMenuButton(),this.drawTryAgainButton(),this.updateGlobalData(r),this.draw()}drawTitle(){const{getText:e}=this.game.i18n;this.titleText=this.ui.drawOriginalText({x:0,y:0,text:e("survivalTitle"),origin:[.5,0],fontSize:28,color:i.colors.green})}drawStats(e){this.statsText=this.ui.drawOriginalText({x:0,y:0,text:e,fontSize:18,origin:[.5,0],align:"center"})}drawCosmons(){const{params:e}=this;this.cosmons=this.ui.drawCosmons({x:0,y:0,isCentered:!0,value:e.money,prefix:"+",depth:100})}drawMenuButton(){const{getText:e}=this.game.i18n;this.menuButton=this.ui.drawButton({x:0,y:0,text:e("goToMenu"),responsive:{paddingX:i.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.menu)}}})}drawTryAgainButton(){const{getText:e}=this.game.i18n;this.tryAgainButton=this.ui.drawButton({x:0,y:0,text:e("tryAgain"),responsive:{paddingX:i.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.loading,{isSurvival:!0})}}})}updateGlobalData(e){const{params:t}=this,s=this.getData(),{leaderboards:i}=this.game;o.sendMetrikaGoal(a.EGoalTargetName.survivalComplete,{}),i.addLeaderboardScore(t.score),i.setLeaderboardSurvivalScore(e),this.setData("money",s.money+t.money),this.game.localStorage.setGameData({money:s.money})}initContentPositions(){var e;const t=this.getGameCenter(),s=[20,35,70];this.titleText.x=t.x,this.titleText.y=t.y,this.statsText.x=t.x,this.statsText.y=this.titleText.y+this.titleText.displayHeight+s[0],this.cosmons.updatePosition(t.x,this.statsText.y+this.statsText.displayHeight+s[1]);const a=this.cosmons.getPosition().y+s[2];this.tryAgainButton.updatePosition(t.x+this.tryAgainButton.getSize().width/2+i.defaultButtonParams.spaceX/2,a),null===(e=this.menuButton)||void 0===e||e.updatePosition(t.x-this.menuButton.getSize().width/2-i.defaultButtonParams.spaceX/2,a)}draw(){this.initContentPositions();const e=(this.tryAgainButton.getPosition().y+i.defaultButtonParams.height/2-this.titleText.y)/2;this.titleText.y-=e,this.statsText.y-=e,this.cosmons.updatePosition(this.cosmons.getPosition().x,this.cosmons.getPosition().y-e);const t=this.tryAgainButton.getParams().pos.y-e;this.tryAgainButton.updateYPosition(t),this.menuButton.updateYPosition(t)}onGameResize(){this.draw()}}t.SurvivalResultsScene=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const i=s(42);class a extends Phaser.Game{constructor(e,t){super(e),this.data=t.data,this.settings=t.settings,this.adManager=new i.AdManager,this.translations=new i.Translations(this),this.i18n=t.i18n,this.localStorage=i.LocalStorage,this.leaderboards=new i.Leaderboards(this),this.soundManager=new i.SoundManager(this),this.resizeManager=new i.ResizeManager(this)}}t.Game=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=t.Emitter=void 0;class i{constructor(){this.listeners=[]}subscribe(e,t){this.listeners.push({type:e,cb:t})}unsubscribe(e,t){this.listeners=this.listeners.filter(s=>s.cb!==t&&s.type!==e)}dispatch(e){this.listeners.forEach(t=>{t.type===e.type&&(console.log("=== dispatch action ===",e),t.cb(e.payload))})}}t.Emitter=i;const a=new i;t.EventEmitter=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);t.default=new class{constructor(){this.setItem=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){console.error(e)}},this.getItem=e=>{try{return window.localStorage.getItem(e)}catch(e){console.error(e)}return null}}getGameData(){const e=i.decryptValue(this.getItem("data"));if(e)try{return JSON.parse(e)}catch(e){console.error(e)}return null}setGameData(e){const t=this.getGameData()||{},s=Object.assign(Object.assign({},t),e),a=i.encryptValue(JSON.stringify(s));a?(this.setItem("data",a),i.debugLog("save",e)):console.error("Failed to save data!")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);t.default=class{constructor(e){this.dictionary={},this.currentLang=e,this.getText=this.getText.bind(this),this.getPluralText=this.getPluralText.bind(this),this.getTemplateText=this.getTemplateText.bind(this)}setCurrentLang(e){this.currentLang=e}loadLang(e){return new Promise((t,s)=>{if(this.dictionary[e])return t(void 0);i.debugLog("i18n",`load dictionary "${e}"`),fetch(`assets/i18n/${e}.json`).then(e=>e.json()).then(s=>{this.dictionary[e]=s,t(void 0)}).catch(e=>{console.error(e),s(e)})})}getKeyValue(e){return this.dictionary[this.currentLang]||this.throwNoLangError(this.currentLang),this.dictionary[this.currentLang][e]}getText(e){if(""===e)return"";const t=this.getKeyValue(e);return t||this.throwNoKeyError(e),t}getPluralText(e,t){const s=this.getKeyValue(e);return s||this.throwNoKeyError(e),i.pluralize(t.plularNumber,s,{isGenetiveForm:t.isGenetiveForm})}getTemplateText(e,t){const s=this.getKeyValue(e);return s||this.throwNoKeyError(e),i.textTemplate(s,t.args)}throwNoKeyError(e){throw new Error(`Key "${e}" does not exist in "${this.currentLang}" language`)}throwNoLangError(e){throw new Error(`Current language "${e}" was not loaded`)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Translations=void 0;const i=s(5),a=s(0);t.Translations=class{constructor(e){this.getMissionText=e=>{const{getText:t,getPluralText:s,getTemplateText:o}=this.game.i18n;switch(e.type){case a.EGameMode.totalKills:{const i=e.target;return`${t("mission")}: ${t("destroy")} ${i} ${s("invaders.plural",{plularNumber:i,isGenetiveForm:!0})}`}case a.EGameMode.enemyKills:{const a=e.target,o=Object.keys(a).map(e=>{const t=a[e],o=i.enemiesConfig.ships[e].pluralName;return`${t} ${s(o,{plularNumber:t})}`}).join(" / ");return`${t("mission")}: ${t("destroy")} ${o}`}case a.EGameMode.time:{const i=e.target;return`${t("mission")}: ${t("stayAliveFor")} ${i} ${s("seconds.plural",{plularNumber:i})}`}case a.EGameMode.waves:{const i=e.target.length,a=s("wave.plural",{plularNumber:i,isGenetiveForm:!0});return`${t("mission")}: ${o("defeatWavesCount.template",{args:{count:i,wave:a}})}`}case a.EGameMode.boss:return t("winBoss");case a.EGameMode.survival:return""}},this.game=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdManager=void 0;t.AdManager=class{showFullscreenVideo(e){window.ysdk.adv.showFullscreenAdv({callbacks:{onError:e.onError,onClose:e.onClose}})}showRewardedVideo(e){window.ysdk.adv.showRewardedVideo({callbacks:{onRewarded:e.onRewarded,onClose:e.onClose}})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Leaderboards=void 0;const i=s(0),a=s(2);t.Leaderboards=class{constructor(e){this.game=e,a.debugLog("leaderboard","init"),this.getLeaderboards()}getLeaderboards(){window.ysdk.getLeaderboards().then(e=>{this.lb=e,this.getLeaderboardPlayerEntry()})}getLeaderboardPlayerEntry(){a.debugLog("leaderboard","get entry from 3 leaderboards"),this.lb&&(this.lb.getLeaderboardPlayerEntry(i.ELeaderboardName.main).then(e=>{this.playerMaxScoreEntry=e,this.playerMaxScoreValue=e.score}).catch(e=>{console.error(e)}),this.lb.getLeaderboardPlayerEntry(i.ELeaderboardName.survival).then(e=>{this.playerMaxSurvivalScoreEntry=e,this.playerMaxSurvivalScoreValue=e.score}).catch(e=>{console.error(e)}),this.lb.getLeaderboardPlayerEntry(i.ELeaderboardName.level).then(e=>{this.playerMaxLevelEntry=e,this.playerMaxLevelValue=e.score}).catch(e=>{console.error(e)}))}setNewLeaderboardValue(e,t){return this.lb?this.lb.setLeaderboardScore(e,t).catch(e=>{console.error(e)}):Promise.reject()}addLeaderboardScore(e){return a.debugLog("leaderboard",`try to set new score: ${e} for leaderboard "${i.ELeaderboardName.main}"`),this.lb&&void 0!==this.playerMaxScoreValue?this.setNewLeaderboardValue(i.ELeaderboardName.main,this.playerMaxScoreValue+e):Promise.reject()}setLeaderboardSurvivalScore(e){return a.debugLog("leaderboard",`try to set new score: ${e} for leaderboard "${i.ELeaderboardName.survival}"`),this.lb&&void 0!==this.playerMaxSurvivalScoreValue?this.playerMaxSurvivalScoreValue>=e?(a.debugLog("leaderboard",`new value "${e}" is less or equals to the current maximum value "${this.playerMaxSurvivalScoreValue}"`),Promise.reject()):(this.playerMaxSurvivalScoreValue=e,this.setNewLeaderboardValue(i.ELeaderboardName.survival,e)):Promise.reject()}setLeaderboardMaxLevel(e){return a.debugLog("leaderboard",`try to set new score: ${e} for leaderboard "${i.ELeaderboardName.level}"`),this.lb&&void 0!==this.playerMaxLevelValue?this.playerMaxLevelValue>=e?(a.debugLog("leaderboard",`new value "${e}" is less or equals to the current maximum value "${this.playerMaxLevelValue}"`),Promise.reject()):(this.playerMaxLevelValue=e,this.setNewLeaderboardValue(i.ELeaderboardName.level,e)):Promise.reject()}getLeaderboardEntries(e){return a.debugLog("leaderboard","get entries"),this.lb?this.lb.getLeaderboardEntries(e,{includeUser:this.game.settings.isAuthorized,quantityAround:3,quantityTop:20}).then(e=>e):Promise.reject()}getPlayerEntry(e){switch(e){case i.ELeaderboardName.main:return this.playerMaxScoreEntry;case i.ELeaderboardName.level:return this.playerMaxLevelEntry;case i.ELeaderboardName.survival:return this.playerMaxSurvivalScoreEntry}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SoundManager=void 0;t.SoundManager=class{constructor(e){this.game=e}initSounds(){const{game:e}=this;this.sounds={playerLaser:e.sound.add("laser-2"),enemyLaser:e.sound.add("laser-3"),explode:e.sound.add("explode"),ufoShot:e.sound.add("ufo-shot")}}play(e){this.sounds&&this.sounds[e].play()}stopAllSounds(){this.game.sound.stopAll()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeManager=void 0;const i=s(41),a=s(1),o=s(2),n=s(0),r=[n.ESceneName.game,n.ESceneName.win,n.ESceneName.leaderboards,n.ESceneName.ad,n.ESceneName.store,n.ESceneName.fail,n.ESceneName.final,n.ESceneName.menu,n.ESceneName.survivalResults];t.ResizeManager=class{constructor(e){this.params={gameWidth:0,gameHeight:0,fullscreenYOffset:0,fullscreenXOffset:0},this.game=e;const t=i.getDeviceOptions(),s=o.isInFullscreen();this.params={gameWidth:t.width,gameHeight:t.height,fullscreenYOffset:s?a.fullscreenParams.yOffset:0,fullscreenXOffset:s?a.fullscreenParams.xOffset:0},this.init()}init(){this.updateGameSize=o.debounce(this.updateGameSize.bind(this),a.ORIENTATION_UPDATE_TIMEOUT_DELAY),window.addEventListener("resize",()=>{this.updateGameSize()})}updateGameSize(){if(o.debugLog("Game","try update game size"),!o.isLandscapeOrientation())return;const e=i.getDeviceOptions(),t=this.game.scene.getScenes(!0)[0];if(this.params.gameWidth=e.width,this.params.gameHeight=e.height,t){const s=t.scene.key;o.debugLog("Game",t),setTimeout(()=>{this.game.scale.setGameSize(e.width,e.height),o.isInFullscreen()?(o.debugLog("Game","isInFullscreen"),this.params.fullscreenYOffset=a.fullscreenParams.yOffset,this.params.fullscreenXOffset=a.fullscreenParams.xOffset):(o.debugLog("Game","no fullscreen"),this.params.fullscreenYOffset=0,this.params.fullscreenXOffset=0),r.includes(s)?(o.debugLog("Game","onGameResize"),t.onGameResize()):(o.debugLog("Game","restart after resize"),t.scene.restart())},0)}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initMockYSDK=void 0;const i={score:101,extraData:"",rank:57257,player:{uniqueID:"j8t/7RM9xCd4bEZh0F2/zdyJiQIrbaV16GJqXgk5MkM=",lang:"ru",publicName:"Денис Чертенко",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},subscriptions:{}},formattedScore:"101"},a={setLeaderboardScore:(e,t)=>new Promise((e,t)=>{Math.random()>.25?e():t()}),getLeaderboardEntries:e=>new Promise((t,s)=>{setTimeout(()=>{Math.random()>.15?t((e=>({leaderboard:{appID:96458,name:"main2",default:!0,description:{invert_sort_order:!1,score_format:{type:"numeric",options:{decimal_offset:0}}},title:{en:"Top players",ru:"Лучшие игроки"}},ranges:[{start:0,size:10},{start:57237,size:7}],userRank:57241,entries:[{score:1293,extraData:"",rank:1,player:{uniqueID:"krpzPkoXiWUIX+eU0yL6ricpmkDOkU1zm4OKtq3jNXk=",lang:"ru",publicName:"Владислав П. "+e,avatarIdHash:"GOMFS72WHZXMBO5OC4X56IVFB3VNFFUXY75LFOXVXQDSTDYAIPKUKURJG2AXFRZ3EPH6X526YVZ3UWHMJVSVUYS4AW5TM2FKNLW4XKWEFIFNB66NHOBOM3H5WF5KNV4RDNMMX7LCEZ5CIOW7U7BPFIZE5C5Q5TRCRC4W3RV4",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"1293"},{score:179,extraData:"",rank:2,player:{uniqueID:"szzuEZQ290qvVA+duWzDbGTNe63wxmOj5lfjOJq05cI=",lang:"ru",publicName:"Денис Чертенко",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},subscriptions:{},hasPremium:!1},formattedScore:"179"},{score:10,extraData:"",rank:3,player:{uniqueID:"07Vn9D0Tu7XAlUWZh0c5oZD3aQI7Jt1DMt1zlGx32dg=",lang:"ru",publicName:"Михаил Л.",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"10"},{score:6,extraData:"",rank:4,player:{uniqueID:"ghQ8Sk15RVNyurwGY2qk68PJkgfCFjfXlhP9Ixe8Bxs=",lang:"en",publicName:"Alberto Galvan",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"6"},{score:5,extraData:"",rank:5,player:{uniqueID:"XSZLvdDMPIMFCqhvz0leZtdZWO7wddJr9OkK2uUeVxE=",lang:"ru",publicName:"Лидия Ф.",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"5"},{score:4,extraData:"",rank:6,player:{uniqueID:"wIkjM+2EVur9gCWVuvzwwa0bhWmUVyuOnZfbqsbUJng=",lang:"ru",publicName:"Владислав Невструев",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"4"},{score:3,extraData:"",rank:7,player:{uniqueID:"/9trePIQ9ZTCjEwvPZgX80OpKv7gDTIy9+EvmPJ9nDw=",lang:"ru",publicName:"Сергей Ковач",avatarIdHash:"2XEV7EQT724MULPATE52OCV5ZE5NZMGQWB2INRE56EU6FVBXDTEO5U22G5LZLXSIKLDQK6LLWKHNMKOESCKUSW7P5VSW6O3PK4AJYJRV72BS6RYW4UBFFY7RABKXNEXEFN2EBAJ6SFSBA4LD2MRIFEGCFNPKGD6PJGXQDZS5HUAC5O3CCBSDN5VFMLMB7ZKP5FCKKPCJSNPU4QYBCZ7XZ7I=",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"3"},{score:3,extraData:"",rank:8,player:{uniqueID:"HIEVMLi6mvTkBDZeShUR5WUDgsh+uU01oqKOJX2NAtU=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"},hasPremium:!1},formattedScore:"3"},{score:3,extraData:"",rank:9,player:{uniqueID:"PURf4X7pWlTKHyMeMngFoXvdwROYn02YKAj7WQOwNMc=",lang:"en",publicName:"assassin",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"3"},{score:3,extraData:"",rank:10,player:{uniqueID:"XyViVzbgXjKxBEB0TZF/BsVsavhoXNImBFTFDFI/+ag=",lang:"ru",publicName:"manager o.",avatarIdHash:"5TFOWLDIUOZ2PPZZXZRMNELSFNN43XUSMRPRHA2FOYSS4CUUATCLMTRVSAUD7M3XSIGG4YJ5HJNEWOD6DU2PWSTKI7WW2AXPFABVXS7GRHSKYDVR5GQ3XZML5YR3UVSFWUDNM4FGKVPR55KTMGYB6IWVQMQG4ZDRVUJRQLFMKOAG54YAQQCQRBKATLHH6IWCHN3VKONI5NZ5VGPFE36HO===",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"3"},{score:3,extraData:"",rank:11,player:{uniqueID:"C6pzvIxZPvwRbCwsJBhgpdlcUKn+lbjRVE2NeQCgNQs=",lang:"ru",publicName:"Андрей",avatarIdHash:"AOE3YVU2QAZDN27NPJ6ALAW7TEXNC24JE7G42Z4AS5SWFXLF63JPJZ767G4LV2WI7X444XS4VMB4WBLN4VMX5KHJ5PHMVRGPH7HTWQ7GQDZPKIWLWFJVAZXZ6D4IUJ5XMPT44X4DSLWCPN55TTJS7GA=",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"3"},{score:3,extraData:"",rank:12,player:{uniqueID:"BVUM8ilBI6ClgaWx0AtcqonLVXssZDvAS0kZmH1ugI8=",lang:"ru",publicName:"Антон Г.",avatarIdHash:"DBADEDHEBTN6VL3ERPTEACDDZIHR7GUVY3U3UT5VL2RXCXQKAFZD6XBRHTUZDCOSEPU26VB5NYQMBHYJJQKIABC4UHN7YDKVUBV5YYCOW3ZJMV62RDZS4BYUMWS3S5RJKHDLAYGRR5WFV2EYPGEWDP44TMXFOFBBBSBGAP7SBXF5RF6CKKC2IOBFUZO5ZK44CKSHNGQQ5MQ4PQFIOSUVRLDSNJIJHFSDGE======",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"3"},{score:2,extraData:"",rank:13,player:{uniqueID:"cyqS65ogF/7TByTdQLzUwRgWfle0KxhjSlVBzrUDkq8=",lang:"ru",publicName:"Владислав Мещеряков",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"2"},{score:2,extraData:"",rank:14,player:{uniqueID:"CqQ3JY7PXMZ7YBEZKalyvv8C6XXg/nmD2iRJQc9CQxc=",lang:"ru",publicName:"idagiy",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"2"},{score:2,extraData:"",rank:15,player:{uniqueID:"Z8T39zPK29WifmUp2zbYVAZQpqpIeLj8HePzzcLlA7I=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"},hasPremium:!1},formattedScore:"2"},{score:2,extraData:"",rank:16,player:{uniqueID:"DggNKlILHeN/kxKuYdQfZMlQHlfiTU4hABkUppC91W8=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"},subscriptions:{},hasPremium:!1},formattedScore:"2"},{score:2,extraData:"",rank:17,player:{uniqueID:"3I8l6oezBizz2coy9hX7N1ULcPU168Q+Nmbi0QJqoEc=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"},hasPremium:!1},formattedScore:"2"},{score:2,extraData:"",rank:18,player:{uniqueID:"VrP6xEammgu2ukabstXrUCnmSMMhnOh8cTP9KZlB1h0=",lang:"ru",publicName:"Ayk Aloyan",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"2"},{score:1,extraData:"",rank:19,player:{uniqueID:"LwbO3HDjXYfEy5fC1mKees8HQUd6fjy52O3iIFpV0JA=",lang:"ru",publicName:"Толя",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"1"},{score:1,extraData:"",rank:20,player:{uniqueID:"GtGntnw+koVlRFiILdQLENj/pxDMYUbXHQF/KcT+eb8=",lang:"ru",publicName:"Дмитрий N",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},hasPremium:!1},formattedScore:"1"}]}))(e)):s()},1e3)}),getLeaderboardPlayerEntry:e=>new Promise((e,t)=>{setTimeout(()=>{Math.random()>0?e(i):t()},1e3)})};t.initMockYSDK=()=>new Promise(e=>{setTimeout(()=>{window.ysdk={environment:{i18n:{lang:"ru"}},getLeaderboards:()=>Promise.resolve(a),adv:{showFullscreenAdv:e=>{setTimeout(()=>{e.callbacks.onClose()},500)},showRewardedVideo:e=>{setTimeout(()=>{Math.random()>0&&e.callbacks.onRewarded()},500),setTimeout(()=>{e.callbacks.onClose()},1500)}},getPlayer:()=>Promise.resolve({getMode:()=>"lite"})},e(void 0)},0)})}]);