!function(e){function t(t){for(var i,o,r=t[0],h=t[1],c=t[2],d=0,u=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(e[i]=h[i]);for(l&&l(t);u.length;)u.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],i=!0,r=1;r<s.length;r++){var h=s[r];0!==n[h]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=s[0]))}return e}var i={},n={0:0},a=[];function o(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=i,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(s,i,function(t){return e[t]}.bind(null,i));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window.webpackJsonp=window.webpackJsonp||[],h=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var l=h;a.push([21,1]),s()}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDev=t.GAME_CONFIG=t.LEVELS_CONFIG=t.ENEMIES_CONFIG=t.CONFIG=void 0;var i=s(22);Object.defineProperty(t,"CONFIG",{enumerable:!0,get:function(){return i.CONFIG}});var n=s(17);Object.defineProperty(t,"ENEMIES_CONFIG",{enumerable:!0,get:function(){return n.ENEMIES_CONFIG}});var a=s(10);Object.defineProperty(t,"LEVELS_CONFIG",{enumerable:!0,get:function(){return a.LEVELS_CONFIG}});var o=s(16);Object.defineProperty(t,"GAME_CONFIG",{enumerable:!0,get:function(){return o.GAME_CONFIG}}),t.isDev=!1},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(23),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var i=s(26);Object.defineProperty(t,"Vector",{enumerable:!0,get:function(){return i.Vector}})},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(25),t),n(s(11),t),n(s(27),t),n(s(28),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=void 0;t.Service=class{constructor(e){this.scene=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HEX_COLORS=t.COLORS=void 0,t.COLORS={white:16777215,green:65280,red:16711680,gray:14540253,yellow:16548895},t.HEX_COLORS={white:"#ffffff",green:"#00ff00"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRainbowText=t.UICosmons=t.UIButton=void 0;var i=s(38);Object.defineProperty(t,"UIButton",{enumerable:!0,get:function(){return i.UIButton}});var n=s(39);Object.defineProperty(t,"UICosmons",{enumerable:!0,get:function(){return n.UICosmons}});var a=s(40);Object.defineProperty(t,"UIRainbowText",{enumerable:!0,get:function(){return a.UIRainbowText}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=void 0;const i=s(0);class n extends Phaser.Scene{getData(){return this.game.data}setData(e,t){this.game.data[e]=t,i.isDev&&console.log(`[${e}] was updated in global data:`,this.game.data)}}t.Scene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Enemy=void 0;const i=s(0);t.Enemy=class{constructor(e,t){this.scene=e,this.name=t}act(e,t){}damage(e){this.hp-=e,this.hp<=0&&this.destroy()}destroy(){const{scene:e,body:t,coinChance:s}=this;e.enemies=e.enemies.filter(e=>e!==this),t.destroy();const i=e.getStats();Math.random()>1-s&&e.utils.createBonus(t.x,t.y),i.kills[this.name]+=1,i.totalKills+=1,e.shakeScreen()}isOutsideScene(){const{body:e}=this;return e.x<0||e.x>i.CONFIG.width||e.y<0||e.y>i.CONFIG.height}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SphereBullet=t.Bullet=void 0;var i=s(19);Object.defineProperty(t,"Bullet",{enumerable:!0,get:function(){return i.Bullet}});var n=s(45);Object.defineProperty(t,"SphereBullet",{enumerable:!0,get:function(){return n.Sphere}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LEVELS_CONFIG=void 0;const i=s(1),n=s(24);t.LEVELS_CONFIG=[n.getLevelConfig({level:0,title:"Red Alert",text:"Space invaders have attacked our base. Come back and find out the reason for the invasion.\n    \nWarning! A lot of invaders have been detected on our way.",mode:{type:i.GameMode.totalKills,target:30}}),n.getLevelConfig({level:1,title:"Hunters",text:"Hunters in sight. It's the most common units among the enemy ships. Be careful, they follow for their targets.",mode:{type:i.GameMode.enemyKills,target:{hunter:15}}}),n.getLevelConfig({level:2,title:"UFO",text:"Seems like aliens are also against us. Or maybe their ships were hijacked?",mode:{type:i.GameMode.time,target:150}})]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spreadRadians=t.spreadAngle=t.getAngleDiff=t.getOffsetToAngle=t.getNearestAngle=t.angleToRadians=t.angleToDegrees=t.getAngleBetween=void 0;const i=s(2);function n(e){return e*Math.PI/180}t.getAngleBetween=function(e,t){const s=e.x-t.x,i=e.y-t.y;let n=Math.atan2(i,s);return n<0&&(n+=2*Math.PI),n},t.angleToDegrees=function(e){return e/Math.PI*180},t.angleToRadians=n,t.getNearestAngle=function(e,t,s){return Math.abs(e-t)<2?e:(Math.abs(e-t)<180?e<t?e+=s:e-=s:e<t?e-=s:e+=s,(e%360+360)%360)};t.getOffsetToAngle=(e,t)=>new i.Vector(Math.cos(e)*t,Math.sin(e)*t);t.getAngleDiff=(e,t)=>{const s=Math.abs(e-t);return Math.abs((s+180)%360-180)};t.spreadAngle=(e,t)=>e-t+Math.random()*(2*t);t.spreadRadians=(e,s)=>t.spreadAngle(e,n(s))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UFO=t.Hunter=t.Bot=t.Enemy=void 0;var i=s(8);Object.defineProperty(t,"Enemy",{enumerable:!0,get:function(){return i.Enemy}});var n=s(44);Object.defineProperty(t,"Bot",{enumerable:!0,get:function(){return n.Bot}});var a=s(48);Object.defineProperty(t,"Hunter",{enumerable:!0,get:function(){return a.Hunter}});var o=s(49);Object.defineProperty(t,"UFO",{enumerable:!0,get:function(){return o.UFO}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Effect=void 0;t.Effect=class{constructor(e){this.scene=e}act(){}destroy(){const{body:e}=this;this.scene.effects=this.scene.effects.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level=void 0;const i=s(1),n=s(0),a=s(10);t.Level=class{constructor(e,t){this.nextAttemptTime=0,this.scene=e,this.mode=a.LEVELS_CONFIG[t].mode}update(){const{scene:e,nextAttemptTime:t,nextAttemptTimeInterval:s}=this,i=e.gameTime;i>t&&(this.makeAttempt(),this.nextAttemptTime=i+s),this.updateStatus()}updateStatus(){const{scene:e,mode:t}=this,s=e.getStats(),n=t.type;switch(n){case i.GameMode.totalKills:{const e=+t.target;this.status=e-s.totalKills;break}case i.GameMode.enemyKills:{const e=t.target,i=Object.values(e).reduce((e,t)=>e+t,0),n=Object.keys(e).reduce((t,i)=>{const n=e[i];return t+Math.min(n,s.kills[i]||0)},0);this.status=i-n;break}case i.GameMode.time:this.status=Math.ceil(+t.target-e.gameTime/1e3);break;default:throw new Error(`Mode "${n}" is not set or not defined!`)}this.status=Math.max(this.status,0)}getTextByMode(){return void 0===this.status?"":this.status.toString()}checkForWin(){const{mode:e,status:t}=this;if(void 0===t)return!1;const s=e.type;switch(s){case i.GameMode.totalKills:case i.GameMode.enemyKills:case i.GameMode.time:return t<=0;default:throw new Error(`Mode "${s}" is not set or not defined!`)}}createEnemy(e){const{scene:t}=this,s={x:n.CONFIG.width,y:n.CONFIG.height},i=Math.random()>.5?"y":"x",a=[-50,s[i]+50][Math.floor(2*Math.random())],o={x:"x"===i?a:Math.random()*n.CONFIG.width,y:"y"===i?a:Math.random()*n.CONFIG.height};t.enemies.push(new e(t,o))}}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INITIAL_GAME_DATA=t.GAME_CONFIG=void 0;const i=s(0),n=s(29),a=s(60),o=s(61),r=s(62),h=s(63);t.GAME_CONFIG={type:Phaser.AUTO,width:i.CONFIG.width,height:i.CONFIG.height,physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[a.MenuScene,n.GameScene,h.PreviewScene,o.FailScene,r.WinScene]},t.INITIAL_GAME_DATA={level:0,levels:{},score:0}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENEMIES_CONFIG=void 0,t.ENEMIES_CONFIG={bot:{pluralName:["bot","bots","bots"]},hunter:{pluralName:["hunter","hunters","hunters"]}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIComponent=void 0;t.UIComponent=class{constructor(e){this.scene=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bullet=void 0;const i=s(0),n=s(1);t.Bullet=class{constructor(e,t,s,i){this.scene=e,this.pos=t,this.owner=s,this.damage=i}act(e,t){}update(e,t){const{body:s}=this;(s.x<0||s.x>i.CONFIG.width||s.y<0||s.y>i.CONFIG.height)&&this.destroy()}initCollisions(){const{scene:e,owner:t,damage:s}=this;t===n.Owner.player?e.enemies.forEach(t=>{e.physics.add.collider(this.body,t.body,()=>{this.explode(),t.damage(s)})}):e.physics.add.collider(this.body,e.player.body,()=>{this.explode(),e.player.damage(s)})}explode(){}destroy(){const{body:e}=this;this.scene.bullets=this.scene.bullets.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fire=t.Explode=t.Effect=void 0;var i=s(13);Object.defineProperty(t,"Effect",{enumerable:!0,get:function(){return i.Effect}});var n=s(46);Object.defineProperty(t,"Explode",{enumerable:!0,get:function(){return n.Explode}});var a=s(47);Object.defineProperty(t,"Fire",{enumerable:!0,get:function(){return a.Fire}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0,s(15);const i=s(16),n=s(0);class a extends Phaser.Game{constructor(e){super(e),this.data=i.INITIAL_GAME_DATA}}t.Game=a,window.addEventListener("load",()=>{const e=new a(i.GAME_CONFIG);n.isDev&&console.log("game",e)})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONFIG=void 0;const i=s(10);t.CONFIG={title:"Space Invaders",subtitle:"The battle for the galaxy",width:800,height:600,levelsCount:i.LEVELS_CONFIG.length,scene:{delta:16,minYPos:100,failTimeoutTime:2e3,winTimeoutTime:2e3,failTitleText:"MISSION FAILED",failSubtitleText:"Your ship was destroyed.",winTitleText:"MISSION COMPLETED"}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SceneName=t.EnemyName=t.GameMode=t.Owner=void 0,function(e){e.player="player",e.enemy="enemy"}(t.Owner||(t.Owner={})),function(e){e.totalKills="totalKills",e.enemyKills="enemyKill",e.time="time"}(t.GameMode||(t.GameMode={})),function(e){e.bot="bot",e.hunter="hunter"}(t.EnemyName||(t.EnemyName={})),function(e){e.menu="MenuScene",e.preview="PreviewScene",e.game="GameScene",e.fail="FailScene",e.win="WinScene"}(t.SceneName||(t.SceneName={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLevelConfig=void 0;const i=s(17),n=s(1),a=s(3),o=e=>{switch(e.type){case n.GameMode.totalKills:{const t=e.target;return`Mission: kill ${t} ${a.pluralize(t,["invader","invaders","invaders"])}`}case n.GameMode.enemyKills:{const t=e.target;return"Mission: kill "+Object.keys(t).map(e=>{const s=t[e];return`${s} ${a.pluralize(s,i.ENEMIES_CONFIG[e].pluralName)}`}).join(" / ")}case n.GameMode.time:{const t=e.target;return`Mission: stay alive for ${t} ${a.pluralize(t,["second","seconds","seconds"])}`}}};t.getLevelConfig=e=>Object.assign(Object.assign({},e),{mission:o(e.mode)})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCenterBody=void 0;const i=s(2);t.getCenterBody=(e,t,s,n,a={x:0,y:0})=>{const o=e/s/2-n+a.x,r=t/s/2-n+a.y;return new i.Vector(o,r)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;t.Vector=class{constructor(e,t){this.x=e,this.y=t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomInt=void 0;t.getRandomInt=(e,t)=>Math.round(e+Math.random()*(t-e))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pluralize=void 0,t.pluralize=function(e,t){switch(function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}(e)){case 0:return t[0];case 1:return t[1];default:return t[2]}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;var i=s(30);Object.defineProperty(t,"GameScene",{enumerable:!0,get:function(){return i.GameScene}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;const i=s(0),n=s(31),a=s(7),o=s(54),r=s(1),h=s(55),c=s(56),l=s(59);let d;class u extends a.Scene{constructor(){super({key:r.SceneName.game}),this.enemies=[],this.bullets=[],this.effects=[],this.bonuses=[],this.score=0,this.services=[],this.stats=l.getInitialGameData(),this.isWon=!1,this.isFail=!1,this.gameTime=0}preload(){}init(e){this.params=e}create(){this.resetState(),this.physics.world.setBounds(0,0,i.CONFIG.width,i.CONFIG.height),this.background=this.add.image(0,0,"background").setOrigin(0,0).setAlpha(.2),d=this.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16711680}}),this.player=new o.Player(this),this.utils=new c.Utils(this),this.initListeners(),this.initServices(),this.initTimer(),this.shakeCamera=this.cameras.add(0,0,i.CONFIG.width,i.CONFIG.height)}initTimer(){this.time.addEvent({delay:10,callback:this.onClockEvent,callbackScope:this,loop:!0})}onClockEvent(){this.gameTime+=15}initListeners(){this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.M).on("down",()=>{this.player.body.active&&this.scene.start(r.SceneName.menu)})}initServices(){this.addService(n.StarsService,{count:20}),this.addService(n.MeteorsService,{}),this.addService(n.InterfaceService,{}),this.addService(n.LevelService,{}),this.addService(n.CometsService,{})}addService(e,t){this.services.push(new e(this,t))}update(e,t){d.clear(),this.enemies.forEach(s=>{s.act(e,t)}),this.bullets.forEach(s=>{s.act(e,t)}),this.effects.forEach(e=>{e.act()}),this.services.forEach(s=>{s.act(e,t)}),this.bonuses.forEach(e=>{e.act()}),this.player.act(e,t)}resetState(){this.bullets=[],this.enemies=[],this.effects=[],this.bonuses=[],this.score=0,this.text="",this.services=[],this.stats=l.getInitialGameData(),this.isWon=!1,this.isFail=!1,this.gameTime=0}onFail(){this.isFail=!0,setTimeout(()=>{this.scene.start(r.SceneName.fail)},i.CONFIG.scene.failTimeoutTime)}onWin(){this.isWon||this.isFail||(this.isWon=!0,setTimeout(()=>{this.isFail||this.scene.start(r.SceneName.win,{score:this.score,isFlawlessVictory:this.player.hp===this.player.maxHp})},i.CONFIG.scene.winTimeoutTime))}shakeScreen(){this.shakeCamera.shake(500,.003)}getStats(){return this.stats}}t.GameScene=u,u.prototype.preload=h.preload},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=t.CometsService=t.LevelService=t.InterfaceService=t.LoggerService=t.MeteorsService=t.StarsService=void 0;var i=s(32);Object.defineProperty(t,"StarsService",{enumerable:!0,get:function(){return i.StarsService}});var n=s(34);Object.defineProperty(t,"MeteorsService",{enumerable:!0,get:function(){return n.MeteorsService}});var a=s(36);Object.defineProperty(t,"LoggerService",{enumerable:!0,get:function(){return a.LoggerService}});var o=s(37);Object.defineProperty(t,"InterfaceService",{enumerable:!0,get:function(){return o.InterfaceService}});var r=s(41);Object.defineProperty(t,"LevelService",{enumerable:!0,get:function(){return r.LevelService}});var h=s(52);Object.defineProperty(t,"CometsService",{enumerable:!0,get:function(){return h.CometsService}});var c=s(4);Object.defineProperty(t,"Service",{enumerable:!0,get:function(){return c.Service}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarsService=void 0;const i=s(33),n=s(4);class a extends n.Service{constructor(e,t){super(e),this.stars=[],this.params=t,this.init()}init(){const{scene:e}=this,{count:t}=this.params;for(let s=0;s<t;s++)this.stars.push(new i.Star(e,{initialAlphaCoef:500*s}))}act(e,t){this.update(e,t)}update(e,t){this.stars.forEach(s=>{s.act(e,t)})}}t.StarsService=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Star=void 0;const i=s(0);t.Star=class{constructor(e,t){this.scene=e,this.body=e.add.sprite(Math.random()*i.CONFIG.width,Math.random()*i.CONFIG.height,"star"),this.initialCoef=t.initialAlphaCoef,this.body.setDepth(0),this.body.setScale(.25+.25*Math.random())}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:n,initialCoef:a,lastRelocationTime:o}=this,r=s.gameTime;n.angle+=4,n.alpha=Math.sin((r+a)/1500),r>o&&n.alpha<=.5&&(n.x=Math.random()*i.CONFIG.width,n.y=Math.random()*i.CONFIG.height,this.lastRelocationTime=r+1e3)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeteorsService=void 0;const i=s(0),n=s(2),a=s(35),o=s(11),r=s(3),h=s(4);class c extends h.Service{constructor(e,t){super(e),this.meteors=[],this.meteorIntervalTime=1e3,this.meteorIntervalTimeRange=1e3,this.lastMeteorTime=0,this.maxCount=25,this.params=t,this.init()}init(){for(let e=0;e<r.getRandomInt(5,8);e++)this.spawnMeteor({outside:!1});for(let e=0;e<r.getRandomInt(3,5);e++)this.spawnMeteor({outside:!0})}act(e,t){this.update(e,t)}update(e,t){const{scene:s,maxCount:n}=this,a=t/i.CONFIG.scene.delta;s.gameTime>this.lastMeteorTime&&this.meteors.length<n&&this.spawnMeteor({outside:!0}),this.meteors.forEach(e=>{const{body:t,speed:s}=e;t.angle+=.5*s.x*a,t.x+=s.x*a,t.y+=s.y*a,(t.x>i.CONFIG.width+200||t.y>i.CONFIG.height+200)&&(this.meteors=this.meteors.filter(t=>t!==e),t.destroy())})}spawnMeteor({outside:e}){const{scene:t}=this,s=t.gameTime,{meteorIntervalTime:r,meteorIntervalTimeRange:h}=this,c=.5+1*Math.random(),l=o.angleToRadians(45),d=.25+2.5*Math.random(),u=new n.Vector(d*Math.cos(l),d*Math.sin(l)),p=Math.random()>.5?"x":"y",g=e?{x:"x"===p?Math.random()*(.75*i.CONFIG.width)-200:-200,y:"y"===p?Math.random()*(.75*i.CONFIG.height)-200:-200}:{x:i.CONFIG.width*Math.random(),y:i.CONFIG.height*Math.random()};this.meteors.push(new a.Meteor(t,g,u,{spriteIndex:1+Math.floor(4*Math.random()),alpha:.25+.4*Math.random(),scale:c})),this.lastMeteorTime=Math.random()*h+s+r*c}}t.MeteorsService=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Meteor=void 0;t.Meteor=class{constructor(e,t,s,i){this.scene=e,this.body=e.add.sprite(t.x,t.y,"meteor-"+i.spriteIndex),this.speed=s,this.body.setAlpha(i.alpha),this.body.setDepth(5),this.body.setScale(i.scale,i.scale)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerService=void 0;const i=s(4);class n extends i.Service{constructor(e,t){super(e),this.lastLogTime=0,this.params=t,this.init()}init(){}act(){this.update()}update(){const e=this.scene,t=e.gameTime;t>this.lastLogTime&&(console.group("Stats"),console.log("effects: "+e.effects.length),console.log("enemies: "+e.enemies.length),console.log("bullets: "+e.bullets.length),console.groupEnd(),this.lastLogTime=t+2e3)}}t.LoggerService=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterfaceService=void 0;const i=s(0),n=s(2),a=s(5),o=s(6),r=s(4);class h extends r.Service{constructor(e,t){super(e),this.backgroundInitialAlpha=0,this.backgroundChangeTime=15e3,this.params=t,this.init()}init(){const{scene:e}=this;this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16711680}}),this.counterText=e.add.bitmapText(i.CONFIG.width-17,27,"atari","0",24).setOrigin(1,.5).setDepth(500),this.scoreText=new o.UICosmons(e,{pos:new n.Vector(243,27),value:0,isCentered:!1,depth:100}),this.playerHealthbar=new Phaser.Geom.Rectangle(20,24,i.CONFIG.width,11),this.graphics.setDepth(500),this.backgroundInitialAlpha=Math.random()*(5*this.backgroundChangeTime)}act(){this.draw(),this.update()}draw(){this.drawHealthbar(),this.drawScore()}update(){const{scene:e,backgroundInitialAlpha:t,backgroundChangeTime:s}=this,i=.25*(1+Math.sin((t+e.gameTime)/s));e.background.setAlpha(i)}drawHealthbar(){const{graphics:e,scene:t,playerHealthbar:s}=this,{player:i}=t;e.clear(),e.fillStyle(a.COLORS.red),s.width=200,e.fillRectShape(s),e.fillStyle(a.COLORS.green),s.width=Math.max(i.hp/i.maxHp*200,0),e.fillRectShape(s),e.lineStyle(2,a.COLORS.white),s.width=200,e.strokeRectShape(s)}drawScore(){const{scene:e,counterText:t,scoreText:s}=this;t.setText(e.text),s.updateValue(e.score)}}t.InterfaceService=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIButton=void 0;const i=s(5);class n extends Phaser.GameObjects.Image{constructor(e,t,s,n,a){super(e,t,s,n),this.graphics=e.add.graphics({lineStyle:{width:2,color:i.COLORS.white},fillStyle:{color:i.COLORS.white}}),this.params=a,this.init()}init(){const{scene:e,graphics:t,x:s,y:n}=this,{width:a,height:o,text:r,disabled:h}=this.params;this.width=a,this.height=o,this.setOrigin(.5,0);const c=h?.5:1;h?t.alpha=c:this.setInteractive({cursor:"pointer"});const l=new Phaser.Geom.Rectangle(s-a/2,n,a,o);t.strokeRectShape(l);const d=e.add.bitmapText(s,n+Math.floor(o/2),"atari","",16).setOrigin(.5).setAlpha(c).setCenterAlign();d.setText(r),this.on("pointerover",()=>{t.alpha=c,t.lineStyle(2,i.COLORS.green),d.tint=i.COLORS.green,document.body.style.cursor="pointer",t.strokeRectShape(l)}),this.on("pointerout",()=>{t.alpha=c,t.lineStyle(2,i.COLORS.white),d.tint=i.COLORS.white,document.body.style.cursor="default",t.strokeRectShape(l)}),this.on("pointerdown",()=>{document.body.style.cursor="default"})}}t.UIButton=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UICosmons=void 0;const i=s(18);class n extends i.UIComponent{constructor(e,t){super(e),this.params=t,this.init()}init(){const{scene:e,params:t}=this,{pos:s,value:i,isCentered:n,depth:a,prefix:o}=t,r=o?12:0,h=e.add.image(s.x,s.y,"coin-gold").setOrigin(0,.5).setDepth(a),c=new Phaser.GameObjects.BitmapText(e,s.x+h.width+12-4,s.y+4+1,"atari",o,22).setOrigin(0,.5).setDepth(a);if(o&&e.add.existing(c),this.valueText=e.add.bitmapText(s.x+h.width+12+r,s.y+4,"atari",i.toString(),22).setOrigin(0,.5).setDepth(a),n){const e=(h.width+12+this.valueText.width+r)/2;h.x-=e,this.valueText.x-=e,c.x-=e}}updateValue(e){this.valueText.setText(e.toString())}}t.UICosmons=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRainbowText=void 0;const i=s(5),n=s(18),a={fontSize:23,color:i.COLORS.green};class o extends n.UIComponent{constructor(e,t){super(e),this.rainbowColorIdx=0,this.rainbowColorOffset=0,this.delay=0,this.rainbowWave=0,this.params=Object.assign(Object.assign({},a),t),this.init()}init(){const{scene:e}=this,{text:t,pos:s,color:i}=this.params;this.rainbowCallback=this.rainbowCallback.bind(this);const n=e.add.dynamicBitmapText(s.x,s.y,"atari",t,23).setOrigin(.5).setCenterAlign();n.setDisplayCallback(this.rainbowCallback),n.tint=i}update(){this.updateRainbow()}updateRainbow(){this.rainbowColorIdx=0,6==this.delay++&&(this.rainbowColorOffset=(this.rainbowColorOffset+1)%4,this.delay=0)}rainbowCallback(e){const{color:t}=this.params;return e.color=t,this.rainbowColorIdx=(this.rainbowColorIdx+1)%4,e.y=2*Math.cos(this.rainbowWave+this.rainbowColorIdx),this.rainbowWave+=.005,e}}t.UIRainbowText=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LevelService=void 0;const i=s(42),n=s(4);class a extends n.Service{constructor(e,t){super(e),this.params=t,this.init()}init(){const{scene:e}=this;this.currentLevel=new i.levels[e.params.level](e)}act(){this.update()}update(){const{scene:e,currentLevel:t}=this,s=t.checkForWin();e.text=t.getTextByMode(),t.update(),s&&e.onWin()}}t.LevelService=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.levels=void 0;const i=s(43),n=s(50),a=s(51);t.levels=[i.Level1,n.Level2,a.Level3]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level1=void 0;const i=s(12),n=s(14);class a extends n.Level{constructor(e){super(e,0),this.nextAttemptTimeInterval=1e3}makeAttempt(){const{scene:e}=this,{enemies:t}=e,s=e.getStats().totalKills>14?5:4;(t.length<3||t.length<s&&Math.random()>.75)&&this.createEnemy(i.Bot)}}t.Level1=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bot=void 0;const i=s(0),n=s(2),a=s(3),o=s(1),r=s(8),h=s(9);class c extends r.Enemy{constructor(e,t){super(e,o.EnemyName.bot),this.angle=0,this.coinChance=.9,this.weaponDamage=10,this.bodySize=32,this.depth=50,this.scale=.6,this.speed=2,this.rotateSpeed=2,this.hp=30,this.bulletSpeed=7,this.lastShoot=0,this.shootTime=1200,this.shootTimeRange=200,this.changeTargetInterval=1e3,this.changeTargetIntervalRange=2e3,this.body=e.physics.add.image(t.x,t.y,"enemy-bot-ship"),this.init(),this.defineTarget=this.defineTarget.bind(this),this.defineTarget()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const n=1.5+Math.random();this.speed=n,this.rotateSpeed=n;const o=a.getCenterBody(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y)}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:o,angle:r,targetAngle:h,rotateSpeed:c}=this;this.body.angle=r-90;const l=a.angleToRadians(r),d=t/i.CONFIG.scene.delta;if(o.x+=this.speed*Math.cos(l)*d,o.y+=this.speed*Math.sin(l)*d,this.angle=a.getNearestAngle(r,h,c),(o.x<100||o.y<100||o.x>i.CONFIG.width-100||o.y>i.CONFIG.height-100)&&this.setTarget(new n.Vector(i.CONFIG.width/2,i.CONFIG.height/2)),this.scene.gameTime>this.lastShoot){const e=s.player.body;this.shoot(new n.Vector(e.x,e.y))}}defineTarget(){const{changeTargetInterval:e,changeTargetIntervalRange:t}=this,s=new n.Vector(Math.random()*i.CONFIG.width,Math.random()*i.CONFIG.height);this.setTarget(s);const a=e+Math.random()*t;this.timeout=setTimeout(this.defineTarget,a)}setTarget(e){const{body:t}=this;this.targetPos=e,this.targetAngle=a.angleToDegrees(a.getAngleBetween(this.targetPos,t))}shoot(e){const{body:t,bulletSpeed:s,shootTimeRange:i,shootTime:r,weaponDamage:c}=this,l=a.getAngleBetween(e,new n.Vector(t.x,t.y));this.scene.bullets.push(new h.SphereBullet(this.scene,new n.Vector(t.x,t.y),o.Owner.enemy,{speed:a.getOffsetToAngle(l,s),angle:l,sprite:"laser-red",explodeSprite:"red-explode",damage:c})),this.lastShoot=this.scene.gameTime+r+Math.random()*i}destroy(){const{scene:e,body:t}=this;e.utils.tripleExplode(t.x,t.y),clearTimeout(this.timeout),super.destroy()}}t.Bot=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sphere=void 0;const i=s(2),n=s(0),a=s(3),o=s(20),r=s(19),h={scale:1,bodySize:6};class c extends r.Bullet{constructor(e,t,s,i){super(e,t,s,i.damage),this.depth=10,this.body=e.physics.add.image(t.x,t.y,i.sprite),this.params=Object.assign(Object.assign({},h),i),this.init()}init(){const{body:e,scene:t,params:s,depth:i}=this,{angle:n,scale:o}=s;e.setAngle(a.angleToDegrees(n)+90),e.setDepth(i),e.setOrigin(.5,.5),e.setScale(o),this.initBody(),this.initCollisions(),t.add.existing(this.body)}initBody(){const{params:e}=this,{angle:t,scale:s,bodySize:i}=e,n=a.getOffsetToAngle(t,this.body.displayHeight/s/3),o=a.getCenterBody(this.body.displayWidth,this.body.displayHeight,s,i,n);this.body.setCircle(i,o.x,o.y)}act(e,t){this.update(e,t)}draw(){}explode(){const{body:e,scene:t,params:s}=this;t.effects.push(new o.Explode(t,new i.Vector(e.x,e.y),{sprite:s.explodeSprite})),this.destroy()}update(e,t){const{body:s}=this,{speed:i}=this.params;s.x+=i.x*(t/n.CONFIG.scene.delta),s.y+=i.y*(t/n.CONFIG.scene.delta),super.update(e,t)}}t.Sphere=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Explode=void 0;const i=s(13);class n extends i.Effect{constructor(e,t,s){super(e),this.body=new Phaser.GameObjects.Sprite(e,t.x,t.y,s.sprite),this.params=s,this.startTime=e.gameTime,this.body.setScale(0),this.body.setDepth(115),e.add.existing(this.body)}act(){this.update()}update(){const{scene:e,startTime:t}=this,s=e.gameTime-t,i=Math.sin(s/150),n=i;this.body.angle+=3,this.body.setScale(n,n),this.body.setAlpha(i),i<.06&&s>100&&this.destroy()}}t.Explode=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fire=void 0;const i=s(11),n=s(13);class a extends n.Effect{constructor(e,t,s){super(e),this.speed=1.7,this.body=new Phaser.GameObjects.Sprite(e,t.x,t.y,"fire"),this.params=s,this.body.setDepth(5),this.body.setAngle(i.angleToDegrees(s.angle)+90),this.startTime=e.gameTime,this.params=s,e.add.existing(this.body)}act(){this.update()}update(){const{scene:e,body:t,speed:s,startTime:i,params:n}=this,a=e.gameTime-i;t.alpha=1-a/150,t.x+=s*Math.cos(n.angle),t.y+=s*Math.sin(n.angle),t.alpha<=0&&this.destroy()}}t.Fire=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hunter=void 0;const i=s(0),n=s(2),a=s(3),o=s(1),r=s(8),h=s(9);var c;!function(e){e.moving="moving",e.stop="stop",e.rotate="rotate",e.attack="attack"}(c||(c={}));class l extends r.Enemy{constructor(e,t){super(e,o.EnemyName.hunter),this.angle=0,this.weaponDamage=10,this.chanceToShoot=.25,this.lastShootTime=0,this.shootIntervalTime=1200,this.attackEndTime=0,this.attackIntervalTime=3e3,this.attackShootIntervalTime=325,this.attackSpreadRange=15,this.attackHunting=!0,this.lastChangeTargetTime=0,this.changeTargetInterval=1e3,this.changeTargetIntervalRange=2e3,this.rotateSpeed=2,this.currentRotateSpeed=this.rotateSpeed,this.rotateTimer=0,this.rotateIntervalTimer=3e3,this.maxSpeed=2,this.speed=2,this.speedIncrease=.05,this.stopEndTime=0,this.stopIntervalTime=3e3,this.stopIntervalRangeTime=1e3,this.coinChance=.9,this.bodySize=36,this.depth=50,this.scale=.7,this.hp=70,this.bulletSpeed=7,this.behavior=c.moving,this.body=e.physics.add.image(t.x,t.y,"enemy-hunter-ship"),this.init(),this.defineTarget=this.defineTarget.bind(this),this.defineTarget()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const n=a.getCenterBody(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,n.x,n.y),this.setStopEndTime(!0)}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:i,lastShootTime:o,shootIntervalTime:r,chanceToShoot:h,behavior:l,speedIncrease:d,stopEndTime:u,attackHunting:p,attackIntervalTime:g}=this,m=s.player.body,y=s.gameTime;switch(this.updateBase(y,t),l){case c.moving:this.speed<this.maxSpeed&&(this.speed+=d),y>o&&(Math.random()>1-h&&this.shoot(a.getAngleBetween(new n.Vector(m.x,m.y),new n.Vector(i.x,i.y))),this.lastShootTime=y+r),y>this.lastChangeTargetTime&&this.updateTarget(),y>u&&(this.behavior=c.stop);break;case c.stop:this.speed>0?this.speed-=d:this.setRotateBehavior();break;case c.rotate:this.setTarget(new n.Vector(m.x,m.y)),y>o&&(this.shoot(a.angleToRadians(this.angle),this.attackSpreadRange),this.lastShootTime=y+this.attackShootIntervalTime),a.getAngleDiff(this.targetAngle,this.angle)<=4?this.setAttackBehavior():y>this.rotateTimer&&this.setMovingBehavior();break;case c.attack:(p||y>this.attackEndTime-g/3)&&this.setTarget(new n.Vector(m.x,m.y)),this.speed<this.maxSpeed&&(this.speed+=d),y>o&&(this.shoot(a.angleToRadians(this.angle),this.attackSpreadRange),this.lastShootTime=y+this.attackShootIntervalTime),p&&y>this.attackEndTime-g/1.5&&(this.attackHunting=!1,this.updateTarget()),y>this.attackEndTime&&this.setMovingBehavior()}}updateBase(e,t){const{body:s,angle:o,targetAngle:r,currentRotateSpeed:h}=this;this.body.angle=o-90;const c=a.angleToRadians(o),l=t/i.CONFIG.scene.delta;s.x+=this.speed*Math.cos(c)*l,s.y+=this.speed*Math.sin(c)*l,this.angle=a.getNearestAngle(o,r,h),(s.x<100||s.y<100||s.x>i.CONFIG.width-100||s.y>i.CONFIG.height-100)&&this.setTarget(new n.Vector(i.CONFIG.width/2,i.CONFIG.height/2))}updateTarget(){const{scene:e,changeTargetInterval:t,changeTargetIntervalRange:s}=this,i=e.gameTime;this.defineTarget();const n=t+Math.random()*s;this.lastChangeTargetTime=i+n}defineTarget(){const e=new n.Vector(Math.random()*i.CONFIG.width,Math.random()*i.CONFIG.height);this.setTarget(e)}setTarget(e){const{body:t}=this;this.setTargetAngle(a.angleToDegrees(a.getAngleBetween(e,t)))}setTargetAngle(e){this.targetAngle=e}setAttackBehavior(){const{scene:e,rotateSpeed:t}=this,s=e.gameTime;this.attackEndTime=s+this.attackIntervalTime,this.currentRotateSpeed=t,this.attackHunting=!0,this.behavior=c.attack}setStopEndTime(e=!1){const{scene:t,stopIntervalTime:s,stopIntervalRangeTime:i}=this,n=t.gameTime;this.stopEndTime=e?n+1e3+a.getRandomInt(0,s):n+s+a.getRandomInt(0,i)}setMovingBehavior(){const{scene:e,changeTargetInterval:t,shootIntervalTime:s}=this,i=e.gameTime;this.setStopEndTime(),this.lastChangeTargetTime=i+t,this.lastShootTime=i+s,this.behavior=c.moving}setRotateBehavior(){const{scene:e,rotateIntervalTimer:t,rotateSpeed:s}=this,i=e.gameTime;this.speed=0,this.rotateTimer=i+t,this.currentRotateSpeed=s+1,this.behavior=c.rotate}shoot(e,t=0){const{body:s,bulletSpeed:i,weaponDamage:r}=this,c=a.spreadRadians(e,t);this.scene.bullets.push(new h.SphereBullet(this.scene,new n.Vector(s.x,s.y),o.Owner.enemy,{speed:a.getOffsetToAngle(c,i),angle:c,sprite:"laser-red",explodeSprite:"red-explode",damage:r}))}destroy(){const{scene:e,body:t}=this;e.utils.tripleExplode(t.x,t.y),super.destroy()}}t.Hunter=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UFO=void 0;const i=s(0),n=s(2),a=s(3),o=s(1),r=s(8),h=s(9);var c;!function(e){e.moving="moving",e.stop="stop",e.attack="attack"}(c||(c={}));class l extends r.Enemy{constructor(e,t){super(e,o.EnemyName.hunter),this.angle=0,this.weaponDamage=10,this.chanceToShoot=.25,this.lastShootTime=0,this.shootIntervalTime=1200,this.attackEndTime=0,this.attackIntervalTime=1e3,this.lastChangeTargetTime=0,this.changeTargetInterval=1e3,this.changeTargetIntervalRange=2e3,this.rotateSpeed=.5,this.maxSpeed=1,this.speed=1,this.speedIncrease=.02,this.stopEndTime=0,this.stopIntervalTime=1500,this.stopIntervalRangeTime=2500,this.coinChance=.9,this.bodySize=36,this.depth=50,this.scale=.7,this.hp=70,this.bulletSpeed=7,this.behavior=c.moving,this.body=e.physics.add.image(t.x,t.y,"enemy-ufo"),this.init(),this.defineTarget=this.defineTarget.bind(this),this.defineTarget()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const n=a.getCenterBody(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,n.x,n.y),this.setStopEndTime(!0)}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:i,lastShootTime:o,shootIntervalTime:r,chanceToShoot:h,behavior:l,speedIncrease:d,changeTargetInterval:u,changeTargetIntervalRange:p,stopEndTime:g}=this,m=s.player.body,y=s.gameTime;switch(this.updateBase(y,t),l){case c.moving:if(this.speed<this.maxSpeed&&(this.speed+=d),y>o&&(Math.random()>1-h&&this.shoot(a.getAngleBetween(new n.Vector(m.x,m.y),new n.Vector(i.x,i.y)),!1),this.lastShootTime=y+r),y>this.lastChangeTargetTime){this.defineTarget();const e=u+Math.random()*p;this.lastChangeTargetTime=y+e}y>g&&!this.isOutsideScene()&&(this.behavior=c.stop);break;case c.stop:this.speed>0?this.speed-=d:(this.attackEndTime=y+this.attackIntervalTime,this.behavior=c.attack);break;case c.attack:y>this.attackEndTime&&(this.circleAttack(),this.setMovingBehavior())}}updateBase(e,t){const{body:s,angle:o,targetAngle:r,rotateSpeed:h}=this;this.body.angle+=this.speed;const c=a.angleToRadians(o),l=t/i.CONFIG.scene.delta;s.x+=this.speed*Math.cos(c)*l,s.y+=this.speed*Math.sin(c)*l,this.angle=a.getNearestAngle(o,r,h),(s.x<100||s.y<100||s.x>i.CONFIG.width-100||s.y>i.CONFIG.height-100)&&this.setTarget(new n.Vector(i.CONFIG.width/2,i.CONFIG.height/2))}defineTarget(){const e=new n.Vector(Math.random()*i.CONFIG.width,Math.random()*i.CONFIG.height);this.setTarget(e)}setTarget(e){const{body:t}=this;this.targetPos=e,this.targetAngle=a.angleToDegrees(a.getAngleBetween(this.targetPos,t))}setStopEndTime(e=!1){const{scene:t,stopIntervalTime:s,stopIntervalRangeTime:i}=this,n=t.gameTime;this.stopEndTime=n+s+a.getRandomInt(0,i)}setMovingBehavior(){const{scene:e,changeTargetInterval:t,shootIntervalTime:s}=this,i=e.gameTime;this.setStopEndTime(),this.lastChangeTargetTime=i+t,this.lastShootTime=i+s,this.behavior=c.moving}circleAttack(){const e=45*Math.random();for(let t=0;t<8;t++)this.shoot(a.angleToRadians(e+45*t),!0)}shoot(e,t=!0){const{body:s,bulletSpeed:i,weaponDamage:r}=this;this.scene.bullets.push(new h.SphereBullet(this.scene,new n.Vector(s.x,s.y),o.Owner.enemy,{speed:a.getOffsetToAngle(e,i),angle:e,sprite:t?"sphere-bullet":"laser-red",explodeSprite:"red-explode",damage:r,scale:t?.35:1,bodySize:t?32:12}))}destroy(){const{scene:e,body:t}=this;e.utils.tripleExplode(t.x,t.y),this.circleAttack(),super.destroy()}}t.UFO=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level2=void 0;const i=s(12),n=s(1),a=s(14);class o extends a.Level{constructor(e){super(e,1),this.nextAttemptTimeInterval=1e3}makeAttempt(){const{scene:e}=this,{enemies:t}=e,s=e.getStats().kills.hunter>8?.65:0;t.length<5&&(t.length<4||Math.random()>.75-s)&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=e.getStats(),s=e.gameTime>6e4?.2:0,a=e.enemies.filter(e=>e.name===n.EnemyName.hunter).length,o=Math.floor(t.kills.bot/3)>t.kills.hunter+a;Math.random()>.3+s&&!o?this.createEnemy(i.Bot):this.createEnemy(i.Hunter)}}t.Level2=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level3=void 0;const i=s(12),n=s(14);class a extends n.Level{constructor(e){super(e,2),this.nextAttemptTimeInterval=1200,this.additionalTime=0,this.additionalTimeInterval=6e3,this.additionalTime=e.gameTime+this.additionalTimeInterval}update(){const{scene:e,additionalTime:t,additionalTimeInterval:s}=this;e.gameTime>t&&(this.spawnEnemy(),this.additionalTime=e.gameTime+s),super.update()}makeAttempt(){const{scene:e}=this,{enemies:t}=e;t.length<4&&this.spawnEnemy()}spawnEnemy(){const e=Math.random();e>.7?this.createEnemy(i.Bot):e>.3?this.createEnemy(i.Hunter):this.createEnemy(i.UFO)}}t.Level3=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CometsService=void 0;const i=s(0),n=s(53),a=s(4);class o extends a.Service{constructor(e,t){super(e),this.comets=[],this.count=15,this.params=t,this.init()}init(){const{scene:e,count:t}=this;for(let s=0;s<t;s++)this.comets.push(new n.Comet(e,{}))}act(e,t){this.update(e,t)}update(e,t){const s=t/i.CONFIG.scene.delta;this.comets.forEach(e=>{const{body:t}=e;t.y+=e.speed*s,t.y>i.CONFIG.height+100&&(e.updateParams(),e.refreshPosition())})}}t.CometsService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Comet=void 0;const i=s(0),n=s(3);t.Comet=class{constructor(e,t){this.speed=3,this.scene=e,this.body=this.scene.add.image(n.getRandomInt(0,i.CONFIG.width),n.getRandomInt(0,i.CONFIG.height),"comet"),this.updateParams()}updateParams(){const{body:e}=this;e.setAlpha(.03+.1*Math.random()),e.setScale(.2,.75+.5*Math.random()),this.speed=n.getRandomInt(3,7)}refreshPosition(){const{body:e}=this;e.x=n.getRandomInt(0,i.CONFIG.width),e.y=-100}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const i=s(0),n=s(2),a=s(1),o=s(3),r=s(9);t.Player=class{constructor(e){this.scale=.6,this.bodySize=26,this.speed=5,this.bulletSpeed=10,this.lastShootTime=0,this.shootTime=320,this.hp=100,this.maxHp=100,this.weaponDamage=10,this.angle=0,this.scene=e,this.body=this.scene.physics.add.image(300,300,"player-ship"),this.lastShootTime=e.gameTime+100,this.init()}init(){const{scene:e,scale:t}=this;this.body.setScale(t),this.body.setDepth(100),this.body.setImmovable(!0),e.add.existing(this.body)}act(e,t){this.update(e,t)}update(e,t){this.body.active&&(this.updateBody(e,t),this.updateShooting(e,t),this.updateMovement(e,t),this.updateAngle(e,t))}updateBody(e,t){const{scale:s,bodySize:i}=this,n=o.getOffsetToAngle(this.angle+Math.PI,10),a=o.getCenterBody(this.body.displayWidth,this.body.displayHeight,s,i,n);this.body.setCircle(i,a.x,a.y)}updateShooting(e,t){const{scene:s}=this,i=s.input.activePointer;i.isDown&&this.shoot(new n.Vector(i.x,i.y))}updateMovement(e,t){const{scene:s,body:n}=this,a=s.input.keyboard.createCursorKeys(),o=t/i.CONFIG.scene.delta;let r=this.speed*o;(a.up.isDown||a.down.isDown)&&(a.right.isDown||a.left.isDown)&&(r*=.8),a.up.isDown?n.y-=r:a.down.isDown&&(n.y+=r),a.right.isDown?n.x+=r:a.left.isDown&&(n.x-=r),n.x<0&&(n.x=0),n.y<i.CONFIG.scene.minYPos&&(n.y=i.CONFIG.scene.minYPos),n.x>i.CONFIG.width&&(n.x=i.CONFIG.width),n.y>i.CONFIG.height&&(n.y=i.CONFIG.height)}updateAngle(e,t){const{scene:s,body:i}=this,a=s.input.activePointer;this.angle=o.getAngleBetween(new n.Vector(a.x,a.y),new n.Vector(i.x,i.y)),this.body.angle=o.angleToDegrees(this.angle)+90}shoot(e){const{scene:t,body:s,bulletSpeed:i,weaponDamage:h}=this,c=t.gameTime;if(c>this.lastShootTime){const t=o.getAngleBetween(e,new n.Vector(s.x,s.y));this.scene.bullets.push(new r.SphereBullet(this.scene,new n.Vector(s.x,s.y),a.Owner.player,{speed:o.getOffsetToAngle(t,i),angle:t,sprite:"laser-green",explodeSprite:"green-explode",damage:h})),this.lastShootTime=c+this.shootTime}}damage(e){this.hp-=e,this.hp<=0&&this.destroy()}destroy(){const{scene:e,body:t}=this;e.utils.tripleExplode(t.x,t.y),t.destroy(),e.onFail(),e.shakeScreen()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preload=void 0,t.preload=function(){this.load.image("background","assets/images/background/gray.jpg"),this.load.image("player-ship","assets/images/ships/player-ship.png"),this.load.image("enemy-bot-ship","assets/images/ships/enemy-ship-2.png"),this.load.image("enemy-hunter-ship","assets/images/ships/enemy-hunter.png"),this.load.image("enemy-ufo","assets/images/ships/enemy-ufo.png"),this.load.image("laser-green","assets/images/bullets/laser-green-3.png"),this.load.image("laser-red","assets/images/bullets/laser-red-2.png"),this.load.image("sphere-bullet","assets/images/bullets/sphere-bullet.png"),this.load.image("green-explode","assets/images/effects/green-explode.png"),this.load.image("red-explode","assets/images/effects/red-explode.png"),this.load.image("orange-explode","assets/images/effects/orange-explode.png"),this.load.image("star","assets/images/effects/star-4.png"),this.load.image("fire","assets/images/effects/fire-3.png"),this.load.image("comet","assets/images/effects/comet.png"),this.load.image("meteor-1","assets/images/effects/meteor-gray-1.png"),this.load.image("meteor-2","assets/images/effects/meteor-gray-2.png"),this.load.image("meteor-3","assets/images/effects/meteor-gray-3.png"),this.load.image("meteor-4","assets/images/effects/meteor-gray-4.png"),this.load.audio("laser-1",["assets/audio/sfx_laser1.ogg"]),this.load.audio("laser-2",["assets/audio/sfx_laser2.ogg"]),this.load.image("coin-bronze","assets/images/bonus/star-bronze.png"),this.load.image("coin-silver","assets/images/bonus/star-silver.png")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const i=s(2),n=s(57),a=s(3),o=s(20);t.Utils=class{constructor(e){this.scene=e}explode(e,t){const{scene:s}=this;s.effects.push(new o.Explode(s,new i.Vector(e,t),{sprite:"orange-explode"}))}tripleExplode(e,t){const s=360*Math.random()/3;for(let i=0;i<3;i++){const n=a.angleToRadians(120*i+s);this.explode(e+30*Math.cos(n),t+30*Math.sin(n))}}createBonus(e,t){const{scene:s}=this;s.bonuses.push(new n.Coin(s,new i.Vector(e,t)))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;const i=s(58),n={0:{sprite:"coin-bronze",cost:5},1:{sprite:"coin-silver",cost:7},2:{sprite:"coin-gold",cost:10}};class a extends i.Bonus{constructor(e,t){super(e),this.lifeTime=5e3;const s=n[(()=>{const e=Math.random();return e>.5?0:e>.2?1:2})()];this.cost=s.cost,this.body=this.scene.physics.add.image(t.x,t.y,s.sprite),this.creationTime=e.gameTime,this.init()}init(){this.body.setDepth(10),this.body.setCircle(16),this.initCollisions()}initCollisions(){const{scene:e}=this;e.physics.add.collider(this.body,e.player.body,()=>{e.score+=this.cost,this.destroy()})}act(){this.update()}update(){const{scene:e,body:t}=this,s=e.gameTime;t.angle+=3*Math.sin(.003*s),s>this.creationTime+this.lifeTime&&this.destroy()}}t.Coin=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bonus=void 0;t.Bonus=class{constructor(e){this.scene=e}act(){}destroy(){const{body:e}=this;this.scene.bonuses=this.scene.bonuses.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialGameData=void 0;t.getInitialGameData=()=>({totalKills:0,kills:{bot:0,hunter:0}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MenuScene=void 0;const i=s(5),n=s(2),a=s(0),o=s(6),r=s(1),h=s(7);let c=!1;const l=a.CONFIG.width/2;class d extends h.Scene{constructor(){super({key:r.SceneName.menu})}preload(){this.load.image("coin-gold","assets/images/bonus/star-gold.png"),c||(this.load.bitmapFont("atari","assets/fonts/atari/bitmap/gem.png","assets/fonts/atari/bitmap/gem.xml"),c=!0)}create(){this.graphics=this.add.graphics({lineStyle:{width:2,color:i.COLORS.white},fillStyle:{color:i.COLORS.white}}),this.createTitle(l,155),this.createSubtitle(l,200),new o.UICosmons(this,{pos:new n.Vector(l,245),value:this.getData().score,isCentered:!0,depth:100}),this.createLevelText(l,320),this.createStartButton(l,355),this.createLabButton(l,420)}update(){this.rainbowText.update()}createTitle(e,t){this.add.bitmapText(e,t,"atari",a.CONFIG.title,32).setOrigin(.5)}createSubtitle(e,t){this.rainbowText=new o.UIRainbowText(this,{pos:new n.Vector(e,t),text:a.CONFIG.subtitle})}createLevelText(e,t){const s=this.getData().level,i=`Next level: ${s+1}. ${a.LEVELS_CONFIG[s].title}`;this.add.dynamicBitmapText(e,t,"atari",i,19).setOrigin(.5)}createStartButton(e,t){new o.UIButton(this,e,t,"",{width:180,height:46,text:"Start game"}).on("pointerdown",()=>{this.scene.start(r.SceneName.preview,{level:this.getData().level})})}createLabButton(e,t){new o.UIButton(this,e,t,"",{width:180,height:46,text:"Lab",disabled:!0}).on("pointerdown",()=>{console.log("lab")})}}t.MenuScene=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FailScene=void 0;const i=s(5),n=s(2),a=s(0),o=s(6),r=s(1),h=s(7);class c extends h.Scene{constructor(){super({key:r.SceneName.fail})}preload(){}init(e){this.params=e}create(){let e=a.CONFIG.height/2-90;this.rainbowTitle=new o.UIRainbowText(this,{pos:new n.Vector(a.CONFIG.width/2,e),text:a.CONFIG.scene.failTitleText,fontSize:28,color:i.COLORS.red}),e+=20;const t=new Phaser.GameObjects.BitmapText(this,a.CONFIG.width/2,e,"atari",a.CONFIG.scene.failSubtitleText,19);t.setOrigin(.5,0).setCenterAlign().setTint(i.COLORS.white),this.add.existing(t),e+=67,this.createTryAgainButton(e),e+=65,this.createMenuButton(e)}update(){this.rainbowTitle.update()}createMenuButton(e){new o.UIButton(this,a.CONFIG.width/2,e,"",{width:160,height:46,text:"Go to menu"}).on("pointerdown",()=>{this.scene.start(r.SceneName.menu)})}createTryAgainButton(e){const t=new o.UIButton(this,a.CONFIG.width/2,e,"",{width:160,height:46,text:"Try again"}),s={level:this.getData().level};t.on("pointerdown",()=>{this.scene.start(r.SceneName.game,s)})}}t.FailScene=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WinScene=void 0;const i=s(2),n=s(0),a=s(6),o=s(1),r=s(7);class h extends r.Scene{constructor(){super({key:o.SceneName.win})}preload(){}init(e){this.params=e}create(){var e;const t=n.CONFIG.width/2;let s=n.CONFIG.height/2-180;const i=this.getData(),{score:a,isFlawlessVictory:o}=this.params,r=(null===(e=i.levels[i.level])||void 0===e?void 0:e.score)||0,h=o?Math.ceil(.25*a):0,c=a+h,l=r<c?c-r:0,d={currentLevel:i.level,score:a,totalScore:c,bestLevelScore:r,flawlessVictoryScores:h,plusScore:l};this.createTitle(t,s),s+=35,this.createScores(t,s,d),s+=170,this.createNextButton(s),s+=65,this.createTryAgainButton(s),s+=65,this.createMenuButton(s),this.updateGlobalData(d)}update(){this.rainbowTitle.update()}createTitle(e,t){this.rainbowTitle=new a.UIRainbowText(this,{pos:new i.Vector(e,t),text:n.CONFIG.scene.winTitleText,fontSize:28})}createScores(e,t,s){const n=`Score: ${s.score}\nFlawless victory: ${s.flawlessVictoryScores}\nBest score: ${s.bestLevelScore}\nTotal score: ${s.totalScore}`,o=new Phaser.GameObjects.BitmapText(this,e,t,"atari",n,18).setOrigin(.5,0).setCenterAlign();this.add.existing(o),new a.UICosmons(this,{pos:new i.Vector(e,t+120),isCentered:!0,value:s.plusScore,prefix:"+",depth:100})}createNextButton(e){const t=this.getData().level;new a.UIButton(this,n.CONFIG.width/2,e,"",{width:160,height:46,text:"Next level",disabled:n.CONFIG.levelsCount<=t+1}).on("pointerdown",()=>{this.setData("level",t+1);const e={level:this.getData().level};this.scene.start(o.SceneName.preview,e)})}createTryAgainButton(e){const t=new a.UIButton(this,n.CONFIG.width/2,e,"",{width:160,height:46,text:"Try again"}),s={level:this.getData().level};t.on("pointerdown",()=>{this.scene.start(o.SceneName.game,s)})}createMenuButton(e){const t=this.getData(),{level:s,levels:i}=t;new a.UIButton(this,n.CONFIG.width/2,e,"",{width:160,height:46,text:"Go to menu"}).on("pointerdown",()=>{s+1<n.CONFIG.levelsCount&&this.setData("level",s+1),this.scene.start(o.SceneName.menu)})}updateGlobalData(e){const t=this.getData();e.bestLevelScore<e.totalScore&&(this.setData("levels",Object.assign(Object.assign({},t.levels),{[e.currentLevel]:{score:e.totalScore}})),this.setData("score",t.score+e.plusScore))}}t.WinScene=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewScene=void 0;const i=s(5),n=s(0),a=s(6),o=s(1),r=s(7);class h extends r.Scene{constructor(){super({key:o.SceneName.preview})}init(e){this.params=e}create(){const{params:e}=this,{level:t}=e,{title:s,text:a,mission:o}=n.LEVELS_CONFIG[t],r=n.CONFIG.height/2,h=new Phaser.GameObjects.BitmapText(this,n.CONFIG.width/2,0,"atari",`${t+1}. ${s}`,32);h.setOrigin(.5,0).setCenterAlign();const c=new Phaser.GameObjects.BitmapText(this,n.CONFIG.width/2,0,"atari",a,18);c.setMaxWidth(400).setOrigin(.5,0).setCenterAlign();const l=new Phaser.GameObjects.BitmapText(this,n.CONFIG.width/2,0,"atari",o,18);l.setMaxWidth(400).setOrigin(.5,0).setCenterAlign().setTint(i.COLORS.green);const d=r-(h.height+c.height+l.height+100)/2+5;h.y=d-25,c.y=h.y+65,l.y=c.y+c.height+25,this.add.existing(h),this.add.existing(c),this.add.existing(l),this.drawButton(l.y+l.height+45)}drawButton(e){const t=new a.UIButton(this,n.CONFIG.width/2,e,"",{width:120,height:46,text:"Go"}),s={level:this.params.level};t.on("pointerdown",()=>{this.scene.start(o.SceneName.game,s)})}}t.PreviewScene=h}]);