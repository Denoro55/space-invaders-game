!function(e){function t(t){for(var i,n,r=t[0],h=t[1],l=t[2],d=0,u=[];d<r.length;d++)n=r[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&u.push(a[n][0]),a[n]=0;for(i in h)Object.prototype.hasOwnProperty.call(h,i)&&(e[i]=h[i]);for(c&&c(t);u.length;)u.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],i=!0,r=1;r<s.length;r++){var h=s[r];0!==a[h]&&(i=!1)}i&&(o.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={0:0},o=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var r=window.webpackJsonp=window.webpackJsonp||[],h=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var c=h;o.push([41,1]),s()}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(12);i.__exportStar(s(31),t),i.__exportStar(s(50),t),i.__exportStar(s(51),t),i.__exportStar(s(52),t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(12);i.__exportStar(s(46),t),i.__exportStar(s(30),t),i.__exportStar(s(47),t),i.__exportStar(s(48),t),i.__exportStar(s(49),t),i.__exportStar(s(53),t),i.__exportStar(s(54),t),i.__exportStar(s(55),t),i.__exportStar(s(56),t),i.__exportStar(s(34),t),i.__exportStar(s(84),t),i.__exportStar(s(85),t),i.__exportStar(s(86),t),i.__exportStar(s(87),t),i.__exportStar(s(88),t),i.__exportStar(s(89),t),i.__exportStar(s(90),t),i.__exportStar(s(91),t)},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var i=s(43);Object.defineProperty(t,"Vector",{enumerable:!0,get:function(){return i.Vector}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SECOND=t.defaultUISpacings=t.defaultUIPositions=t.fontSizes=t.leaderboardsNames=t.DEVELOPER_EMAIL=t.depths=t.enemySafeAreaPercentage=t.SECONDARY_FONT=t.DEFAULT_FONT=t.defaultButtonParams=t.FULLSCREEN_TIMEOUT_DELAY=t.ORIENTATION_UPDATE_TIMEOUT_DELAY=void 0;s(12).__exportStar(s(44),t),t.ORIENTATION_UPDATE_TIMEOUT_DELAY=200,t.FULLSCREEN_TIMEOUT_DELAY=200,t.defaultButtonParams={width:180,width190:190,width120:120,height:46,spaceX:25,spaceY:70,spaceYText:25,paddingX:35},t.DEFAULT_FONT="Roboto",t.SECONDARY_FONT="atari",t.enemySafeAreaPercentage={x:10,y:10},t.depths={boss:101,graphics:500,overlay:499,modal:501,modalContent:502},t.DEVELOPER_EMAIL="interplanetary-guardian@mail.ru",t.leaderboardsNames={main:"main",mobile:"mobile"},t.fontSizes={title:22,textMedium:18,text:16,textSmall:14},t.defaultUIPositions={top:65,bottom:50},t.defaultUISpacings={text:15},t.SECOND=1e3},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.START_DEVELOPMENT_TIME=t.CRYPTO_TOKEN=t.IS_DEV=t.env=t.fireflyConfig=t.bossesConfig=t.playerConfig=t.storeConfig=t.boostersConfig=t.levelsConfig=t.enemiesConfig=t.mainConfig=void 0;const i=s(12);var a=s(42);Object.defineProperty(t,"mainConfig",{enumerable:!0,get:function(){return a.mainConfig}});var o=s(107);Object.defineProperty(t,"enemiesConfig",{enumerable:!0,get:function(){return o.enemiesConfig}});var n=s(29);Object.defineProperty(t,"levelsConfig",{enumerable:!0,get:function(){return n.levelsConfig}});var r=s(108);Object.defineProperty(t,"boostersConfig",{enumerable:!0,get:function(){return r.boostersConfig}});var h=s(109);Object.defineProperty(t,"storeConfig",{enumerable:!0,get:function(){return h.storeConfig}});var l=s(110);Object.defineProperty(t,"playerConfig",{enumerable:!0,get:function(){return l.playerConfig}});var c=s(26);Object.defineProperty(t,"bossesConfig",{enumerable:!0,get:function(){return c.bossesConfig}});var d=s(111);Object.defineProperty(t,"fireflyConfig",{enumerable:!0,get:function(){return d.fireflyConfig}}),i.__exportStar(s(36),t),t.env={buildTime:1668608301456},t.IS_DEV=!1,t.CRYPTO_TOKEN="space-invaders",t.START_DEVELOPMENT_TIME=new Date(2021,8,5)},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=void 0;const i=s(5),a=s(1),o=s(113);class n extends Phaser.Scene{constructor(){super(...arguments),this.ui=new o.UI(this),this.sceneTime=0}updateSceneUniqueId(){this.sceneUniqueId=Date.now()+Math.random()}getData(){return this.game.data}getSettings(){return this.game.settings}getQueryParam(e,t=!1){return a.getQueryParam(this.getSettings().queryParams,e,t)}setData(e,t){this.game.data[e]=t,i.IS_DEV&&console.log(`[${e}] was updated in global data:`,this.game.data)}getGameSize(){return{width:+this.game.config.width,height:+this.game.config.height}}getGameCenter(){const e=this.getGameSize();return{x:Math.round(e.width/2),y:Math.round(e.height/2)}}getLastUpdatedGameTime(){const{getText:e}=this.game.i18n,t=new Date(i.env.buildTime).toLocaleString();return`${e("lastUpdated")}: ${t}`}updateSceneTime(e,t){this.sceneTime+=15*t/i.mainConfig.scene.delta}isTheSameScene(e,t){return this.sceneUniqueId===e&&this.game.scene.isActive(t)}}t.Scene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level=void 0;const i=s(5),a=s(0),o=s(138),n={[a.EGameMode.totalKills]:o.TotalKillsMode,[a.EGameMode.enemyKills]:o.EnemyKillsMode,[a.EGameMode.time]:o.TimeMode,[a.EGameMode.waves]:o.WavesMode,[a.EGameMode.boss]:o.BossMode};t.Level=class{constructor(e,t){this.spawnTime=0,this.scene=e;const s=i.levelsConfig.levels[t].mode;this.spawnTimeInterval=i.levelsConfig.spawnTimeInterval[this.scene.getSettings().deviceType],this.mode=new n[s.type](e,s)}update(){const{scene:e,spawnTime:t}=this,{gameTime:s}=e;s>t&&(this.spawn(),this.mode.spawn(),this.spawnTime=s+this.getSpawnInterval()),this.updateStatus()}updateStatus(){const e=this.mode.getStatus();this.status=e.value,this.statusText=e.text}getTextByMode(){return void 0===this.statusText?"":this.statusText}checkForWin(){const{status:e}=this;return void 0!==e&&e<=0}getSpawnInterval(){return this.spawnTimeInterval}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Defender=t.LaserShip=t.MissileCarrier=t.Stealth=t.Destroyer=t.Flyer=t.UFO=t.Hunter=t.Bot=t.Enemy=void 0;var i=s(10);Object.defineProperty(t,"Enemy",{enumerable:!0,get:function(){return i.Enemy}});var a=s(94);Object.defineProperty(t,"Bot",{enumerable:!0,get:function(){return a.Bot}});var o=s(95);Object.defineProperty(t,"Hunter",{enumerable:!0,get:function(){return o.Hunter}});var n=s(96);Object.defineProperty(t,"UFO",{enumerable:!0,get:function(){return n.UFO}});var r=s(97);Object.defineProperty(t,"Flyer",{enumerable:!0,get:function(){return r.Flyer}});var h=s(98);Object.defineProperty(t,"Destroyer",{enumerable:!0,get:function(){return h.Destroyer}});var l=s(99);Object.defineProperty(t,"Stealth",{enumerable:!0,get:function(){return l.Stealth}});var c=s(100);Object.defineProperty(t,"MissileCarrier",{enumerable:!0,get:function(){return c.MissileCarrier}});var d=s(101);Object.defineProperty(t,"LaserShip",{enumerable:!0,get:function(){return d.LaserShip}});var u=s(102);Object.defineProperty(t,"Defender",{enumerable:!0,get:function(){return u.Defender}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Enemy=void 0;const i=s(3),a=s(4),o=s(18),n=s(1),r=s(5);t.Enemy=class{constructor(e,t,s){this.reward=0,this.isInsideSafeArea=!1,this.angle=0,this.targetAngle=0,this.lastChangeTargetTime=0,this.lastFireTime=0,this.scene=e,this.name=t,this.setPropertiesFromConfig();const a=this.scene.getGameCenter();this.angle=n.getAngleBetweenPointsInDegrees(new i.Vector(a.x,a.y),s)}setPropertiesFromConfig(){this.reward=r.enemiesConfig.ships[this.name].reward}act(e,t){}updateSafeArea(e,t){const{isInsideSafeArea:s}=this;this.isOutsideSafeArea(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y)?(s&&this.onOutOfSafeArea(this.scene.utils.getSafeAreaPoint()),this.isInsideSafeArea=!1):this.isInsideSafeArea=!0}damage(e){this.hp-=e,this.hp<=0&&this.destroy()}destroy(){const{scene:e,body:t}=this;e.enemies=e.enemies.filter(e=>e!==this),t.destroy();const s=e.getStats();Math.random()>1-e.player.fortune/100&&e.utils.createBonus(t.x,t.y,this.reward),s.kills[this.name]+=1,s.totalKills+=1,e.shakeScreen()}isOutsideSafeArea(e,t){const{body:s}=this,i=this.scene.getGameSize(),a=i.width*(e/100),o=i.height*(t/100);return s.x<a||s.x>i.width-a||s.y<o||s.y>i.height-o}onOutOfSafeArea(e){}setRandomTargetAngleWithInterval(){const{scene:e,changeTargetTimeInterval:t}=this;this.setTargetAngle(this.scene.utils.getRandomPos(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y));const s=t[0]+Math.random()*t[1];this.lastChangeTargetTime=e.gameTime+s}setRandomTargetAngle(){this.setTargetAngle(this.scene.utils.getRandomPos(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y))}setTargetAngle(e){const{body:t}=this;this.targetAngle=n.getAngleBetweenPointsInDegrees(e,t)}updateFire(){const{scene:e,body:t,angle:s,lastFireTime:a}=this,r=e.gameTime,h=n.angleToRadians(s+180);r>a&&(e.effects.push(new o.Fire(e,{pos:new i.Vector(t.x+45*Math.cos(h+.4),t.y+45*Math.sin(h+.4)),angle:h})),e.effects.push(new o.Fire(e,{pos:new i.Vector(t.x+45*Math.cos(h-.4),t.y+45*Math.sin(h-.4)),angle:h})),this.lastFireTime=r+75)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=void 0;t.Service=class{constructor(e){this.scene=e}}},,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIComponent=void 0;t.UIComponent=class{constructor(e){this.scene=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mode=void 0;t.Mode=class{constructor(e,t){this.scene=e,this.modeParams=t}spawn(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FireflyExplode=t.Shadow=t.Fire=t.Explode=t.Effect=void 0;var i=s(19);Object.defineProperty(t,"Effect",{enumerable:!0,get:function(){return i.Effect}});var a=s(45);Object.defineProperty(t,"Explode",{enumerable:!0,get:function(){return a.Explode}});var o=s(92);Object.defineProperty(t,"Fire",{enumerable:!0,get:function(){return o.Fire}});var n=s(93);Object.defineProperty(t,"Shadow",{enumerable:!0,get:function(){return n.Shadow}});var r=s(35);Object.defineProperty(t,"FireflyExplode",{enumerable:!0,get:function(){return r.FireflyExplode}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Effect=void 0;t.Effect=class{constructor(e){this.scene=e}act(){}destroy(){const{body:e}=this;this.scene.effects=this.scene.effects.filter(e=>e!==this),e.destroy()}}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIIndicator=t.UITabs=t.UICircleProgress=t.UIRewardedModal=t.UIRainbowText=t.UICosmons=void 0;s(12).__exportStar(s(114),t);var i=s(117);Object.defineProperty(t,"UICosmons",{enumerable:!0,get:function(){return i.UICosmons}});var a=s(118);Object.defineProperty(t,"UIRainbowText",{enumerable:!0,get:function(){return a.UIRainbowText}});var o=s(119);Object.defineProperty(t,"UIRewardedModal",{enumerable:!0,get:function(){return o.UIRewardedModal}});var n=s(37);Object.defineProperty(t,"UICircleProgress",{enumerable:!0,get:function(){return n.UICircleProgress}});var r=s(120);Object.defineProperty(t,"UITabs",{enumerable:!0,get:function(){return r.UITabs}});var h=s(121);Object.defineProperty(t,"UIIndicator",{enumerable:!0,get:function(){return h.UIIndicator}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RayBullet=t.RocketBullet=t.SphereBullet=t.Bullet=void 0;var i=s(165);Object.defineProperty(t,"Bullet",{enumerable:!0,get:function(){return i.Bullet}});var a=s(166);Object.defineProperty(t,"SphereBullet",{enumerable:!0,get:function(){return a.Sphere}});var o=s(167);Object.defineProperty(t,"RocketBullet",{enumerable:!0,get:function(){return o.Rocket}});var n=s(168);Object.defineProperty(t,"RayBullet",{enumerable:!0,get:function(){return n.Ray}})},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss=void 0;const i=s(3),a=s(26),o=s(1);t.Boss=class{constructor(e,t){this.angle=0,this.scale=1,this.bodyDamageReloadTime=0,this.scene=e,this.bossName=t}initCollisions(){const{scene:e}=this;e.physics.add.overlap(this.body,e.player.body,()=>{e.gameTime>this.bodyDamageReloadTime&&(e.player.hit(a.bossesConfig.bodyDamage),this.bodyDamageReloadTime=e.gameTime+200)})}act(e,t){}damage(e){this.hp=Math.max(this.hp-e,0),this.hp<=0&&this.destroy()}isOutsideSafeArea(e,t){const{body:s}=this,i=this.scene.getGameSize(),a=i.width*(e/100),o=i.height*(t/100);return s.x<a||s.x>i.width-a||s.y<o||s.y>i.height-o}setPropertiesFromConfig(){const e=a.bossesConfig.bosses[this.bossName];this.maxHp=e.maxHp,this.hp=this.maxHp,this.rewardedScore=e.reward}destroy(){const{scene:e}=this,t=new i.Vector(this.body.x,this.body.y);for(let e=0;e<3;e++){const s=o.getOffsetByAngle(this.angle+120*e,70);this.scene.utils.createTripleExplode(t.x+s.x,t.y+s.y)}this.body.destroy(),e.shakeScreen(),this.scene.score+=this.rewardedScore}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bossesConfig=void 0,t.bossesConfig={bodyDamage:10,bosses:{ghost:{maxHp:2e3,reward:400,paramsByDevice:{splashAttackBulletsOffset:{desktop:15,mobile:20},circleAttackBulletsCount:{desktop:8,mobile:6},bombsCount:{desktop:10,mobile:8},laserAttackReloadTime:{desktop:400,mobile:500},laserDoubleAttackReloadTime:{desktop:250,mobile:350},splashAttackReloadTime:{desktop:600,mobile:800},explodeAttackReloadTime:{desktop:500,mobile:1e3},explodeBulletSpeedTime:{desktop:40,mobile:20}}},chastener:{maxHp:3e3,reward:1200,paramsByDevice:{}}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bonus=void 0;t.Bonus=class{constructor(e){this.scene=e}act(){}destroy(){const{body:e}=this;this.scene.bonuses=this.scene.bonuses.filter(e=>e!==this),e.destroy()}}},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.levelsConfig=t.levelsSchema=void 0;const i=s(9),a=s(0),o=s(103),n=s(104);t.levelsSchema=[{maxEnemies:3,mode:{type:a.EGameMode.totalKills,target:15}},{maxEnemies:3,mode:{type:a.EGameMode.enemyKills,target:{hunter:10}}},{maxEnemies:3,mode:{type:a.EGameMode.time,target:90}},{maxEnemies:4,mode:{type:a.EGameMode.waves,target:[{maxEnemies:3,enemies:o.getEnemiesArray([i.Bot,5],i.Hunter,i.Bot)},{maxEnemies:3,enemies:o.getEnemiesArray(i.Hunter,[i.Bot,3],i.Hunter,[i.Bot,3],i.Hunter)},{maxEnemies:3,enemies:o.getEnemiesArray([i.Hunter,2],i.Bot,i.Hunter,[i.Bot,2],i.Hunter,[i.Bot,3])},{maxEnemies:4,enemies:o.getEnemiesArray(i.Bot,i.Hunter,i.UFO,[i.Bot,2],[i.Hunter,2],i.Bot,i.UFO,i.Hunter)},{maxEnemies:4,enemies:o.getEnemiesArray(i.UFO,i.Bot,[i.Hunter,2],[i.Bot,2],i.UFO,[i.Hunter,2],i.Bot,[i.UFO,2])}]}},{maxEnemies:1,mode:{type:a.EGameMode.boss,target:n.Boss1}},{maxEnemies:4,mode:{type:a.EGameMode.totalKills,target:30}},{maxEnemies:4,mode:{type:a.EGameMode.enemyKills,target:{destroyer:10}}},{maxEnemies:4,mode:{type:a.EGameMode.time,target:150}},{maxEnemies:4,mode:{type:a.EGameMode.waves,target:[{maxEnemies:4,enemies:o.getEnemiesArray([i.Hunter,2],i.UFO,i.Bot,i.Hunter,[i.UFO,2],[i.Hunter,2],i.Bot)},{maxEnemies:4,enemies:o.getEnemiesArray([i.Hunter,2],[i.Flyer,2],[i.UFO,2],i.Hunter,[i.Flyer,2],[i.UFO,2],[i.Hunter,2])},{maxEnemies:4,enemies:o.getEnemiesArray(i.Hunter,[i.UFO,2],[i.Destroyer,2],[i.Flyer,3],i.Bot,[i.Hunter,2],[i.Destroyer,2],[i.UFO,2],i.Bot,[i.Flyer,2])},{maxEnemies:5,enemies:o.getEnemiesArray([i.Hunter,2],[i.Destroyer,3],[i.Flyer,4],i.Bot,[i.UFO,2],[i.Destroyer,3],[i.Flyer,2],[i.UFO,2],[i.Destroyer,2],[i.Flyer,4],i.UFO)},{maxEnemies:5,enemies:o.getEnemiesArray([i.Flyer,6],[i.Destroyer,3],[i.Flyer,2],[i.Stealth,2],[i.Destroyer,2],[i.Hunter,2],[i.Stealth,3],[i.Flyer,3],[i.Destroyer,3],[i.Stealth,2],[i.Flyer,3],i.Destroyer,[i.Stealth,2])}]}},{maxEnemies:4,mode:{type:a.EGameMode.boss,target:n.Boss2}},{maxEnemies:4,mode:{type:a.EGameMode.totalKills,target:30}},{maxEnemies:4,mode:{type:a.EGameMode.enemyKills,target:{"laser-ship":10}}},{maxEnemies:4,mode:{type:a.EGameMode.time,target:150}}];const r=t.levelsSchema.map((e,t)=>Object.assign(Object.assign({},e),{level:t}));t.levelsConfig={spawnTimeInterval:{desktop:1500,mobile:3e3},levels:r}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spreadRadians=t.spreadAngle=t.getAngleDiff=t.getOffsetByAngle=t.getOffsetByRadians=t.getNearestAngle=t.angleToRadians=t.angleToDegrees=t.getAngleBetweenPointsInDegrees=t.getAngleBetweenPointsInRadians=void 0;const i=s(3);function a(e,t){return Math.atan2(e.y-t.y,e.x-t.x)}function o(e){return e/Math.PI*180}function n(e){return e*Math.PI/180}t.getAngleBetweenPointsInRadians=a,t.getAngleBetweenPointsInDegrees=function(e,t){return o(a(e,t))},t.angleToDegrees=o,t.angleToRadians=n,t.getNearestAngle=function(e,t,s){if(Math.abs(e-t)<s)return t;Math.abs(e-t)<180?e<t?e+=s:e-=s:e<t?e-=s:e+=s;const i=(e%360+360)%360;return i>180?i-360:i};t.getOffsetByRadians=(e,t)=>new i.Vector(Math.cos(e)*t,Math.sin(e)*t);t.getOffsetByAngle=(e,s)=>t.getOffsetByRadians(n(e),s);t.getAngleDiff=(e,t)=>{const s=Math.abs(e-t);return Math.abs((s+180)%360-180)};t.spreadAngle=(e,t)=>e-t+Math.random()*(2*t);t.spreadRadians=(e,s)=>t.spreadAngle(e,n(s))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EBoosterType=t.ESceneName=t.EBossName=t.EEnemyName=t.EGameMode=t.EOwner=t.EPlayerStoreProduct=t.EDeviceType=t.ELanguage=void 0,function(e){e.ru="ru",e.en="en"}(t.ELanguage||(t.ELanguage={})),function(e){e.desktop="desktop",e.mobile="mobile"}(t.EDeviceType||(t.EDeviceType={})),function(e){e.damage="damage",e.movementSpeed="movementSpeed",e.attackSpeed="attackSpeed",e.maxHealth="maxHealth",e.explosionResistance="explosionResistance",e.bonusesTime="bonusesTime",e.fortune="fortune"}(t.EPlayerStoreProduct||(t.EPlayerStoreProduct={})),function(e){e.player="player",e.enemy="enemy"}(t.EOwner||(t.EOwner={})),function(e){e.totalKills="totalKills",e.enemyKills="enemyKill",e.time="time",e.waves="waves",e.boss="boss"}(t.EGameMode||(t.EGameMode={})),function(e){e.bot="bot",e.defender="defender",e.destroyer="destroyer",e.ufo="ufo",e.hunter="hunter",e.flyer="flyer",e.stealth="stealth",e.missileCarrier="missile-carrier",e.laserShip="laser-ship"}(t.EEnemyName||(t.EEnemyName={})),function(e){e.ghost="ghost",e.chastener="chastener"}(t.EBossName||(t.EBossName={})),function(e){e.ad="AdScene",e.menu="MenuScene",e.preview="PreviewScene",e.game="GameScene",e.fail="FailScene",e.win="WinScene",e.info="InfoScene",e.preload="PreloadScene",e.history="HistoryScene",e.loading="LoadingScene",e.contacts="ContactsScene",e.store="StoreScene",e.leaderboards="LeaderboardsScene",e.workshop="WorkshopsScene",e.rankedBosses="RankedBossesScene",e.final="FinalScene"}(t.ESceneName||(t.ESceneName={})),function(e){e.speed="bonus-speed",e.damage="bonus-damage",e.shield="bonus-shield",e.regenerator="bonus-regenerator"}(t.EBoosterType||(t.EBoosterType={}))},,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debugLog=void 0;const i=s(5);t.debugLog=(e,t)=>{i.IS_DEV&&console.log(`[${e}]:`,t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FireflyExplode=void 0;const i=s(5),a=s(19);class o extends a.Effect{constructor(e,t){super(e),this.body=new Phaser.GameObjects.Image(e,t.pos.x,t.pos.y,"firefly"),this.params=t,this.init()}init(){const{scene:e,params:t}=this;this.startTime=e.gameTime,this.body.setScale(t.scale),e.add.existing(this.body),this.spawnCoins(),e.cameras.main.flash(i.fireflyConfig.cameraFlashDuration)}act(){this.update()}update(){const{scene:e,params:t,startTime:s}=this,i=e.gameTime-s,a=t.scale+i/100;this.body.setScale(a,a),this.body.setAlpha(Math.max(0,1-i/500)),this.body.alpha<=0&&this.destroy()}spawnCoins(){const{scene:e}=this,t=this.scene.getData().level,s=i.fireflyConfig.reward+Math.floor(t*i.fireflyConfig.increaseRewardPerLevel);for(let t=0;t<10;t++){const t=e.utils.getRandomPos(5,10);e.utils.createBonus(t.x,t.y,s)}}}t.FireflyExplode=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMobileGameConfig=t.getDesktopGameConfig=t.baseConfig=void 0;const i=s(112),a=s(1),o=a.parseQuery(window.location.search),n=1332,r=620,h=768,l=1e3,c=450,d=550;t.baseConfig={type:Phaser.AUTO,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:Boolean(a.getQueryParam(o,"debug"))}},scene:[i.PreloadScene,i.MenuScene,i.GameScene,i.PreviewScene,i.FailScene,i.WinScene,i.InfoScene,i.HistoryScene,i.AdScene,i.LoadingScene,i.ContactsScene,i.LeaderboardsScene,i.StoreScene,i.FinalScene]};t.getDesktopGameConfig=()=>({width:n,height:Math.min(Math.max(n*window.innerHeight/window.innerWidth,r),h),scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}});t.getMobileGameConfig=()=>({width:l,height:Math.min(Math.max(l*window.innerHeight/window.innerWidth,c),d),scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UICircleProgress=void 0;const i=s(16);class a extends i.UIComponent{constructor(e,t){super(e),this.isVisible=!1,this.params=t,this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),t.depth&&this.graphics.setDepth(t.depth)}update(e){const{params:t}=this;this.graphics.clear();const s=(270+Math.min(360-360*e.percentage,360))%360;this.graphics.lineStyle(2,e.color),this.graphics.beginPath(),this.graphics.arc(t.pos.x,t.pos.y,20,Phaser.Math.DegToRad(s),Phaser.Math.DegToRad(270),!1),this.graphics.strokePath(),this.isVisible=!0}hide(){this.isVisible&&(this.graphics.clear(),this.isVisible=!1)}}t.UICircleProgress=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Booster=t.boosters=void 0;const i=s(5),a=s(0),o=s(27);t.boosters={0:a.EBoosterType.speed,1:a.EBoosterType.damage,2:a.EBoosterType.shield,3:a.EBoosterType.regenerator};class n extends o.Bonus{constructor(e,t,s){super(e),this.creationTime=e.gameTime,this.type=s,this.body=this.scene.physics.add.image(t.x,t.y,this.type),this.init()}init(){this.body.setDepth(10),this.body.setSize(32,32),this.initCollisions()}initCollisions(){const{scene:e}=this;e.physics.add.collider(this.body,e.player.body,()=>{e.player.setBooster(this.type),this.destroy()})}act(){this.update()}update(){const{scene:e,body:t}=this,s=e.gameTime;t.scale=1.2+Math.sin(.004*s)/6,s>this.creationTime+1e3*i.boostersConfig.lifeTime&&this.destroy()}}t.Booster=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EStoreSection=void 0,function(e){e.characteristics="characteristics",e.ships="ships",e.weapons="weapons",e.boosters="boosters"}(t.EStoreSection||(t.EStoreSection={}))},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Leaderboards=t.AdManager=t.Translations=t.I18n=t.LocalStorage=t.EventEmitter=t.Game=void 0;var a=s(181);Object.defineProperty(t,"Game",{enumerable:!0,get:function(){return a.Game}});var o=s(182);Object.defineProperty(t,"EventEmitter",{enumerable:!0,get:function(){return o.EventEmitter}});var n=s(183);Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return i(n).default}});var r=s(184);Object.defineProperty(t,"I18n",{enumerable:!0,get:function(){return i(r).default}});var h=s(185);Object.defineProperty(t,"Translations",{enumerable:!0,get:function(){return h.Translations}});var l=s(186);Object.defineProperty(t,"AdManager",{enumerable:!0,get:function(){return l.AdManager}});var c=s(187);Object.defineProperty(t,"Leaderboards",{enumerable:!0,get:function(){return c.Leaderboards}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s(28);const i=s(5),a=s(180),o=s(40),n=s(0),r=s(1),h=s(4),l=s(188);let c,d=!1,u=!1,m=!1,p=null;const g=r.parseQuery(window.location.search),y=o.LocalStorage.getGameData(),S=document.querySelector(".rotate-screen-overlay__content"),b=w(),f=new o.I18n(b);function v(){const e=Number(r.getQueryParam(g,"level",!0))-1;return!isNaN(e)&&r.isLevelNumberValid(e)?e:(null==y?void 0:y.level)&&r.isLevelNumberValid(null==y?void 0:y.level)?y.level:0}function x(){const e=Number(r.getQueryParam(g,"score",!0));if(e&&!isNaN(e))return e;const t=Number(null==y?void 0:y.score);return t||0}function T(){const e=null==y?void 0:y.store;return null!=e?e:{}}function w(){const e=r.getQueryParam(g,"lang");if(e&&r.isLangExists(e))return e;if(void 0!==window.ysdk&&r.isLangExists(window.ysdk.environment.i18n.lang))return window.ysdk.environment.i18n.lang;const t=window.navigator.language;return r.isLangExists(t)?t:n.ELanguage.ru}function P(){u||void 0===window.ysdk||(r.isLandscapeOrientation()||!r.isMobileDevice()?(!function(){var e;const t={level:v(),score:x(),wasHistoryShown:!1,isWaitButtonPressed:Boolean(null==y?void 0:y.isWaitButtonPressed)||!1,store:Object.assign({maxHealth:0,movementSpeed:0,attackSpeed:0,bonusesTime:0,explosionResistance:0,damage:0,fortune:0},T())},s={isMobile:r.isMobileDevice(),deviceType:r.getDeviceType(),queryParams:g,lang:w()};c=new o.Game(a.getGameConfig(),{data:t,settings:s,i18n:f}),null===(e=document.getElementById("spinner"))||void 0===e||e.remove(),u=!0}(),i.IS_DEV?console.log("Game inited",c):console.log("Game inited")):console.log("Game could not be inited as it does not support portrait orientation"))}function B(e=120){if(!d)return;const t=r.getCurrentOrientation();t!==p?(p=t,P(),r.isLandscapeOrientation()?r.hideOrientationWarning():r.isMobileDevice()&&(r.showOrientationWarning(),c&&r.hideFullscreen())):e>0&&window.requestAnimationFrame(()=>{B(e-1)})}function M(){m||g["mock-sdk"]||(m=!0,window.YaGames.init().then(e=>{console.log("Yandex SDK initialized"),window.ysdk=e,P()}))}r.debugLog("ls data",y),window.addEventListener("orientationchange",()=>{setTimeout(()=>{B()},h.ORIENTATION_UPDATE_TIMEOUT_DELAY)}),window.addEventListener("load",M),window.addEventListener("onSDKLoaded",M),f.loadLang(b).then(()=>{d=!0,document.body.classList.add("lang-loaded");const e=f.getKeyValue("rotateDevice");S&&e&&(S.textContent=e),B()}),r.isMobileDevice(),g["mock-sdk"]&&l.initMockYSDK().then(()=>{P()})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mainConfig=void 0;s(29);const i=s(0);t.mainConfig={gameTitle:"The Interplanetary Guardian",gameSubtitle:"A threat to humanity",totalLevelsCount:10,touch:{pointerSize:32,pointerRadius:100,areaSize:35,areaOffset:85},scene:{delta:16,minYPos:100,failTimeoutTime:2e3,winTimeoutTime:2e3},languages:[i.ELanguage.ru,i.ELanguage.en]}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;t.Vector=class{constructor(e,t){this.x=e,this.y=t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexColors=t.colors=void 0,t.colors={black:0,white:16777215,green:65280,red:16711680,gray:14540253,gray2:6710886,yellow:16548895,blue:3327,aqua:36863,bronze:13467442,silver:12632256,gold:16766720},t.hexColors={white:"#ffffff",green:"#00ff00"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Explode=void 0;const i=s(1),a=s(19);class o extends a.Effect{constructor(e,t){super(e),this.bodySize=10,this.canDamage=!0,this.body=e.physics.add.image(t.pos.x,t.pos.y,t.sprite),this.params=t,this.startTime=e.gameTime;const s=i.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,1,this.bodySize);this.body.setCircle(this.bodySize,s.x,s.y),this.body.setScale(0),this.body.setOrigin(.5,.5),this.body.setDepth(115),this.body.setImmovable(!0),t.withDamage&&this.initCollisions()}initCollisions(){const{scene:e}=this;e.physics.add.collider(this.body,e.player.body,()=>{this.canDamage&&(e.player.hit(10,{type:"explode"}),this.canDamage=!1)})}act(){this.update()}update(){const{scene:e,startTime:t}=this,s=e.gameTime-t,i=Math.sin(s/150)*this.params.scaleCoef,a=i;this.body.angle+=3*e.deltaTime,this.body.setScale(a,a),this.body.setAlpha(i),i<.06&&s>100&&this.destroy()}}t.Explode=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBodyPosWithOffset=void 0;const i=s(3);t.getBodyPosWithOffset=(e,t,s,a,o={x:0,y:0})=>{const n=e/s/2-a+o.x,r=t/s/2-a+o.y;return new i.Vector(n,r)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDistanceBetweenPoints=t.getRandomInt=void 0;t.getRandomInt=(e,t)=>Math.round(e+Math.random()*(t-e));t.getDistanceBetweenPoints=(e,t)=>{const s=e.x-t.x,i=e.y-t.y;return Math.sqrt(s*s+i*i)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pluralize=void 0,t.pluralize=function(e,t,s){switch(function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}(e)){case 0:return(null==s?void 0:s.isGenetiveForm)?t[3]:t[0];case 1:return t[1];default:return t[2]}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceType=t.isMobileDevice=t.getCurrentOrientation=t.isLandscapeOrientation=void 0;const i=s(0);t.isLandscapeOrientation=()=>t.isMobileDevice()&&window.innerHeight<window.innerWidth;t.getCurrentOrientation=()=>t.isLandscapeOrientation()?"horizontal":"vertical";t.isMobileDevice=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t.getDeviceType=()=>t.isMobileDevice()?i.EDeviceType.mobile:i.EDeviceType.desktop},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EGoalTargetName=void 0,function(e){e.levelCompleted="levelCompleted",e.levelStart="levelStart",e.waitNextLevels="waitNextLevels"}(t.EGoalTargetName||(t.EGoalTargetName={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFullScreenMode=t.getFullWindowHeight=t.hideFullscreen=t.showFullscreen=t.hideOrientationWarning=t.showOrientationWarning=void 0;const i=s(5),a=document.querySelector(".screen-height-detector");t.showOrientationWarning=()=>{document.body.classList.add("portrait-orientation-warning")};t.hideOrientationWarning=()=>{document.body.classList.remove("portrait-orientation-warning")};t.showFullscreen=e=>{i.IS_DEV||t.isFullScreenMode()||(e.requestFullscreen?e.requestFullscreen({navigationUI:"hide"}):e.webkitRequestFullscreen?e.webkitRequestFullscreen({navigationUI:"hide"}):e.msRequestFullscreen&&e.msRequestFullscreen({navigationUI:"hide"}))};t.hideFullscreen=()=>{t.isFullScreenMode()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())};t.getFullWindowHeight=()=>{if(!a)throw new Error("root element for detecting height is null");return a.getBoundingClientRect().height};t.isFullScreenMode=()=>!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryParam=t.parseQuery=void 0;const i=s(5);t.parseQuery=e=>{const t={},s=("?"===e[0]?e.slice(1):e).split("&");for(let e=0;e<s.length;e++){const i=s[e].split("=");i[0]&&(t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||""))}return t};t.getQueryParam=(e,t,s=!1)=>!i.IS_DEV&&s&&"guardian"!==e.admin?null:e[t]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLevelNumberValid=void 0;const i=s(5);t.isLevelNumberValid=e=>!("number"!=typeof e||isNaN(e)||e<0||e>=i.mainConfig.totalLevelsCount)},function(e,t,s){"use strict";const i=a;function a(e,t){const s=o();return(a=function(e,t){return s[e-=421]})(e,t)}function o(){const e=["__esModule","toString","2344383OkqOgY","decryptValue","join","reverse","8IGVjqV","split","3455092SEOyDu","13175260ecVtbM","error","7BbNTny","Utf8","CRYPTO_TOKEN","AES","encrypt","3453687nvHkAf","968270YlkgmK","encryptValue","decrypt","2064966kNlxPb","1FEPBwP","default","defineProperty","2667645udCezd","getCryptoKey"];return(o=function(){return e})()}!function(e,t){const s=a,i=e();for(;;)try{if(449590===parseInt(s(439))/1*(-parseInt(s(435))/2)+-parseInt(s(446))/3+-parseInt(s(426))/4+parseInt(s(442))/5+-parseInt(s(438))/6*(-parseInt(s(429))/7)+-parseInt(s(424))/8*(-parseInt(s(434))/9)+parseInt(s(427))/10)break;i.push(i.shift())}catch(e){i.push(i.shift())}}(o),Object[i(441)](t,i(444),{value:!0}),t[i(421)]=t[i(436)]=t.getCryptoKey=void 0;const n=s(12).__importDefault(s(57)),r=s(5);t[i(443)]=()=>{const e=i;return r[e(431)][e(425)]("")[e(423)]()[e(422)]("")};t[i(436)]=e=>{const s=i;try{return n[s(440)][s(432)][s(433)](e,t[s(443)]())[s(445)]()}catch(e){console.error(e)}return null};t.decryptValue=e=>{const s=i;if(!e)return null;try{return n[s(440)].AES[s(437)](e,t[s(443)]())[s(445)](n[s(440)].enc[s(430)])}catch(e){console[s(428)](e)}return null}},,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomHexColor=void 0;t.getRandomHexColor=()=>{let e=65280,t=16711681;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLangExists=void 0;const i=s(5);t.isLangExists=e=>!!i.mainConfig.languages.includes(e)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textTemplate=void 0;t.textTemplate=(e,t)=>{const s=e.matchAll(/{(.+?)}/g);for(const i of s)e=e.replace(`{${i[1]}}`,t[i[1]]);return e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shuffleArray=t.flatten=t.chunk=void 0;t.chunk=(e,t)=>{const s=[];for(let i=0;i<e.length;i+=t)s.push(e.slice(i,i+t));return s};t.flatten=e=>{const t=[e],s=[];for(;t.length;){const e=t.pop();if(Array.isArray(e))for(;e.length;)t.push(e.pop());else s.push(e)}return s};t.shuffleArray=e=>{for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[s],e[s]=i}return e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excludeUndefinedValues=void 0;t.excludeUndefinedValues=e=>(Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),e)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEllipsisText=void 0;t.getEllipsisText=(e,t)=>e.length>t?e.slice(0,t)+"...":e},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendMetrikaGoal=void 0;const i=s(5),a=s(34);t.sendMetrikaGoal=(e,t)=>{i.IS_DEV?a.debugLog("metrika",{targetName:e,params:t}):window.ym(91179787,"reachGoal",e,t)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSeconds=void 0;const i=s(4);t.getSeconds=e=>i.SECOND*e},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fire=void 0;const i=s(30),a=s(19);class o extends a.Effect{constructor(e,t){super(e),this.speed=1.7,this.body=e.ui.drawImage({x:t.pos.x,y:t.pos.y,texture:"fire"}),this.params=t,this.body.setDepth(5),this.body.setAngle(i.angleToDegrees(t.angle)+90),this.startTime=e.gameTime,this.params=t}act(){this.update()}update(){const{scene:e,body:t,speed:s,startTime:i,params:a}=this,o=e.gameTime-i;t.alpha=1-o/150,t.x+=s*Math.cos(a.angle),t.y+=s*Math.sin(a.angle),t.alpha<=0&&this.destroy()}}t.Fire=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shadow=void 0;const i=s(19);class a extends i.Effect{constructor(e,t){super(e),this.params=t,this.body=e.ui.drawImage({x:t.pos.x,y:t.pos.y,texture:t.sprite}),this.body.setScale(t.scale),this.body.setAngle(t.angle),this.body.setAlpha(t.alpha),this.body.setDepth(0),this.destroyTime=t.lifeTime+e.gameTime}act(){this.update()}update(){const{scene:e,body:t,destroyTime:s,params:i}=this,{gameTime:a}=e,o=(s-a)*i.alpha/i.lifeTime;t.setAlpha(o),a>this.destroyTime&&this.destroy()}}t.Shadow=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bot=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);class r extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.bot,t.pos),this.reward=2,this.speed=1.5,this.rotateSpeed=2,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.shootInterval=1200,this.shootIntervalRange=200,this.bulletSpeed=7,this.hp=30,this.bodySize=32,this.depth=50,this.scale=.6,this.coinChance=.9,this.lastShootTime=0,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-bot-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=this.speed+Math.random();this.speed=o,this.rotateSpeed=o;const n=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,n.x,n.y)}act(e,t){this.update(e,t)}update(e,t){const{scene:s,lastShootTime:a}=this,o=s.gameTime;if(this.updateSafeArea(e,t),this.updateBase(e,t),o>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),o>a){const e=s.player.body;this.shoot(new i.Vector(e.x,e.y))}}updateBase(e,t){const{scene:s,body:i,angle:o,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=a.angleToRadians(o);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=a.getNearestAngle(o,n,r*h),this.body.angle=o-90}shoot(e){const{body:t,bulletSpeed:s,shootInterval:n,shootIntervalRange:r,weaponDamage:h}=this,l=a.getAngleBetweenPointsInRadians(e,new i.Vector(t.x,t.y));this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:o.EOwner.enemy,speed:s,angle:a.angleToDegrees(l),sprite:"laser-red",explodeSprite:"explode-red",damage:h}),this.lastShootTime=this.scene.gameTime+n+Math.random()*r}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Bot=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hunter=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);var r;!function(e){e.moving="moving",e.stop="stop",e.rotate="rotate",e.attack="attack"}(r||(r={}));class h extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.hunter,t.pos),this.weaponDamage=10,this.chanceToShoot=.25,this.lastShootTime=0,this.shootIntervalTime=1200,this.attackEndTime=0,this.attackIntervalTime=3e3,this.attackShootIntervalTime=325,this.attackSpreadRange=10,this.attackHunting=!0,this.lastChangeTargetTime=0,this.changeTargetTimeInterval=[1e3,2e3],this.rotateSpeed=2,this.currentRotateSpeed=this.rotateSpeed,this.rotateTimer=0,this.rotateIntervalTimer=3e3,this.maxSpeed=2,this.speed=2,this.speedIncrease=.05,this.stopEndTime=0,this.stopIntervalTime=3e3,this.stopIntervalRangeTime=1e3,this.coinChance=.9,this.bodySize=36,this.depth=50,this.scale=.7,this.hp=70,this.bulletSpeed=7,this.behavior=r.moving,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-hunter-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y),this.setStopEndTime(!0)}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:o,lastShootTime:n,chanceToShoot:h,behavior:l,speedIncrease:c,stopEndTime:d,attackHunting:u,attackIntervalTime:m}=this,p=s.player.body,g=s.gameTime;switch(this.updateSafeArea(g,t),this.updateBase(g,t),l){case r.moving:if(this.speed<this.maxSpeed&&(this.speed+=c*s.deltaTime),g>n){if(Math.random()>1-h){const e=a.getAngleBetweenPointsInDegrees(new i.Vector(p.x,p.y),new i.Vector(o.x,o.y));this.shoot(e)}this.lastShootTime=g+this.shootIntervalTime}g>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),g>d&&(this.behavior=r.stop);break;case r.stop:this.speed>0?this.speed-=c*s.deltaTime:this.setRotateBehavior();break;case r.rotate:this.setTargetAngle(new i.Vector(p.x,p.y)),g>n&&(this.shoot(this.angle,this.attackSpreadRange),this.lastShootTime=g+this.attackShootIntervalTime),a.getAngleDiff(this.targetAngle,this.angle)<=4?this.setAttackBehavior():g>this.rotateTimer&&this.setMovingBehavior();break;case r.attack:(u||g>this.attackEndTime-m/3)&&this.setTargetAngle(new i.Vector(p.x,p.y)),this.speed<this.maxSpeed&&(this.speed+=c*s.deltaTime),g>n&&(this.shoot(this.angle,this.attackSpreadRange),this.lastShootTime=g+this.attackShootIntervalTime),g>this.attackEndTime&&this.setMovingBehavior()}}updateBase(e,t){const{scene:s,body:i,angle:o,targetAngle:n,currentRotateSpeed:r}=this,{deltaTime:h}=s,l=a.angleToRadians(o);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=a.getNearestAngle(o,n,r*h),this.body.angle=o-90}setAttackBehavior(){const{scene:e,rotateSpeed:t}=this,s=e.gameTime;this.attackEndTime=s+this.attackIntervalTime,this.currentRotateSpeed=t,this.attackHunting=!0,this.behavior=r.attack}setStopEndTime(e=!1){const{scene:t,stopIntervalTime:s,stopIntervalRangeTime:i}=this,o=t.gameTime;this.stopEndTime=e?o+1e3+a.getRandomInt(0,s):o+s+a.getRandomInt(0,i)}setMovingBehavior(){const{scene:e,changeTargetTimeInterval:t,shootIntervalTime:s}=this,i=e.gameTime;this.setStopEndTime(),this.lastChangeTargetTime=i+t[0],this.lastShootTime=i+s,this.behavior=r.moving}setRotateBehavior(){const{scene:e,rotateIntervalTimer:t,rotateSpeed:s}=this,i=e.gameTime;this.speed=0,this.rotateTimer=i+t,this.currentRotateSpeed=s+1,this.behavior=r.rotate}shoot(e,t=0){const{body:s,bulletSpeed:n,weaponDamage:r}=this,h=a.spreadRadians(a.angleToRadians(e),t);this.scene.utils.createSphereBullet({pos:new i.Vector(s.x,s.y),owner:o.EOwner.enemy,speed:n,angle:a.angleToDegrees(h),sprite:"laser-red",explodeSprite:"explode-red",damage:r})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Hunter=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UFO=void 0;const i=s(3),a=s(1),o=s(4),n=s(0),r=s(10);var h;!function(e){e.moving="moving",e.stop="stop",e.attack="attack"}(h||(h={}));class l extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.ufo,t.pos),this.weaponDamage=10,this.chanceToShoot=.25,this.lastShootTime=0,this.shootIntervalTime=1200,this.attackEndTime=0,this.attackIntervalTime=1e3,this.lastChangeTargetTime=0,this.changeTargetTimeInterval=[1e3,2e3],this.rotateSpeed=.5,this.maxSpeed=1,this.speed=1,this.speedIncrease=.02,this.stopEndTime=0,this.stopIntervalTime=1500,this.stopIntervalRangeTime=2500,this.coinChance=.9,this.bodySize=36,this.depth=50,this.scale=.7,this.hp=70,this.bulletSpeed=7,this.behavior=h.moving,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-ufo"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y),this.setStopEndTime()}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:n,lastShootTime:r,shootIntervalTime:l,chanceToShoot:c,behavior:d,speedIncrease:u,stopEndTime:m}=this,p=s.player.body,g=s.gameTime;switch(this.updateSafeArea(g,t),this.updateBase(g,t),d){case h.moving:if(this.speed<this.maxSpeed&&(this.speed+=u*this.scene.deltaTime),g>r){if(Math.random()>1-c){const e=a.getAngleBetweenPointsInDegrees(new i.Vector(p.x,p.y),new i.Vector(n.x,n.y));this.shoot(e,!1)}this.lastShootTime=g+l}g>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),g>m&&!this.isOutsideSafeArea(o.enemySafeAreaPercentage.x,o.enemySafeAreaPercentage.y)&&(this.behavior=h.stop);break;case h.stop:this.speed>0?this.speed-=u*s.deltaTime:(this.attackEndTime=g+this.attackIntervalTime,this.behavior=h.attack);break;case h.attack:g>this.attackEndTime&&(this.makeCircleAttack(),this.setMovingBehavior())}}updateBase(e,t){const{scene:s,body:i,angle:o,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=a.angleToRadians(o);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=a.getNearestAngle(o,n,r*h),this.body.angle+=this.speed*h}setStopEndTime(){const{scene:e,stopIntervalTime:t,stopIntervalRangeTime:s}=this,i=e.gameTime;this.stopEndTime=i+t+a.getRandomInt(0,s)}setMovingBehavior(){const{scene:e,changeTargetTimeInterval:t,shootIntervalTime:s}=this,i=e.gameTime;this.setStopEndTime(),this.lastChangeTargetTime=i+t[0],this.lastShootTime=i+s,this.behavior=h.moving}makeCircleAttack(){const e=45*Math.random();for(let t=0;t<8;t++)this.shoot(e+45*t,!0)}shoot(e,t=!0){const{body:s,bulletSpeed:a,weaponDamage:o}=this;this.scene.utils.createSphereBullet({pos:new i.Vector(s.x,s.y),owner:n.EOwner.enemy,speed:a,angle:e,sprite:t?"sphere-bullet":"laser-red",explodeSprite:"explode-red",damage:o,scale:t?.35:1,bodySize:t?32:6})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),this.makeCircleAttack(),super.destroy()}}t.UFO=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Flyer=void 0;const i=s(3),a=s(1),o=s(18),n=s(0),r=s(10);class h extends r.Enemy{constructor(e,t){super(e,n.EEnemyName.flyer,t.pos),this.maxSpeed=4,this.minSpeed=1,this.speed=2,this.speedChange=.1,this.rotateSpeed=2,this.bulletSpeed=7,this.lastShootTime=0,this.shootTime=1200,this.shootTimeInterval=200,this.weaponDamage=10,this.lastShadowTime=0,this.shadowTime=50,this.hp=50,this.coinChance=.9,this.bodySize=32,this.depth=50,this.scale=.6,this.changeTargetTimeInterval=[0,0],this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-flyer"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y)}act(e,t){this.update(e,t)}update(e,t){this.updateSafeArea(e,t),this.updateBase(e,t),this.updateMovement(e,t),this.updateAttack(e,t),this.updateShadows()}updateBase(e,t){const{scene:s,body:i,angle:o,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=a.angleToRadians(o);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=a.getNearestAngle(o,n,r*h),this.body.angle=o-90}updateMovement(e,t){const{speedChange:s,angle:i,targetAngle:o}=this;a.getAngleDiff(i,o)<3?this.speed<this.maxSpeed&&(this.speed+=s*this.scene.deltaTime):this.speed>this.minSpeed&&(this.speed-=s*this.scene.deltaTime)}updateAttack(e,t){const{scene:s,body:o,shootTime:n,shootTimeInterval:r}=this,h=s.gameTime;if(h>this.lastShootTime){const e=s.player.body,t=new i.Vector(e.x,e.y),l=a.getAngleBetweenPointsInDegrees(t,new i.Vector(o.x,o.y));if(Math.random()>.1){const e=a.angleToDegrees(.25+.3*Math.random());this.shoot(l+e),this.shoot(l-e)}else this.shoot(l);this.lastShootTime=h+n+Math.random()*r}}updateShadows(){const{scene:e,lastShadowTime:t,shadowTime:s}=this,i=e.gameTime;i>t&&(this.lastShadowTime=i+s,this.createShadow())}createShadow(){const{scene:e,body:t,scale:s,angle:a}=this,n=.25*Math.max(this.maxSpeed-this.speed,0);e.effects.push(new o.Shadow(e,{pos:new i.Vector(t.x,t.y),sprite:"enemy-flyer",lifeTime:250,scale:s,angle:a-90,alpha:.4-n}))}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:a}=this;this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:n.EOwner.enemy,speed:s,angle:e,sprite:"laser-red",explodeSprite:"explode-red",damage:a})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Flyer=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Destroyer=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);class r extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.destroyer,t.pos),this.mainState="move",this.states={move:{active:!0,timeToStop:this.getTimeToStop(),methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},stop:{active:!1,methods:{activate:this.activateStopState.bind(this),deactivate:this.deactivateStopState.bind(this),update:this.updateStopState.bind(this)}},reload:{active:!1,timeToShot:30,methods:{activate:this.activateReloadState.bind(this),deactivate:this.deactivateReloadState.bind(this),update:this.updateReloadState.bind(this)}},rotateAndShot:{active:!1,shots:0,methods:{activate:this.activateRotateAndShotState.bind(this),deactivate:this.deactivateRotateAndShotState.bind(this),update:this.updateRotateAndShotState.bind(this)}}},this.maxSpeed=1.5,this.speed=this.maxSpeed,this.changeSpeed=.01,this.rotateSpeed=1.5,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.bulletSpeed=7,this.hp=90,this.bodySize=32,this.depth=50,this.scale=.75,this.coinChance=.9,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-destroyer-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y)}act(e,t){this.updateMainState(e,t),this.updateStates(e,t)}updateMainState(e,t){const{mainState:s}=this;switch(s){case"move":this.states.move.timeToStop<=0&&this.setStopState();break;case"stop":this.speed<=0&&this.setReloadState();break;case"reload":this.states.reload.timeToShot<=0&&this.setRotateAndShotState();break;case"rotateAndShot":this.angle===this.targetAngle&&(this.states.rotateAndShot.shots+=1,this.shoot(this.angle),this.states.rotateAndShot.shots>=10?(this.states.rotateAndShot.shots=0,this.setMoveState()):this.setReloadState())}}setMoveState(){this.mainState="move",this.deactivateAllStates(),this.activateMoveState()}setStopState(){this.mainState="stop",this.deactivateMoveState(),this.activateStopState()}setReloadState(){this.mainState="reload",this.deactivateStopState(),this.deactivateRotateAndShotState(),this.activateReloadState()}setRotateAndShotState(){this.mainState="rotateAndShot",this.deactivateReloadState(),this.activateRotateAndShotState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveState(){this.states.move.active=!0,this.states.move.timeToStop=this.getTimeToStop(),this.lastChangeTargetTime=this.scene.gameTime+this.changeTargetTimeInterval[0],this.targetAngle=this.angle}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s}=this,i=s.gameTime;this.states.move.timeToStop-=this.scene.deltaTime,this.updateSafeArea(e,t),this.updateBase(e,t),this.updateSpeed(),this.updateAngle(e,t),i>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval()}activateStopState(){this.states.stop.active=!0}deactivateStopState(){this.states.stop.active=!1}updateStopState(e,t){this.updateBase(e,t),this.speed>0&&(this.speed=Math.max(this.speed-this.changeSpeed*this.scene.deltaTime,0))}activateReloadState(){this.states.reload.active=!0,this.states.reload.timeToShot=30}deactivateReloadState(){this.states.reload.active=!1}updateReloadState(e,t){this.states.reload.timeToShot-=this.scene.deltaTime}activateRotateAndShotState(){const{scene:e}=this,t=e.player.body;this.states.rotateAndShot.active=!0,this.setTargetAngle(new i.Vector(t.x,t.y))}deactivateRotateAndShotState(){this.states.rotateAndShot.active=!1}updateRotateAndShotState(e,t){this.updateAngle(e,t)}updateBase(e,t){const{scene:s,body:i,angle:o}=this,{deltaTime:n}=s,r=a.angleToRadians(o);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateSpeed(){this.speed<this.maxSpeed&&(this.speed=Math.min(this.speed+this.changeSpeed*this.scene.deltaTime,this.maxSpeed))}updateAngle(e,t){const{scene:s,angle:i,targetAngle:o,rotateSpeed:n}=this;this.angle=a.getNearestAngle(i,o,n*s.deltaTime),this.body.angle=i-90}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:n}=this;[1,-1].forEach(r=>{const h=a.angleToRadians(e+40*r),l=a.getOffsetByRadians(h,40);this.scene.utils.createSphereBullet({pos:new i.Vector(t.x+l.x,t.y+l.y),owner:o.EOwner.enemy,speed:s,angle:e,sprite:"laser-red",explodeSprite:"explode-red",damage:n})})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}getTimeToStop(){return 50+150*Math.random()}}t.Destroyer=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stealth=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);class r extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.stealth,t.pos),this.mainState="moveToPlayer",this.states={moveToPlayer:{active:!0,time:300,methods:{activate:this.activateMoveToPlayerState.bind(this),deactivate:this.deactivateMoveToPlayerState.bind(this),update:this.updateMoveToPlayerState.bind(this)}},moveToPlayerArea:{active:!1,time:300,methods:{activate:this.activateMoveToPlayerAreaState.bind(this),deactivate:this.deactivateMoveToPlayerAreaState.bind(this),update:this.updateMoveToPlayerAreaState.bind(this)}},visibility:{active:!0,time:0,methods:{activate:this.activateVisibilityState.bind(this),deactivate:this.deactivateVisibilityState.bind(this),update:this.updateVisibilityState.bind(this)}},shooting:{active:!1,reload:0,methods:{activate:this.activateShootingState.bind(this),deactivate:this.deactivateShootingState.bind(this),update:this.updateShootingState.bind(this)}}},this.maxSpeed=2.7,this.speed=this.maxSpeed,this.rotateSpeed=1.8,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.bulletSpeed=7,this.hp=50,this.bodySize=32,this.depth=50,this.scale=.6,this.coinChance=.9,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-stealth-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t),s.setAlpha(0);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y)}act(e,t){this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),this.updateMainState(e,t),this.updateStates(e,t)}updateMainState(e,t){const{mainState:s,scene:o}=this,n=o.player.body;if(this.states.shooting.reload<=0){a.getDistanceBetweenPoints(new i.Vector(n.x,n.y),new i.Vector(this.body.x,this.body.y))<250?(this.activateShootingState(),this.deactivateVisibilityState()):this.states.shooting.active&&(this.deactivateShootingState(),this.activateVisibilityState())}switch(s){case"moveToPlayer":this.states.moveToPlayer.time<=0&&this.setMoveToPlayerAreaState();break;case"moveToPlayerArea":this.states.moveToPlayerArea.time<=0&&this.setMoveToPlayerState()}}setMoveToPlayerState(){this.mainState="moveToPlayer",this.deactivateMoveToPlayerAreaState(),this.activateMoveToPlayerState()}setMoveToPlayerAreaState(){this.mainState="moveToPlayerArea",this.deactivateMoveToPlayerState(),this.activateMoveToPlayerAreaState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveToPlayerState(){this.states.moveToPlayer.active=!0,this.states.moveToPlayer.time=300}deactivateMoveToPlayerState(){this.states.moveToPlayer.active=!1}updateMoveToPlayerState(e,t){const s=this.scene.player.body;this.states.moveToPlayer.time-=this.scene.deltaTime,this.setTargetAngle(new i.Vector(s.x,s.y))}activateMoveToPlayerAreaState(){const e=this.scene.player.body,t=a.getOffsetByAngle(360*Math.random(),100);this.setTargetAngle(new i.Vector(e.x+t.x,e.y+t.y)),this.states.moveToPlayerArea.active=!0,this.states.moveToPlayerArea.time=300}deactivateMoveToPlayerAreaState(){this.states.moveToPlayerArea.active=!1}updateMoveToPlayerAreaState(){this.states.moveToPlayerArea.time-=this.scene.deltaTime}activateVisibilityState(){this.states.visibility.active=!0,this.states.visibility.time=0}deactivateVisibilityState(){this.states.visibility.active=!1}updateVisibilityState(){const{scene:e}=this;this.states.visibility.time+=this.scene.deltaTime,this.states.visibility.time>300?this.body.setAlpha(Math.min(this.body.alpha+=.005*e.deltaTime,.25)):this.body.setAlpha(Math.max(this.body.alpha-=.005*e.deltaTime,0)),this.states.visibility.time>360&&(this.states.visibility.time=0)}activateShootingState(){this.states.shooting.active=!0}deactivateShootingState(){this.states.shooting.active=!1}updateShootingState(){const{scene:e}=this,t=this.scene.player.body;if(this.body.setAlpha(Math.min(this.body.alpha+=.005*e.deltaTime,.25)),this.states.shooting.reload>0)this.states.shooting.reload-=e.deltaTime;else{const e=new i.Vector(t.x,t.y),s=new i.Vector(this.body.x,this.body.y);this.shoot(a.getAngleBetweenPointsInDegrees(e,s)),this.states.shooting.reload=40}}updateBase(e,t){const{scene:s,body:i,angle:o}=this,{deltaTime:n}=s,r=a.angleToRadians(o);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateAngle(e,t){const{scene:s,angle:i,targetAngle:o,rotateSpeed:n}=this;this.angle=a.getNearestAngle(i,o,n*s.deltaTime),this.body.angle=i-90}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:a}=this;this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:o.EOwner.enemy,speed:s,angle:e,sprite:"laser-red",explodeSprite:"explode-red",damage:a})}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.Stealth=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissileCarrier=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);class r extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.missileCarrier,t.pos),this.mainState="move",this.mainStateTime=0,this.states={move:{active:!0,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},moveToPlayer:{active:!1,shots:0,reload:0,methods:{activate:this.activateMoveToPlayerState.bind(this),deactivate:this.deactivateMoveToPlayerState.bind(this),update:this.updateMoveToPlayerState.bind(this)}}},this.maxSpeed=1.5,this.speed=this.maxSpeed,this.rotateSpeed=2,this.weaponDamage=10,this.hp=80,this.bodySize=32,this.depth=50,this.scale=.75,this.coinChance=.9,this.changeTargetTimeInterval=[1e3,2e3],this.nextBulletDir=1,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-missile-carrier-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y)}act(e,t){this.updateMainState(e,t),this.updateStates(e,t)}updateMainState(e,t){const{mainState:s}=this;switch(this.mainStateTime+=this.scene.deltaTime,s){case"move":this.mainStateTime>175&&this.setMoveToPlayerState();break;case"moveToPlayer":this.states.moveToPlayer.shots>=2&&this.setMoveState()}}setMoveState(){const{scene:e}=this;this.mainState="move",this.mainStateTime=0;const t=Math.random()*this.changeTargetTimeInterval[1];this.lastChangeTargetTime=e.gameTime+t,this.deactivateAllStates(),this.activateMoveState()}setMoveToPlayerState(){this.mainState="moveToPlayer",this.mainStateTime=0,this.states.moveToPlayer.shots=0,this.deactivateAllStates(),this.activateMoveToPlayerState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveState(){this.states.move.active=!0}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s}=this,i=s.gameTime;this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),i>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval()}activateMoveToPlayerState(){this.states.moveToPlayer.active=!0}deactivateMoveToPlayerState(){this.states.moveToPlayer.active=!1}updateMoveToPlayerState(e,t){const{scene:s}=this,o=s.player.body;this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),this.setTargetAngle(new i.Vector(o.x,o.y));const n=a.getAngleDiff(this.targetAngle,this.angle);this.states.moveToPlayer.reload>0&&(this.states.moveToPlayer.reload-=s.deltaTime),n<10&&this.states.moveToPlayer.reload<=0&&(this.states.moveToPlayer.shots+=1,this.states.moveToPlayer.reload=60,this.shoot(this.angle))}updateBase(e,t){const{scene:s,body:i,angle:o}=this,{deltaTime:n}=s,r=a.angleToRadians(o);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateAngle(e,t){const{angle:s,targetAngle:i,rotateSpeed:o}=this,n=(this.states.moveToPlayer.active?1.25*o:o)*this.scene.deltaTime;this.angle=a.getNearestAngle(s,i,n),this.body.angle=s-90}shoot(e){const{body:t,weaponDamage:s}=this,n=this.nextBulletDir,r=a.angleToRadians(e+40*n),h=a.getOffsetByRadians(r,40);this.scene.utils.createRocketBullet({pos:new i.Vector(t.x+h.x,t.y+h.y),owner:o.EOwner.enemy,angle:e,sprite:"rocket-bullet",explodeSprite:"explode-red",damage:s}),this.nextBulletDir=0-this.nextBulletDir}onOutOfSafeArea(e){this.setTargetAngle(e)}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.MissileCarrier=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaserShip=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);class r extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.laserShip,t.pos),this.mainState="move",this.mainStateTime=0,this.states={move:{active:!0,stop:!1,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},rotate:{active:!1,methods:{activate:this.activateRotateState.bind(this),deactivate:this.deactivateRotateState.bind(this),update:this.updateRotateState.bind(this)}},shoot:{active:!1,isLaserActive:!1,shots:0,methods:{activate:this.activateShootState.bind(this),deactivate:this.deactivateShootState.bind(this),update:this.updateShootState.bind(this)}}},this.maxSpeed=2,this.speed=this.maxSpeed,this.changeSpeed=.03,this.rotateSpeed=2,this.weaponDamage=20,this.hp=80,this.bodySize=32,this.depth=50,this.scale=.65,this.coinChance=.9,this.changeTargetTimeInterval=[1e3,2e3],this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-laser-ship"),this.onLaserEnds=this.onLaserEnds.bind(this),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,o.x,o.y)}act(e,t){this.updateMainState(e,t),this.updateStates(e,t)}updateMainState(e,t){const{mainState:s}=this;switch(this.mainStateTime+=this.scene.deltaTime,s){case"move":this.mainStateTime>150&&(this.states.move.stop=!0),this.speed<=0&&this.setRotateState();break;case"rotate":a.getAngleDiff(this.targetAngle,this.angle)<=0&&this.setShootState();break;case"shoot":this.states.shoot.isLaserActive||(this.states.shoot.shots+=1,this.states.shoot.shots>=3?(this.states.shoot.shots=0,this.setMoveState()):this.setRotateState())}}setMoveState(){const{scene:e}=this;this.mainState="move",this.mainStateTime=0;const t=Math.random()*this.changeTargetTimeInterval[1];this.lastChangeTargetTime=e.gameTime+t,this.deactivateAllStates(),this.activateMoveState()}setRotateState(){this.mainState="rotate",this.deactivateAllStates(),this.activateRotateState()}setShootState(){this.mainState="shoot",this.deactivateAllStates(),this.activateShootState()}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{this.states[e].methods.deactivate()})}activateMoveState(){this.states.move.active=!0,this.states.move.stop=!1}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s}=this,i=s.gameTime,a=this.states.move;this.updateSafeArea(e,t),this.updateBase(e,t),this.updateAngle(e,t),a.stop?this.speed=Math.max(this.speed-this.changeSpeed*s.deltaTime,0):(this.speed=Math.min(this.speed+this.changeSpeed*s.deltaTime,this.maxSpeed),i>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval())}activateRotateState(){this.states.rotate.active=!0}deactivateRotateState(){this.states.rotate.active=!1}updateRotateState(e,t){const{scene:s}=this,a=s.player.body;this.setTargetAngle(new i.Vector(a.x,a.y)),this.updateAngle(e,t)}activateShootState(){this.states.shoot.active=!0,this.states.shoot.isLaserActive=!0,this.shoot()}deactivateShootState(){this.states.shoot.active=!1}updateShootState(e,t){}updateBase(e,t){const{scene:s,body:i,angle:o}=this,{deltaTime:n}=s,r=a.angleToRadians(o);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateAngle(e,t){const{angle:s,targetAngle:i,rotateSpeed:o}=this,n=(this.states.rotate.active?1.5*o:o)*this.scene.deltaTime;this.angle=a.getNearestAngle(s,i,n),this.body.angle=s-90}shoot(){const{body:e,angle:t,weaponDamage:s}=this,n=a.getOffsetByAngle(t,40*this.scale);this.scene.utils.createRayBullet({pos:new i.Vector(e.x+n.x,e.y+n.y),owner:o.EOwner.enemy,angle:t,sprite:"ray-bullet-red",explodeSprite:"explode-red",damage:s,delay:30,onDestroy:this.onLaserEnds,isLaserActive:()=>this.hp>0})}onOutOfSafeArea(e){this.setTargetAngle(e)}onLaserEnds(){this.states.shoot.isLaserActive=!1}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),super.destroy()}}t.LaserShip=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Defender=void 0;const i=s(3),a=s(1),o=s(0),n=s(10);class r extends n.Enemy{constructor(e,t){super(e,o.EEnemyName.defender,t.pos),this.speed=1.5,this.rotateSpeed=2,this.changeTargetTimeInterval=[1e3,2e3],this.weaponDamage=10,this.shots=3,this.bulletSpeed=7,this.hp=50,this.bodySize=32,this.depth=50,this.scale=.6,this.coinChance=.9,this.lastShootTime=0,this.shieldBodySize=80,this.isShieldActive=!1,this.shieldTime=0,this.body=e.physics.add.image(t.pos.x,t.pos.y,"enemy-defender-ship"),this.init(),this.setRandomTargetAngle()}init(){const{scale:e,depth:t,body:s,bodySize:i}=this;s.setScale(e),s.setImmovable(!0),s.setDepth(t);const o=this.speed+Math.random();this.speed=o,this.rotateSpeed=o;const n=a.getBodyPosWithOffset(s.displayWidth,s.displayHeight,e,i);s.setCircle(i,n.x,n.y),this.initShield()}initShield(){this.shieldBody=this.scene.physics.add.image(this.body.x,this.body.y,"shield"),this.shieldBody.setImmovable(!0)}act(e,t){this.update(e,t)}update(e,t){const{scene:s,lastShootTime:a}=this,o=s.gameTime;if(this.updateSafeArea(e,t),this.updateBase(e,t),this.updateShield(),o>this.lastChangeTargetTime&&this.setRandomTargetAngleWithInterval(),o>a){const e=s.player.body;this.shoot(new i.Vector(e.x,e.y))}}updateBase(e,t){const{scene:s,body:i,angle:o,targetAngle:n,rotateSpeed:r}=this,{deltaTime:h}=s,l=a.angleToRadians(o);i.x+=this.speed*Math.cos(l)*h,i.y+=this.speed*Math.sin(l)*h,this.angle=a.getNearestAngle(o,n,r*h),this.body.angle=o-90}updateShield(){const{scene:e,shieldBodySize:t}=this;this.shieldBody.x=this.body.x,this.shieldBody.y=this.body.y,this.shieldBody.angle=this.body.angle+180;const s=a.getOffsetByRadians(a.angleToRadians(this.angle)+Math.PI,25),i=a.getBodyPosWithOffset(this.shieldBody.displayWidth,this.shieldBody.displayHeight,1,t,s);if(this.shieldBody.setCircle(t,i.x,i.y),this.shieldBody.visible=this.isShieldActive,e.gameTime>this.shieldTime){const e=this.isShieldActive?1500:5e3;this.shieldTime=this.scene.gameTime+e,this.isShieldActive=!this.isShieldActive}}shoot(e){const{body:t,bulletSpeed:s,weaponDamage:n}=this,r=a.spreadAngle(a.getAngleBetweenPointsInDegrees(e,new i.Vector(t.x,t.y)),20);this.scene.utils.createSphereBullet({pos:new i.Vector(t.x,t.y),owner:o.EOwner.enemy,speed:s,angle:r,sprite:"laser-red",explodeSprite:"explode-red",damage:n}),this.shots-=1;const h=this.shots<=0?1200:200;this.shots<=0&&(this.shots=3),this.lastShootTime=this.scene.gameTime+h+Math.random()}onOutOfSafeArea(e){this.setTargetAngle(e)}hitShield(e){if(!this.isShieldActive)return;const t=new i.Vector(e.body.x,e.body.y),s=new i.Vector(this.body.x,this.body.y),o=a.getDistanceBetweenPoints(t,s),n=a.getAngleDiff(this.angle,e.getAngle());o>50&&o<70&&n>45&&e.explode()}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),this.shieldBody.destroy(),super.destroy()}}t.Defender=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnemiesArray=t.repeatEnemy=void 0;t.repeatEnemy=(e,t)=>new Array(t).fill(e);t.getEnemiesArray=(...e)=>e.reduce((e,s)=>Array.isArray(s)?[...e,...t.repeatEnemy(s[0],s[1])]:[...e,s],[])},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss2=t.Boss1=t.Boss=void 0;var i=s(25);Object.defineProperty(t,"Boss",{enumerable:!0,get:function(){return i.Boss}});var a=s(105);Object.defineProperty(t,"Boss1",{enumerable:!0,get:function(){return a.Boss1}});var o=s(106);Object.defineProperty(t,"Boss2",{enumerable:!0,get:function(){return o.Boss2}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss1=void 0;const i=s(26),a=s(1),o=s(3),n=s(0),r=s(4),h=s(25),l=a.getDeviceType(),c=i.bossesConfig.bosses.ghost.paramsByDevice;class d extends h.Boss{constructor(e){super(e,n.EBossName.ghost),this.maxHp=0,this.hp=0,this.rewardedScore=0,this.scale=.5,this.alpha=1,this.bodySize=175,this.maxSpeed=2.2,this.speed=this.maxSpeed,this.changeSpeed=.02,this.rotateSpeed=1.25,this.moveAngle=0,this.maxEnergy=1e3,this.energy=this.maxEnergy,this.bulletDamage=10,this.mainState="init",this.mainStateTime=0,this.states={move:{active:!0,stopNearTarget:!0,targetPoint:this.scene.utils.getRandomPos(30,30),isNearTarget:!1,timeoutTime:0,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},focusOnPlayer:{active:!0,methods:{activate:this.activateFocusOnPlayerState.bind(this),deactivate:this.deactivateFocusOnPlayerState.bind(this),update:this.updateFocusOnPlayerState.bind(this)}},circleAttack:{active:!1,bulletsOrder:[],nextBulletTime:0,reloadTime:50,methods:{activate:this.activateCircleAttackState.bind(this),deactivate:this.deactivateCircleAttackState.bind(this),update:this.updateCircleAttackState.bind(this)}},laserAttack:{active:!1,bullets:0,nextBulletTime:0,reloadTime:c.laserAttackReloadTime[l],methods:{activate:this.activateLaserAttackState.bind(this),deactivate:this.deactivateLaserAttackState.bind(this),update:this.updateLaserAttackState.bind(this)}},laserDoubleAttack:{active:!1,bullets:0,sideIndex:1,nextBulletTime:0,reloadTime:c.laserDoubleAttackReloadTime[l],methods:{activate:this.activateLaserDoubleAttackState.bind(this),deactivate:this.deactivateLaserDoubleAttackState.bind(this),update:this.updateLaserDoubleAttackState.bind(this)}},splashAttack:{active:!1,shots:0,nextShotTime:0,reloadTime:c.splashAttackReloadTime[l],methods:{activate:this.activateSplashAttackState.bind(this),deactivate:this.deactivateSplashAttackState.bind(this),update:this.updateSplashAttackState.bind(this)}},explodeAttack:{active:!1,bullets:0,nextBulletTime:0,reloadTime:c.explodeAttackReloadTime[l],methods:{activate:this.activateExplodeAttackState.bind(this),deactivate:this.deactivateExplodeAttackState.bind(this),update:this.updateExplodeAttackState.bind(this)}},visibility:{active:!1,isVisible:!0,nextChangeTime:0,reloadTime:5e3,methods:{activate:this.activateVisibilityState.bind(this),deactivate:this.deactivateVisibilityState.bind(this),update:this.updateVisibilityState.bind(this)}},bombs:{active:!1,bombs:0,nextBombTime:0,reloadTime:2e3,methods:{activate:this.activateBombsState.bind(this),deactivate:this.deactivateBombsState.bind(this),update:this.updateBombsState.bind(this)}},centerAttack:{active:!1,shots:0,nextShotTime:0,lastOffset:0,reloadTime:700,methods:{activate:this.activateCenterAttackState.bind(this),deactivate:this.deactivateCenterAttackState.bind(this),update:this.updateCenterAttackState.bind(this)}}},this.setPropertiesFromConfig();const t=this.scene.utils.getRandomPointOutside({distance:200}),s=this.scene.getGameCenter();this.body=e.physics.add.image(t.x,t.y,"boss-1-ship"),this.moveAngle=a.getAngleBetweenPointsInDegrees(new o.Vector(s.x,s.y),t),this.angle=this.moveAngle,this.body.setImmovable(!0),this.body.setScale(this.scale),this.body.setDepth(r.depths.boss),this.centerBody(),this.initCollisions(),this.activateVisibilityState()}centerBody(){const{scale:e,bodySize:t}=this,s=a.getOffsetByAngle(this.angle,0),i=a.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t,s);this.body.setCircle(t,i.x,i.y)}act(e,t){const{angle:s}=this;this.body.active&&(this.updateMainState(),this.updateStates(),this.body.setAlpha(this.alpha),this.body.angle=s+90)}updateMainState(){const{mainState:e}=this,{isNearTarget:t}=this.states.move;switch(this.mainStateTime+=this.scene.deltaTime,e){case"init":this.mainStateTime>200&&this.setAttackState();break;case"attack":t?(this.activateCircleAttackState(),this.activateMoveState(),this.activateLaserAttackState()):this.energy<200?this.setMoveToCenterState():this.isAttackExisted()||this.setRandomAttack();break;case"moveToCenter":t&&this.setCenterAttackState();break;case"centerAttack":this.isAttackExisted()||this.setAttackState()}}setAttackState(){this.deactivateAllStates(),this.activateLaserAttackState(),this.activateMoveState(),this.activateFocusOnPlayerState(),this.energy=Math.max(this.energy+Math.random()*this.maxEnergy,this.maxEnergy),this.mainState="attack"}setMoveToCenterState(){const e=this.scene.getGameCenter();this.deactivateAllStates(),this.activateFocusOnPlayerState(),this.activateMoveState({targetPos:new o.Vector(e.x,e.y),noStopNearTarget:!0}),this.activateBombsState(),this.mainState="moveToCenter"}setCenterAttackState(){this.deactivateAllStates(),this.activateCenterAttackState(),this.activateFocusOnPlayerState(),this.speed=0,this.mainState="centerAttack"}updateStates(){Object.keys(this.states).forEach(e=>{this.states[e].active&&this.states[e].methods.update()})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{"visibility"!==e&&this.states[e].methods.deactivate()})}activateMoveState(e={}){var t;const s=this.states.move,i=null!==(t=e.targetPos)&&void 0!==t?t:this.scene.utils.getRandomPos(15,15);s.active=!0,s.targetPoint=i,s.timeoutTime=0,e.noStopNearTarget?s.stopNearTarget=!1:s.stopNearTarget=!0}deactivateMoveState(){this.states.move.active=!1,this.states.move.timeoutTime=0}activateFocusOnPlayerState(){this.states.focusOnPlayer.active=!0}deactivateFocusOnPlayerState(){this.states.focusOnPlayer.active=!1}activateCircleAttackState(){const e=[];for(let t=0;t<c.circleAttackBulletsCount[l];t++)e.push(t+1);const t=a.shuffleArray(e);this.states.circleAttack.active=!0,this.states.circleAttack.bulletsOrder=t}deactivateCircleAttackState(){this.states.circleAttack.active=!1,this.states.circleAttack.bulletsOrder=[]}activateLaserAttackState(){this.states.laserAttack.active=!0,this.states.laserAttack.bullets=6}deactivateLaserAttackState(){this.states.laserAttack.active=!1,this.states.laserAttack.bullets=0}activateLaserDoubleAttackState(){this.states.laserDoubleAttack.active=!0,this.states.laserDoubleAttack.bullets=12,this.energy-=100}deactivateLaserDoubleAttackState(){this.states.laserDoubleAttack.active=!1,this.states.laserDoubleAttack.bullets=0}activateSplashAttackState(){this.states.splashAttack.active=!0,this.states.splashAttack.shots=3,this.energy-=100}deactivateSplashAttackState(){this.states.splashAttack.active=!1,this.states.splashAttack.shots=0}activateExplodeAttackState(){this.states.explodeAttack.active=!0,this.states.explodeAttack.bullets=5,this.energy-=100}deactivateExplodeAttackState(){this.states.explodeAttack.active=!1,this.states.explodeAttack.bullets=0}activateVisibilityState(){const{scene:e,states:t}=this;t.visibility.active=!0,t.visibility.nextChangeTime=e.gameTime+t.visibility.reloadTime}deactivateVisibilityState(){this.states.visibility.active=!1}activateBombsState(){this.states.bombs.active=!0,this.states.bombs.bombs=c.bombsCount[l]}deactivateBombsState(){this.states.bombs.active=!1,this.states.bombs.bombs=0}activateCenterAttackState(){this.states.centerAttack.active=!0,this.states.centerAttack.shots=5}deactivateCenterAttackState(){this.states.centerAttack.active=!1,this.states.centerAttack.shots=0}updateMoveState(){const{scene:e,body:t,moveAngle:s,rotateSpeed:i}=this,{deltaTime:n}=e,r=this.states.move,{targetPoint:h}=r,l=new o.Vector(t.x,t.y),c=new o.Vector(h.x,h.y),d=a.getAngleBetweenPointsInDegrees(c,l),u=a.angleToRadians(s);t.x+=this.speed*Math.cos(u)*n,t.y+=this.speed*Math.sin(u)*n;const m=a.getDistanceBetweenPoints(l,c);if(this.moveAngle=a.getNearestAngle(s,d,i*e.deltaTime),r.isNearTarget=m<15,m<150&&(r.timeoutTime<120?r.timeoutTime+=e.deltaTime:r.isNearTarget=!0),this.states.move.stopNearTarget)if(m<200){Math.max(m/(200/this.maxSpeed))>this.speed?this.speed=Math.min(this.changeSpeed*e.deltaTime+this.speed,this.maxSpeed):this.speed=Math.max(this.speed-this.changeSpeed*e.deltaTime,.5)}else this.speed=Math.min(this.changeSpeed*e.deltaTime+this.speed,this.maxSpeed);else this.speed=Math.min(this.changeSpeed*e.deltaTime+this.speed,this.maxSpeed)}updateFocusOnPlayerState(){const{scene:e,body:t,angle:s,rotateSpeed:i}=this,n=e.utils.getAngleToPlayer(new o.Vector(t.x,t.y));this.angle=a.getNearestAngle(s,n,i*e.deltaTime)}updateCircleAttackState(){const{scene:e,body:t}=this,s=this.states.circleAttack;if(e.gameTime<s.nextBulletTime)return;const i=s.bulletsOrder.shift();if(i){const n=new o.Vector(t.x,t.y),r=360/c.circleAttackBulletsCount[l]*i,h=a.getOffsetByAngle(r,150),d=new o.Vector(n.x+h.x,n.y+h.y);this.shootBullet({bulletPos:d,speed:0,angle:0,sprite:"sphere-bullet-blue",explodeSprite:"explode-blue",explodeScale:1.35,scale:.15,bodySize:32,states:[{name:"changeSize",time:50,scaleFn:t=>t+.01*e.deltaTime},{name:"changeAngle",angleFn:()=>{const t=e.utils.getAngleToPlayer(d);return a.spreadAngle(t,20)}},{name:"changeSpeed",time:0,speedFn:()=>2+Math.random()}]}),s.nextBulletTime=e.gameTime+s.reloadTime}else this.deactivateCircleAttackState()}updateLaserAttackState(){const{scene:e,body:t}=this,s=this.states.laserAttack;if(s.bullets<=0)this.deactivateLaserAttackState();else if(e.gameTime>s.nextBulletTime){const i=new o.Vector(t.x,t.y);this.shootBullet({bulletPos:i,angle:this.scene.utils.getAngleToPlayer(new o.Vector(t.x,t.y)),speed:3,sprite:"laser-red"}),s.nextBulletTime=e.gameTime+s.reloadTime,s.bullets-=1}}updateLaserDoubleAttackState(){const{scene:e,body:t}=this,s=this.states.laserDoubleAttack;if(s.bullets<=0)this.deactivateLaserDoubleAttackState();else if(e.gameTime>s.nextBulletTime){const i=this.angle+110*s.sideIndex,a=this.getAttackPos(i);this.shootBullet({bulletPos:a,angle:this.scene.utils.getAngleToPlayer(new o.Vector(t.x,t.y)),speed:5,sprite:"laser-aqua",explodeSprite:"explode-aqua"}),s.nextBulletTime=e.gameTime+s.reloadTime,s.bullets-=1,s.sideIndex=0-s.sideIndex}}updateSplashAttackState(){const{scene:e}=this,t=this.states.splashAttack;if(t.shots<=0)this.deactivateSplashAttackState();else if(e.gameTime>t.nextShotTime){const s=9,i=c.splashAttackBulletsOffset[l],a=Math.random()*i;for(let e=0;e<s;e++){const t=a+this.angle+e*i-Math.floor(s/2)*i,o=this.getAttackPos(t);this.shootBullet({bodySize:25,bulletPos:o,angle:t,speed:4,sprite:"sphere-bullet-purple",explodeSprite:"explode-purple",scale:.25})}t.nextShotTime=e.gameTime+t.reloadTime,t.shots-=1}}updateExplodeAttackState(){const{scene:e,body:t}=this,s=this.states.explodeAttack;if(s.bullets<=0)this.deactivateExplodeAttackState();else if(e.gameTime>s.nextBulletTime){const i={bodySize:32,bulletPos:new o.Vector(t.x,t.y),angle:this.angle,speed:5,sprite:"sphere-bullet",scale:.1},a=c.explodeBulletSpeedTime[l]+Math.random()*c.explodeBulletSpeedTime[l];this.shootBullet(Object.assign(Object.assign({},i),{states:[{name:"changeSize",time:60,scaleFn:t=>t+.007*e.deltaTime},{name:"changeSpeed",time:a,speedFn:t=>t-.03*e.deltaTime},{name:"explode",explode:e=>{const t=45*Math.random();for(let s=0;s<8;s++)this.shootBullet(Object.assign(Object.assign({},i),{bulletPos:new o.Vector(e.body.x,e.body.y),angle:t+45*s,scale:.2}))}}]})),s.nextBulletTime=e.gameTime+s.reloadTime,s.bullets-=1}}updateVisibilityState(){const{scene:e}=this,t=this.states.visibility;t.isVisible&&this.alpha<1?this.alpha=Math.max(this.alpha+=.01*e.deltaTime,0):this.alpha>0&&(this.alpha=Math.max(this.alpha-=.01*e.deltaTime,0)),e.gameTime>t.nextChangeTime&&(t.isVisible=!t.isVisible,t.nextChangeTime=e.gameTime+t.reloadTime)}updateBombsState(){const{scene:e,body:t}=this,s=this.states.bombs;if(s.bombs<=0)this.deactivateBombsState();else if(e.gameTime>s.nextBombTime){const i={bulletPos:new o.Vector(t.x,t.y),angle:0,speed:0,sprite:"sphere-bullet",scale:.1};this.shootBullet(Object.assign(Object.assign({},i),{states:[{name:"changeSize",time:60/e.deltaTime,scaleFn:t=>t+.007*e.deltaTime},{name:"explode",explode:e=>{for(let t=0;t<8;t++)this.shootBullet(Object.assign(Object.assign({},i),{bulletPos:new o.Vector(e.body.x,e.body.y),angle:45*t,scale:.25,speed:5}))}}]})),s.nextBombTime=e.gameTime+s.reloadTime,s.bombs-=1}}updateCenterAttackState(){const{scene:e,body:t}=this,s=this.states.centerAttack;if(s.shots<=0)this.deactivateCenterAttackState();else if(e.gameTime>s.nextShotTime){const i=12,r=360/i;for(let h=0;h<i;h++){const i=new o.Vector(t.x,t.y),l=s.lastOffset+r*h,c=a.getOffsetByAngle(l,150),d=new o.Vector(i.x+c.x,i.y+c.y);this.scene.utils.createSphereBullet({pos:d,owner:n.EOwner.enemy,speed:0,angle:a.spreadAngle(l,20),sprite:"sphere-bullet-blue",explodeSprite:"explode-blue",damage:10,scale:.15,bodySize:32,explodeScale:1.35,states:[{name:"changeSize",time:50,scaleFn:t=>t+.01*e.deltaTime},{name:"changeSpeed",time:0,speedFn:()=>2}]})}s.nextShotTime=e.gameTime+s.reloadTime,s.shots-=1,s.lastOffset+=5+Math.random()*(r-10)}}shootBullet(e){var t,s;this.scene.utils.createSphereBullet({pos:e.bulletPos,owner:n.EOwner.enemy,speed:e.speed,angle:e.angle,sprite:e.sprite,explodeSprite:null!==(t=e.explodeSprite)&&void 0!==t?t:"explode-red",explodeScale:null!==(s=e.explodeScale)&&void 0!==s?s:1,damage:this.bulletDamage,scale:e.scale,bodySize:e.bodySize,states:e.states})}setRandomAttack(){const e=Math.random();e>.66?this.activateLaserDoubleAttackState():e>.33?this.activateSplashAttackState():this.activateExplodeAttackState()}getAttackPos(e){const{body:t}=this,s=new o.Vector(t.x,t.y),i=a.getOffsetByAngle(e,80);return new o.Vector(s.x+i.x,s.y+i.y)}isAttackExisted(){const{explodeAttack:e,laserDoubleAttack:t,splashAttack:s,centerAttack:i}=this.states;return e.active||t.active||s.active||i.active}}t.Boss1=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Boss2=void 0;const i=s(1),a=s(4),o=s(3),n=s(4),r=s(0),h=s(9),l=s(25);class c extends l.Boss{constructor(e){super(e,r.EBossName.chastener),this.maxHp=0,this.hp=0,this.rewardedScore=0,this.scale=.3,this.bodySize=340,this.maxSpeed=1.2,this.speed=this.maxSpeed,this.changeSpeed=.01,this.rotateSpeed=1.25,this.bulletDamage=10,this.isInsideOfSafeArea=!1,this.behavioursArray=[],this.mainState="move",this.mainStateTime=0,this.states={move:{active:!0,targetPoint:this.scene.getGameCenter(),timeToChangeTargetPoint:0,stop:!1,methods:{activate:this.activateMoveState.bind(this),deactivate:this.deactivateMoveState.bind(this),update:this.updateMoveState.bind(this)}},laserShooting:{active:!0,reloadTime:0,side:0,methods:{activate:this.activateLaserShootingState.bind(this),deactivate:this.deactivateLaserShootingState.bind(this),update:this.updateLaserShootingState.bind(this)}},doubleShooting:{active:!0,reloadTime:0,methods:{activate:this.activateDoubleShootingState.bind(this),deactivate:this.deactivateDoubleShootingState.bind(this),update:this.updateDoubleShootingState.bind(this)}},spawn:{active:!0,reloadTime:0,methods:{activate:this.activateSpawnState.bind(this),deactivate:this.deactivateSpawnState.bind(this),update:this.updateSpawnState.bind(this)}},supportShooting:{active:!1,range:0,reloadTime:0,reloadTimeInterval:8,methods:{activate:this.activateSupportShootingState.bind(this),deactivate:this.deactivateSupportShootingState.bind(this),update:this.updateSupportShootingState.bind(this)}},waveShooting:{active:!1,reloadTime:0,methods:{activate:this.activateWaveShootingState.bind(this),deactivate:this.deactivateWaveShootingState.bind(this),update:this.updateWaveShootingState.bind(this)}},wavesPartialShooting:{active:!1,reloadTime:0,methods:{activate:this.activateWavesPartialShootingState.bind(this),deactivate:this.deactivateWavesPartialShootingState.bind(this),update:this.updateWavesPartialShootingState.bind(this)}},shooting:{active:!1,reloadTime:0,methods:{activate:this.activateShootingState.bind(this),deactivate:this.deactivateShootingState.bind(this),update:this.updateShootingState.bind(this)}},spiralShooting:{active:!1,currentAngle:0,reloadTime:7,methods:{activate:this.activateSpiralShootingState.bind(this),deactivate:this.deactivateSpiralShootingState.bind(this),update:this.updateSpiralShootingState.bind(this)}}},this.setPropertiesFromConfig();const t=this.scene.utils.getRandomPointOutside({distance:200});this.body=e.physics.add.image(t.x,t.y,"boss-2-ship"),this.body.setImmovable(!0),this.body.setScale(this.scale),this.body.setDepth(n.depths.boss),this.refreshBehavioursArray(),this.centerBody()}centerBody(){const{scale:e,bodySize:t}=this,s=i.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t);this.body.setCircle(t,s.x,s.y)}act(e,t){this.body.active&&(this.updateMainState(),this.updateStates(e,t))}updateMainState(){const{scene:e,mainState:t}=this;switch(this.mainStateTime+=e.deltaTime,t){case"move":if(this.mainStateTime>500&&(this.states.move.stop=!0),this.speed<=0){const e=this.behavioursArray.shift();this.setStopState(),this.deactivateAllStates(),1===e?(this.activateWaveShootingState(),this.activateShootingState(),this.activateSupportShootingState(100,12)):2===e?(this.activateWavesPartialShootingState(),this.activateShootingState(),this.activateSupportShootingState(100,12)):(this.activateSpiralShootingState(),this.activateShootingState(),this.activateSupportShootingState(180,6)),0===this.behavioursArray.length&&this.refreshBehavioursArray()}break;case"stop":this.mainStateTime>500&&(this.setMoveState(),this.deactivateAllStates(),this.activateMoveState(),this.activateLaserShootingState(),this.activateDoubleShootingState())}}updateStates(e,t){Object.keys(this.states).forEach(s=>{this.states[s].active&&this.states[s].methods.update(e,t)})}deactivateAllStates(){Object.keys(this.states).forEach(e=>{"spawn"!==e&&this.states[e].methods.deactivate()})}setMoveState(){this.mainState="move",this.mainStateTime=0}setStopState(){this.mainState="stop",this.mainStateTime=0}activateMoveState(){const e=this.states.move;e.stop=!1,e.active=!0}deactivateMoveState(){this.states.move.active=!1}updateMoveState(e,t){const{scene:s,body:n,angle:r,rotateSpeed:h}=this,l=this.states.move,{targetPoint:c}=l;this.updateBase(e,t);const d=new o.Vector(n.x,n.y),u=new o.Vector(c.x,c.y),m=i.getAngleBetweenPointsInDegrees(u,d);this.angle=i.getNearestAngle(r,m,h*s.deltaTime),this.speed>0&&(this.body.angle=this.body.angle+this.speed/2*s.deltaTime),l.stop?this.speed=Math.max(this.speed-this.changeSpeed*s.deltaTime,0):this.speed=Math.min(this.speed+this.changeSpeed*s.deltaTime,this.maxSpeed),l.timeToChangeTargetPoint+=s.deltaTime,this.isOutsideSafeArea(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y)?(l.timeToChangeTargetPoint=0,this.isInsideOfSafeArea&&(l.targetPoint=this.scene.utils.getSafeAreaPoint(),this.isInsideOfSafeArea=!1)):this.isInsideOfSafeArea=!0,l.timeToChangeTargetPoint>200&&(l.targetPoint=this.scene.utils.getRandomPos(a.enemySafeAreaPercentage.x,a.enemySafeAreaPercentage.y),l.timeToChangeTargetPoint=0)}activateLaserShootingState(){this.states.laserShooting.active=!0}deactivateLaserShootingState(){this.states.laserShooting.active=!1}updateLaserShootingState(){const{scene:e,body:t}=this;this.states.laserShooting.reloadTime+=this.scene.deltaTime;const s=this.states.laserShooting.side;if(this.states.laserShooting.reloadTime>=20){const a=e.player.body,n=new o.Vector(a.x,a.y),r=new o.Vector(t.x,t.y),h=i.getOffsetByAngle(this.angle-90*s,this.body.displayWidth/3.8),l=new o.Vector(r.x+h.x,r.y+h.y),c=i.getAngleBetweenPointsInDegrees(n,l);for(let e=0;e<3;e++)this.shootBullet(c+15*e-15,{bodySize:6,bulletSpeed:6,bulletPos:l,sprite:"laser-red",explodeSprite:"explode-red",scale:1});this.states.laserShooting.reloadTime=0,this.states.laserShooting.side+=1}}activateDoubleShootingState(){this.states.doubleShooting.active=!0}deactivateDoubleShootingState(){this.states.doubleShooting.active=!1}updateDoubleShootingState(){const{scene:e,body:t}=this;if(this.states.doubleShooting.reloadTime+=this.scene.deltaTime,this.states.doubleShooting.reloadTime>=30){const s=e.player.body,a=new o.Vector(s.x,s.y),n=new o.Vector(t.x,t.y),r=i.getAngleBetweenPointsInDegrees(a,n),h=10+70*Math.random();for(let e=0;e<2;e++)this.shootBullet(r+e*h-h/2,{bulletSpeed:4,bulletPos:n,scale:.5,sprite:"sphere-bullet",explodeSprite:"explode-red"});this.states.doubleShooting.reloadTime=0}}activateSpawnState(){this.states.spawn.active=!0}deactivateSpawnState(){this.states.spawn.active=!1}updateSpawnState(){const{scene:e}=this;this.states.spawn.reloadTime-=e.deltaTime,this.states.spawn.reloadTime<0&&(this.states.spawn.reloadTime=300,3-this.scene.enemies.length>0&&this.scene.utils.createEnemy(h.UFO,{pos:new o.Vector(this.body.x,this.body.y)}))}activateWaveShootingState(){this.states.waveShooting.active=!0}deactivateWaveShootingState(){this.states.waveShooting.active=!1}updateWaveShootingState(){const e=this.states.waveShooting;e.reloadTime-=this.scene.deltaTime,e.reloadTime<0&&(e.reloadTime=80,this.shootWave())}activateSupportShootingState(e,t){this.states.supportShooting.active=!0,this.states.supportShooting.range=e,this.states.supportShooting.reloadTimeInterval=t}deactivateSupportShootingState(){this.states.supportShooting.active=!1}updateSupportShootingState(){const{scene:e,body:t}=this,s=this.states.supportShooting;if(s.reloadTime-=e.deltaTime,s.reloadTime<0){s.reloadTime=s.reloadTimeInterval;const a=new o.Vector(t.x,t.y),n=e.player.body,r=new o.Vector(n.x,n.y),h=i.getAngleBetweenPointsInDegrees(r,new o.Vector(t.x,t.y));for(let e=0;e<3;e++){const e=i.spreadAngle(h,s.range),t=.2+.25*Math.random();this.shootBullet(e,{bulletSpeed:5-8*t,bulletPos:a,scale:t,sprite:"sphere-bullet-yellow",explodeSprite:"explode-yellow"})}}}activateWavesPartialShootingState(){this.states.wavesPartialShooting.active=!0}deactivateWavesPartialShootingState(){this.states.wavesPartialShooting.active=!1}updateWavesPartialShootingState(){const e=this.states.wavesPartialShooting;e.reloadTime-=this.scene.deltaTime,e.reloadTime<0&&(e.reloadTime=40,this.shootPartialWave())}activateSpiralShootingState(){this.states.spiralShooting.active=!0}deactivateSpiralShootingState(){this.states.spiralShooting.active=!1}updateSpiralShootingState(){const{scene:e,body:t}=this,s=this.states.spiralShooting;if(s.reloadTime-=e.deltaTime,s.reloadTime<0){s.reloadTime=7;const e=new o.Vector(t.x,t.y);for(let t=0;t<3;t++)this.shootBullet(s.currentAngle+120*t,{bulletSpeed:5,bulletPos:e,scale:.4});s.currentAngle+=7}}activateShootingState(){this.states.shooting.active=!0}deactivateShootingState(){this.states.shooting.active=!1}updateShootingState(){const{scene:e,body:t}=this,s=new o.Vector(t.x,t.y),a=e.player.body,n=new o.Vector(a.x,a.y),r=i.getAngleBetweenPointsInDegrees(n,new o.Vector(t.x,t.y)),h=this.states.shooting;h.reloadTime-=e.deltaTime,h.reloadTime<0&&(h.reloadTime=8,this.shootBullet(i.spreadAngle(r,10),{bulletSpeed:6,bulletPos:s,scale:.2,sprite:"sphere-bullet-gray",explodeSprite:"explode-gray"}))}shootWave(){const{scene:e,body:t}=this,s=new o.Vector(t.x,t.y),a=e.player.body,n=new o.Vector(a.x,a.y),r=i.getAngleBetweenPointsInDegrees(n,new o.Vector(t.x,t.y)),h=i.spreadAngle(r,10);for(let e=0;e<10;e++){const t=h+20*(e-4),a=i.getOffsetByAngle(t,this.getRadialBulletOffset()),n=new o.Vector(s.x+a.x,s.y+a.y);this.shootBullet(h,{bulletSpeed:4,bulletPos:n,scale:.4})}}shootPartialWave(){const{body:e}=this,t=new o.Vector(e.x,e.y),s=60*Math.random();for(let e=0;e<6;e++)for(let a=0;a<5;a++){const n=60*e+15*(a-2)+s,r=i.getOffsetByAngle(n,this.getRadialBulletOffset()),h=new o.Vector(t.x+r.x,t.y+r.y);this.shootBullet(60*e+s,{bulletSpeed:4,bulletPos:h,scale:.4})}}shootBullet(e,t){var s,i,a;const{bulletDamage:o}=this,{bulletSpeed:n,bulletPos:h,scale:l}=t;this.scene.utils.createSphereBullet({pos:h,owner:r.EOwner.enemy,speed:n,angle:e,sprite:null!==(s=t.sprite)&&void 0!==s?s:"sphere-bullet",explodeSprite:null!==(i=t.explodeSprite)&&void 0!==i?i:"explode-red",damage:o,scale:l,bodySize:null!==(a=t.bodySize)&&void 0!==a?a:32})}updateBase(e,t){const{scene:s,body:a,angle:o}=this,{deltaTime:n}=s,r=i.angleToRadians(o);a.x+=this.speed*Math.cos(r)*n,a.y+=this.speed*Math.sin(r)*n}refreshBehavioursArray(){this.behavioursArray=[1,2,3].sort(()=>.5-Math.random())}getRadialBulletOffset(){return this.body.displayWidth/2.5}}t.Boss2=c},function(e,t,s){"use strict";function i(e,t=10){return{pluralName:e+".plural",reward:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.enemiesConfig=void 0,t.enemiesConfig={coinChance:.5,ships:{bot:i("bots",2),hunter:i("hunters"),ufo:i("ufo"),flyer:i("flyers",12),destroyer:i("destroyers",16),"laser-ship":i("laser-ships"),defender:i("defender"),stealth:i("stealths"),"missile-carrier":i("missile-carriers")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boostersConfig=void 0,t.boostersConfig={spawnAdditionalTime:2,spawnIntervalRangeTime:10,lifeTime:7,types:{speed:{additionalSpeed:1},damage:{additionalXDamage:2},regenerator:{hpPerSecond:5}}}},function(e,t,s){"use strict";function i(e,t,s=1.5){const i=[e];for(let e=0;e<t-1;e++)i.push(Math.floor(i[i.length-1]*s));return i}function a(e,t){return{maxLevel:e.length+1,price:e,valuePerLevel:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.storeConfig=void 0;const o={maxHealth:a(i(200,10,1.5),10),damage:a(i(200,10,2),2),explosionResistance:a(i(200,9,1.5),10),movementSpeed:a(i(200,10,2),.4),attackSpeed:a(i(200,10,2),32),bonusesTime:a(i(200,10,1.5),2),fortune:a(i(200,9,2),5)};t.storeConfig={products:o}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playerConfig=void 0,t.playerConfig={movementSpeed:5,attackSpeed:320,damage:10,maxHealth:100,explosionResistance:0,bonusesTime:10,fortune:50,revive:{immortalityTime:3e3,healthPercentage:50},shadowIntervalTime:50,bodyOffset:10,movePointerParams:{range:5,speed:4},anglePointerParams:{range:1,speed:40}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fireflyConfig=void 0;const i=s(1);t.fireflyConfig={maxCountPerLevel:2,spawnTimeInterval:i.getSeconds(20),spawnTimeIntervalRange:i.getSeconds(20),alphaChange:.008,bodySize:18,depth:10,cameraFlashDuration:i.getSeconds(3),hp:4,reward:2,speed:4,rotateSpeed:3,scale:.5,targetTimeInterval:500,targetTimeIntervalRange:500,lifeTime:i.getSeconds(5),lifeTimeRange:i.getSeconds(5),increaseSpeedOnHit:1,decreaseTargetTimeIntervalOnHit:100,decreaseTargetTimeIntervalRangeOnHit:100,increaseRewardPerLevel:.5}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreScene=t.FinalScene=t.LeaderboardsScene=t.ContactsScene=t.LoadingScene=t.AdScene=t.HistoryScene=t.InfoScene=t.PreloadScene=t.GameScene=t.FailScene=t.WinScene=t.PreviewScene=t.MenuScene=t.Scene=void 0;var i=s(7);Object.defineProperty(t,"Scene",{enumerable:!0,get:function(){return i.Scene}});var a=s(122);Object.defineProperty(t,"MenuScene",{enumerable:!0,get:function(){return a.MenuScene}});var o=s(123);Object.defineProperty(t,"PreviewScene",{enumerable:!0,get:function(){return o.PreviewScene}});var n=s(124);Object.defineProperty(t,"WinScene",{enumerable:!0,get:function(){return n.WinScene}});var r=s(125);Object.defineProperty(t,"FailScene",{enumerable:!0,get:function(){return r.FailScene}});var h=s(126);Object.defineProperty(t,"GameScene",{enumerable:!0,get:function(){return h.GameScene}});var l=s(170);Object.defineProperty(t,"PreloadScene",{enumerable:!0,get:function(){return l.PreloadScene}});var c=s(171);Object.defineProperty(t,"InfoScene",{enumerable:!0,get:function(){return c.InfoScene}});var d=s(172);Object.defineProperty(t,"HistoryScene",{enumerable:!0,get:function(){return d.HistoryScene}});var u=s(173);Object.defineProperty(t,"AdScene",{enumerable:!0,get:function(){return u.AdScene}});var m=s(174);Object.defineProperty(t,"LoadingScene",{enumerable:!0,get:function(){return m.LoadingScene}});var p=s(175);Object.defineProperty(t,"ContactsScene",{enumerable:!0,get:function(){return p.ContactsScene}});var g=s(176);Object.defineProperty(t,"LeaderboardsScene",{enumerable:!0,get:function(){return g.LeaderboardsScene}});var y=s(177);Object.defineProperty(t,"FinalScene",{enumerable:!0,get:function(){return y.FinalScene}});var S=s(178);Object.defineProperty(t,"StoreScene",{enumerable:!0,get:function(){return S.StoreScene}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UI=void 0;const i=s(12),a=s(3),o=s(4),n=s(21);t.UI=class{constructor(e){this.scene=e}drawOriginalText(e){const{scene:t}=this,{x:s,y:i,text:a,fontSize:n,origin:r,color:h,align:l,maxWidth:c,depth:d,alpha:u}=e,m={fontFamily:o.DEFAULT_FONT,fontSize:1.5*n+"px",lineSpacing:5,color:"#fff"};l&&(m.align=l),c&&(m.wordWrap={width:1.35*c});const p=t.add.text(s,i,a,m);return p.setScale(.65),r&&p.setOrigin(r[0],r[1]),u&&p.setAlpha(u),h&&p.setTint(h),d&&p.setDepth(d),p}drawBitmapText(e){const{scene:t}=this,{x:s,y:i,text:a,fontSize:n,origin:r,alignCenter:h,maxWidth:l,tint:c,depth:d,isDynamic:u,alpha:m,letterSpacing:p}=e,g=u?t.add.dynamicBitmapText(s,i,o.SECONDARY_FONT,a,n):t.add.bitmapText(s,i,o.SECONDARY_FONT,a,n);return r&&g.setOrigin(r[0],r[1]),p&&g.setLetterSpacing(p),h&&g.setCenterAlign(),l&&g.setMaxWidth(l),c&&g.setTint(c),d&&g.setDepth(d),m&&g.setAlpha(m),g}drawDynamicBitmapText(e){return this.drawBitmapText(Object.assign(Object.assign({},e),{isDynamic:!0}))}drawImage(e){const{scene:t}=this,{x:s,y:i,texture:a,scale:o,depth:n,origin:r}=e,h=t.add.image(s,i,a);return o&&h.setScale(o),n&&h.setDepth(n),r&&h.setOrigin(r[0],r[1]),h}drawRainbowText(e){const{scene:t}=this,{x:s,y:r}=e,h=i.__rest(e,["x","y"]);return new n.UIRainbowText(t,Object.assign({pos:new a.Vector(s,r),fontSize:23,color:o.colors.green},h))}drawButton(e){const{scene:t}=this,{x:s,y:r}=e,h=i.__rest(e,["x","y"]);return new n.UIRectButton(t,Object.assign({pos:new a.Vector(s,r),width:o.defaultButtonParams.width,height:o.defaultButtonParams.height},h))}drawArcButton(e){const{scene:t}=this,{x:s,y:o}=e,r=i.__rest(e,["x","y"]);return new n.UIArcButton(t,Object.assign({pos:new a.Vector(s,o)},r))}drawCosmons(e){const{scene:t}=this,{x:s,y:o}=e,r=i.__rest(e,["x","y"]);return new n.UICosmons(t,Object.assign({pos:new a.Vector(s,o)},r))}drawIndicator(e){const{scene:t}=this,{x:s,y:o}=e,r=i.__rest(e,["x","y"]);return new n.UIIndicator(t,Object.assign({pos:new a.Vector(s,o)},r))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRectButton=t.UIArcButton=void 0;var i=s(115);Object.defineProperty(t,"UIArcButton",{enumerable:!0,get:function(){return i.UIArcButton}});var a=s(116);Object.defineProperty(t,"UIRectButton",{enumerable:!0,get:function(){return a.UIRectButton}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIArcButton=void 0;const i=s(4);t.UIArcButton=class{constructor(e,t){this.scene=e,this.params=t,this.init()}init(){const{scene:e,params:t}=this,s=new Phaser.Geom.Circle(t.pos.x,t.pos.y,t.arc),a=e.add.graphics({lineStyle:{width:2,color:i.colors.white},fillStyle:{color:i.colors.white}}).setInteractive(s,Phaser.Geom.Circle.Contains);a.on("pointerdown",()=>{var e,s;null===(s=null===(e=t.callbacks)||void 0===e?void 0:e.onPointerDown)||void 0===s||s.call(e)}),a.strokeCircleShape(s),t.render()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRectButton=void 0;const i=s(4),a=i.colors.white;t.UIRectButton=class{constructor(e,t){this.isVisible=!0,this.fixedColor=null,this.isDisabled=!1,this.isHovered=!1,this.scene=e,this.params=t,this.pos=t.pos,this.isDisabled=Boolean(t.isDisabled),this.init()}init(){const{scene:e,params:t,isDisabled:s}=this,o=s?.5:1;this.text=this.scene.ui.drawOriginalText({x:t.pos.x,y:t.pos.y,depth:t.depth||0,fontSize:i.fontSizes.text,origin:[.5,.5],align:"center",alpha:o,text:t.text}),this.width=t.responsive?this.text.displayWidth+2*t.responsive.paddingX:t.width;const n=t.pos.x-this.width/2,r=t.pos.y-t.height/2;this.rectShape=new Phaser.Geom.Rectangle(n,r,this.width,t.height),this.graphics=e.add.graphics({lineStyle:{width:2,color:a},fillStyle:{color:a}}).setInteractive(this.rectShape,Phaser.Geom.Rectangle.Contains).setAlpha(o),t.depth&&this.graphics.setDepth(t.depth),this.draw(),this.initListeners()}draw(){this.graphics.clear();const{isHovered:e,isDisabled:t,isVisible:s,fixedColor:o}=this;if(!s)return;const n=this.isDisabled?.5:1;let r=e&&!t?i.colors.green:a;o&&(r=o),this.graphics.lineStyle(2,r),this.graphics.strokeRectShape(this.rectShape),this.text.tint=r,this.text.setAlpha(n),this.graphics.setAlpha(n),e&&t&&(document.body.style.cursor="default")}initListeners(){const{graphics:e,params:t}=this;e.on("pointerdown",()=>{var e,s;!this.isDisabled&&this.isVisible&&(t.noDefaultCursorAfterClick||(document.body.style.cursor="default"),null===(s=null===(e=t.callbacks)||void 0===e?void 0:e.onPointerDown)||void 0===s||s.call(e))}),e.on("pointerover",()=>{this.isHovered=!0,!this.isDisabled&&this.isVisible&&(document.body.style.cursor="pointer"),this.draw()}),e.on("pointerout",()=>{this.isHovered=!1,document.body.style.cursor="default",this.draw()})}updatePosition(e,t){const{params:s}=this,i=e-this.width/2,a=t-s.height/2;this.rectShape.x=i,this.rectShape.y=a,this.pos.x=e,this.pos.y=t,this.draw(),this.text.x=e,this.text.y=t}hide(){const{text:e}=this;e.tint=a,this.isVisible=!1,this.text.visible=!1,this.graphics.clear(),this.graphics.setDepth(-1)}show(){this.isVisible=!0,this.draw(),this.text.visible=!0,this.graphics.setDepth(this.params.depth||1)}setFixedColor(e){const{graphics:t,text:s}=this;t.clear(),t.lineStyle(2,e),s.tint=e,t.strokeRectShape(this.rectShape),this.fixedColor=e}setDisabled(e){this.isDisabled=e,this.draw()}unfixColor(){const{graphics:e,text:t}=this;e.clear(),e.lineStyle(2,a),t.tint=a,e.strokeRectShape(this.rectShape),this.fixedColor=null}getSize(){return{width:this.width,height:this.params.height}}getParams(){return this.params}getPosition(){return this.pos}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UICosmons=void 0;const i=s(3),a=s(16);class o extends a.UIComponent{constructor(e,t){super(e),this.params=t,this.pos=t.pos,this.isCentered=t.isCentered,this.init()}init(){const{scene:e,params:t}=this,{pos:s,value:i,depth:a,prefix:o}=t,n=this.getTextOffset();this.starImage=e.ui.drawImage({x:s.x,y:s.y,texture:"coin-gold",origin:[0,.5],depth:a}),o&&(this.prefixBitmapText=e.ui.drawBitmapText({x:s.x+this.starImage.width+12-4,y:s.y+4+1,text:o,fontSize:22,origin:[0,.5],depth:a})),this.valueText=e.ui.drawBitmapText({x:s.x+this.starImage.width+12+n,y:s.y+4,text:i.toString(),fontSize:22,origin:[0,.5],depth:a}),this.updatePosition(s)}getTextOffset(){return this.params.prefix?12:0}getHalfWidth(){const e=this.getTextOffset();return(this.starImage.width+12+this.valueText.width+e)/2}updatePosition(e){const{params:t,isCentered:s}=this,{prefix:a}=t,o=a?12:0,n=s?e.x-this.getHalfWidth():e.x,r=new i.Vector(n,e.y);this.starImage.x===r.x&&this.starImage.y===r.y||(this.starImage.x=r.x,this.starImage.y=r.y,this.prefixBitmapText&&(this.prefixBitmapText.x=r.x+this.starImage.width+12-4,this.prefixBitmapText.y=r.y+4+1),this.valueText.x=r.x+this.starImage.width+12+o,this.valueText.y=r.y+4,this.pos=e)}updateValue(e){this.valueText.setText(e.toString()),this.updatePosition(this.pos)}setCentered(e){this.isCentered=e}hide(){this.valueText.visible=!1,this.starImage.visible=!1}show(){this.valueText.visible=!0,this.starImage.visible=!0}getPosition(){const{pos:e}=this.params;return new i.Vector(e.x,e.y)}getHeight(){return this.starImage.displayHeight}}t.UICosmons=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRainbowText=void 0;const i=s(16);class a extends i.UIComponent{constructor(e,t){super(e),this.rainbowColorIdx=0,this.rainbowColorOffset=0,this.delay=0,this.rainbowWave=0,this.params=t,this.init()}init(){const{scene:e}=this,{text:t,pos:s,color:i,fontSize:a}=this.params;this.rainbowCallback=this.rainbowCallback.bind(this);e.ui.drawDynamicBitmapText({x:s.x,y:s.y,text:t,fontSize:a,origin:[.5,.5],alignCenter:!0,tint:i}).setDisplayCallback(this.rainbowCallback)}update(){this.updateRainbow()}updateRainbow(){this.rainbowColorIdx=0,6==this.delay++&&(this.rainbowColorOffset=(this.rainbowColorOffset+1)%4,this.delay=0)}rainbowCallback(e){return this.rainbowColorIdx=(this.rainbowColorIdx+1)%4,e.y=2*Math.cos(this.rainbowWave+this.rainbowColorIdx),this.rainbowWave+=.005,e}}t.UIRainbowText=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIRewardedModal=void 0;const i=s(3),a=s(4),o=s(16),n=s(37),r=550,h=200;class l extends o.UIComponent{constructor(e,t){super(e),this.isModalInteractive=!0,this.params=t,this.init()}init(){const{scene:e,params:t}=this;this.graphics=e.add.graphics({lineStyle:{width:3,color:a.colors.white},fillStyle:{color:a.colors.black}}),this.graphics.setDepth(a.depths.modal),this.circleProgress=new n.UICircleProgress(e,{pos:new i.Vector(t.pos.x,t.pos.y+25),depth:a.depths.modalContent}),this.text=this.scene.ui.drawOriginalText({x:t.pos.x,y:t.pos.y-40,text:this.scene.game.i18n.getText("rewardedModal"),fontSize:18,align:"center",origin:[.5,.5],maxWidth:r,color:a.colors.white,depth:a.depths.modalContent}),this.drawWatchButton(t.pos.x-70-50,t.pos.y+25),this.drawFinishButton(t.pos.x+70+50,t.pos.y+25),this.hide()}show(){const{scene:e,graphics:t,params:s}=this;this.endTime=e.sceneTime+5e3;const i=new Phaser.Geom.Rectangle(s.pos.x-r/2,s.pos.y-h/2,r,h);t.strokeRectShape(i),t.fillRectShape(i),this.text.text=this.scene.game.i18n.getText("rewardedModal"),this.text.y=s.pos.y-40,this.watchButton.show(),this.finishButton.show(),this.text.visible=!0,this.isModalInteractive=!0,this.isVisible=!0}hide(){this.graphics.clear(),this.watchButton.hide(),this.finishButton.hide(),this.circleProgress.hide(),this.text.visible=!1,this.isModalInteractive=!1,this.isVisible=!1}update(){const{scene:e,endTime:t,isVisible:s}=this;if(!s||!this.isModalInteractive)return;const i=(t-e.sceneTime)/5e3;this.circleProgress.update({percentage:i,color:a.colors.yellow}),i<=0&&this.params.onProgressEnd()}drawWatchButton(e,t){this.watchButton=this.scene.ui.drawButton({x:e,y:t,width:140,depth:a.depths.modalContent,height:a.defaultButtonParams.height,text:this.scene.game.i18n.getText("watch"),callbacks:{onPointerDown:()=>{let e=!1;this.isModalInteractive&&(this.isModalInteractive=!1,this.drawAdLoadingState(),this.scene.game.adManager.showRewardedVideo({onRewarded:()=>{e=!0},onClose:()=>{e?this.params.onRewarded():this.params.onCancelReward()}}))}}})}drawFinishButton(e,t){this.finishButton=this.scene.ui.drawButton({x:e,y:t,width:140,depth:a.depths.modalContent,height:a.defaultButtonParams.height,text:this.scene.game.i18n.getText("exit"),callbacks:{onPointerDown:()=>{this.isModalInteractive&&this.params.onExit()}}})}drawAdLoadingState(){const{graphics:e,params:t}=this;e.clear();const s=new Phaser.Geom.Rectangle(t.pos.x-r/2,t.pos.y-h/2+h/4,r,h/2);e.strokeRectShape(s),e.fillRectShape(s),this.watchButton.hide(),this.finishButton.hide(),this.circleProgress.hide(),this.text.text=this.scene.game.i18n.getText("adLoading"),this.text.y=t.pos.y}}t.UIRewardedModal=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UITabs=void 0;const i=s(4),a=s(16);class o extends a.UIComponent{constructor(e,t){super(e),this.buttons=[],this.activeTabIndex=0,this.params=t,this.init()}init(){const{scene:e,params:t,buttons:s}=this;t.tabs.forEach((a,o)=>{const n=e.ui.drawButton({x:t.pos.x,y:t.pos.y,noDefaultCursorAfterClick:!0,responsive:{paddingX:30},height:i.defaultButtonParams.height,text:e.game.i18n.getText(a.textI18nKey),callbacks:{onPointerDown:()=>{t.onClick(a),this.setActiveTabIndex(o)}}});s.push(n)});let a=0;for(let e=1;e<s.length;e++){const i=s[e-1],o=s[e];a=20+a+i.getSize().width/2+o.getSize().width/2,o.updatePosition(t.pos.x+a,o.getParams().pos.y)}const o=(s.reduce((e,t)=>e+20+t.getSize().width,0)-s[0].getSize().width-20)/2;s.forEach(e=>{e.updatePosition(e.getParams().pos.x-o,e.getParams().pos.y)}),this.setActiveTabIndex(this.activeTabIndex)}setActiveTabIndex(e){this.buttons[this.activeTabIndex].unfixColor(),this.activeTabIndex=e,this.buttons[e].setFixedColor(i.colors.green)}}t.UITabs=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UIIndicator=void 0;const i=s(4),a=s(16),o=5,n=20,r=5;class h extends a.UIComponent{constructor(e,t){super(e),this.params=t,this.pos=t.pos,this.value=t.value,this.maxValue=t.max,this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),this.init()}init(){this.draw()}draw(){const{graphics:e,pos:t,value:s,maxValue:a}=this;e.clear();const h=a*(o+r)-r,l=t.x-h/2,c=t.y;for(let t=0;t<a;t++){const a=new Phaser.Geom.Rectangle(l+t*o+t*r,c,o,n),h=s<t?i.colors.red:i.colors.green;e.lineStyle(2,h),e.strokeRectShape(a)}}hide(){this.graphics.clear()}show(){this.draw()}updatePosition(e){this.pos=e,this.draw()}setValue(e){this.value=e,this.draw()}setMaxValue(e){this.maxValue=e,this.draw()}}t.UIIndicator=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MenuScene=void 0;const i=s(5),a=s(4),o=s(0),n=s(1),r=s(7);let h=!1;class l extends r.Scene{constructor(){super({key:o.ESceneName.menu})}preload(){this.load.image("coin-gold","assets/images/bonus/star-gold.png"),this.load.image("question-mark","assets/images/interface/question-mark.png"),h||(this.load.bitmapFont(a.SECONDARY_FONT,"assets/fonts/atari/bitmap/gem.png","assets/fonts/atari/bitmap/gem.xml"),h=!0)}create(){this.getGameSize();const e=this.getGameCenter(),t=[50,50,70,a.defaultButtonParams.spaceY];let s=e.y-160;this.drawTitle(e.x,s),s+=t[0],this.drawSubtitle(e.x,s),s+=t[1],this.ui.drawCosmons({x:e.x,y:s,value:this.getData().score,isCentered:!0,depth:100}),s+=t[2],this.drawLevelText(e.x,s),s+=t[3],this.drawStoreButton(e.x-a.defaultButtonParams.width190-a.defaultButtonParams.spaceX,s),this.drawLeaderboardButton(e.x+a.defaultButtonParams.width190+a.defaultButtonParams.spaceX,s),this.drawStartButton(e.x,s),this.drawContactsButton(e.x-a.defaultButtonParams.width190-a.defaultButtonParams.spaceX,s+a.defaultButtonParams.spaceY),this.drawWorkshopButton(e.x+a.defaultButtonParams.width190+a.defaultButtonParams.spaceX,s+a.defaultButtonParams.spaceY),this.drawRankedBossesButton(e.x,s+a.defaultButtonParams.spaceY),this.drawLastUpdatedText(),this.getSettings().isMobile}update(){this.rainbowText.update()}drawTitle(e,t){this.ui.drawBitmapText({x:e,y:t,text:i.mainConfig.gameTitle,fontSize:32,origin:[.5,.5]})}drawSubtitle(e,t){this.rainbowText=this.ui.drawRainbowText({x:e,y:t,text:i.mainConfig.gameSubtitle})}drawLevelText(e,t){const{getText:s}=this.game.i18n,i=this.getData().level+1;this.ui.drawOriginalText({x:e,y:t,text:`${s("nextLevel")}: ${i}. ${s(`level${i}Title`)}`,fontSize:19,origin:[.5,.5]})}drawStartButton(e,t){this.ui.drawButton({x:e,y:t,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("gameStart"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.ad),this.getSettings().isMobile&&setTimeout(()=>{n.showFullscreen(this.game.canvas)},a.FULLSCREEN_TIMEOUT_DELAY)}}})}drawContactsButton(e,t){this.ui.drawButton({x:e,y:t,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("contacts"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{text:this.game.i18n.getTemplateText("contactDeveloper.template",{args:{email:a.DEVELOPER_EMAIL}}),textSize:a.fontSizes.text})}}})}drawStoreButton(e,t){this.ui.drawButton({x:e,y:t,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("store"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.store)}}})}drawLeaderboardButton(e,t){this.ui.drawButton({x:e,y:t,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("leaderboard"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.leaderboards)}}})}drawWorkshopButton(e,t){this.ui.drawButton({x:e,y:t,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("workshop"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{text:this.game.i18n.getText("soon"),textSize:a.fontSizes.title})}}})}drawRankedBossesButton(e,t){this.ui.drawButton({x:e,y:t,width:a.defaultButtonParams.width190,height:a.defaultButtonParams.height,text:this.game.i18n.getText("rankedBosses"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{text:this.game.i18n.getText("soon"),textSize:a.fontSizes.title})}}})}drawLastUpdatedText(){const e=this.getGameCenter(),t=this.getGameSize(),{getText:s}=this.game.i18n,a=this.getSettings().isMobile,o=a?t.width-20:e.x,n=a?[1,.5]:[.5,.5],r=new Date(i.env.buildTime).toLocaleString();this.ui.drawOriginalText({x:o,y:a?25:t.height-35,text:a?r:`${s("lastUpdated")}: ${r}`,fontSize:a?14:16,origin:n})}drawInfoButton(e,t){this.ui.drawArcButton({x:e,y:t,arc:20,render:()=>{this.add.text(e,t,"?",{font:"22px Arial",fill:"#fff"}).setOrigin(.5)},callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.info,{})}}})}}t.MenuScene=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewScene=void 0;const i=s(4),a=s(5),o=s(0),n=s(7),r=[i.defaultUISpacings.text];class h extends n.Scene{constructor(){super({key:o.ESceneName.preview})}init(e){this.params=e}create(){const e=this.getData().level,t=this.getGameCenter();this.titleText=this.ui.drawOriginalText({x:t.x,y:t.y,text:`${e+1}. ${this.game.i18n.getText(`level${e+1}Title`)}`,fontSize:32,origin:[.5,0],align:"center"}),this.missionText=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.translations.getMissionText(a.levelsConfig.levels[e].mode),fontSize:18,align:"center",origin:[.5,0],color:i.colors.green}),this.missionText.y=this.titleText.y+this.titleText.displayHeight+r[0],this.drawGoButton(this.missionText.y+this.missionText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText),this.updateContentPositions()}drawGoButton(e){const t=this.getGameSize();this.goButton=this.ui.drawButton({x:t.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("go"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.loading,{})}}})}updateContentPositions(){const e=(this.goButton.getPosition().y+i.defaultButtonParams.height/2-this.titleText.y)/2;this.titleText.y-=e,this.missionText.y-=e,this.goButton.updatePosition(this.goButton.getPosition().x,this.goButton.getPosition().y-e)}}t.PreviewScene=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WinScene=void 0;const i=s(5),a=s(4),o=s(0),n=s(1),r=s(7),h=s(3),l=[20,35,70];class c extends r.Scene{constructor(){super({key:o.ESceneName.win}),this.menuButton=null,this.isLastLevel=!1}preload(){}init(e){this.params=e}create(){const e=this.getData(),{score:t,isFlawlessVictory:s}=this.params;this.isLastLevel=i.mainConfig.totalLevelsCount<=e.level+1;const o=s?Math.ceil(.5*t):0,n=t+o,r=this.getGameCenter(),h={currentLevel:e.level,score:t,totalScore:n,flawlessVictoryScores:o};this.drawTitle(r.x,r.y),this.drawScores(r.x,this.titleText.y+this.titleText.displayHeight+l[0],h),this.drawCosmons(r.x,this.scoresText.y+this.scoresText.displayHeight+l[1],h.totalScore);const c=Math.round(a.defaultButtonParams.width/2)+Math.round(a.defaultButtonParams.spaceX/2),d=this.cosmons.getPosition().y+l[2];this.drawNextButton(r.x+c,d),this.isLastLevel?this.menuButton=null:this.drawMenuButton(r.x-c,d),this.updateContentPositions(),this.updateData({totalScore:n})}drawTitle(e,t){const{getText:s}=this.game.i18n;this.titleText=this.ui.drawOriginalText({x:e,y:t,text:s("winTitle"),origin:[.5,0],fontSize:28,color:a.colors.green})}drawScores(e,t,s){const{getText:i}=this.game.i18n,a=`${i("score")}: ${s.score}\n${i("flawlessVictory")}: ${s.flawlessVictoryScores}\n${i("totalScore")}: ${s.totalScore}`;this.scoresText=this.ui.drawOriginalText({x:e,y:t,text:a,fontSize:18,origin:[.5,0],align:"center"})}drawCosmons(e,t,s){this.cosmons=this.ui.drawCosmons({x:e,y:t,isCentered:!0,value:s,prefix:"+",depth:100})}drawNextButton(e,t){const{getText:s}=this.game.i18n;this.nextButton=this.ui.drawButton({x:e,y:t,text:s("next"),responsive:{paddingX:a.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.isLastLevel?this.scene.start(o.ESceneName.final):this.scene.start(o.ESceneName.ad)}}})}drawMenuButton(e,t){const{getText:s}=this.game.i18n;this.menuButton=this.ui.drawButton({x:e,y:t,text:s("goToMenu"),responsive:{paddingX:a.defaultButtonParams.paddingX},callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}})}updateData(e){const t=this.getData(),{level:s}=t;n.sendMetrikaGoal(o.EGoalTargetName.levelCompleted,{level:t.level+1}),this.isLastLevel?this.setData("level",0):this.setData("level",s+1),this.setData("score",t.score+e.totalScore),this.game.localStorage.setGameData({score:t.score,level:t.level}),this.game.leaderboards.setLeaderboardScore(t.level)}updateContentPositions(){var e;const t=this.getGameCenter(),s=(this.nextButton.getPosition().y+a.defaultButtonParams.height/2-this.titleText.y)/2;if(this.titleText.y-=s,this.scoresText.y-=s,this.cosmons.updatePosition(new h.Vector(this.cosmons.getPosition().x,this.cosmons.getPosition().y-s)),this.menuButton){const i=(this.nextButton.getSize().width/2+this.menuButton.getSize().width/2+a.defaultButtonParams.spaceX)/2;this.nextButton.updatePosition(t.x+i,this.nextButton.getParams().pos.y-s),null===(e=this.menuButton)||void 0===e||e.updatePosition(t.x-i,this.menuButton.getParams().pos.y-s)}else this.nextButton.updatePosition(t.x,this.nextButton.getParams().pos.y-s)}}t.WinScene=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FailScene=void 0;const i=s(4),a=s(0),o=s(7),n=[i.defaultUISpacings.text,i.defaultButtonParams.spaceYText];class r extends o.Scene{constructor(){super({key:a.ESceneName.fail})}preload(){}init(e){this.params=e}create(){this.setData("level",0),this.game.localStorage.setGameData({level:0});const e=this.getGameCenter(),{getText:t}=this.game.i18n;this.titleText=this.ui.drawOriginalText({x:e.x,y:e.y,text:t("failTitle"),origin:[.5,0],fontSize:28,color:i.colors.red}),this.subtitleText=this.ui.drawOriginalText({x:e.x,y:e.y,text:t("failSubtitle"),fontSize:19,origin:[.5,0],align:"center",color:i.colors.white}),this.drawMenuButton(e.x,e.y),this.setContentPositions(),this.updateContentPositions()}drawMenuButton(e,t){const{getText:s}=this.game.i18n;this.menuButton=this.ui.drawButton({x:e,y:t,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:s("goToMenu"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.menu)}}})}setContentPositions(){this.subtitleText.y=this.titleText.y+this.titleText.displayHeight+n[0],this.menuButton.updatePosition(this.menuButton.getPosition().x,this.subtitleText.y+this.subtitleText.displayHeight+i.defaultButtonParams.height/2+n[1])}updateContentPositions(){const e=(this.menuButton.getPosition().y+i.defaultButtonParams.height/2-this.titleText.y)/2;this.titleText.y-=e,this.subtitleText.y-=e,this.menuButton.updatePosition(this.menuButton.getPosition().x,this.menuButton.getPosition().y-e)}}t.FailScene=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;var i=s(127);Object.defineProperty(t,"GameScene",{enumerable:!0,get:function(){return i.GameScene}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;const i=s(5),a=s(1),o=s(128),n=s(7),r=s(162),h=s(21),l=s(0),c=s(163),d=s(169);let u=!1;class m extends n.Scene{constructor(){super({key:l.ESceneName.game}),this.enemies=[],this.bullets=[],this.effects=[],this.bonuses=[],this.instances=[],this.boss=null,this.score=0,this.lives=2,this.stats=d.getInitialGameStats(),this.isWon=!1,this.isFail=!1,this.gameTime=0,this.deltaTime=0,this.isPaused=!1}init(e){}create(){this.resetState(),a.sendMetrikaGoal(l.EGoalTargetName.levelStart,{level:this.getData().level+1}),this.game.localStorage.setGameData({level:0});const e=this.getGameSize(),t=Math.random()>.5?"background-1":"background-2";this.physics.world.setBounds(0,0,e.width,e.height),this.background=this.add.image(0,0,t).setOrigin(0,0).setAlpha(.2),this.updateBackgroundColor(),this.player=new r.Player(this),this.utils=new c.Utils(this),this.rewardedModal=new h.UIRewardedModal(this,{pos:this.getGameCenter(),onProgressEnd:()=>{this.destroyPlayer()},onRewarded:()=>{this.revivePlayer(),this.services.interface.hideModalOverlay()},onCancelReward:()=>{this.destroyPlayer()},onExit:()=>{this.destroyPlayer()}}),this.initListeners(),this.initServices(),this.getSettings().isMobile&&this.initPointers(),this.shakeCamera=this.cameras.add(0,0,e.width,e.height),u=!0}initListeners(){this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.M).on("down",()=>{this.player.body.active&&(this.scene.start(l.ESceneName.menu),this.setData("level",0))})}initServices(){this.services={stars:new o.StarsService(this,{count:20}),meteors:new o.MeteorsService(this,{}),interface:new o.InterfaceService(this,{}),level:new o.LevelService(this,{}),comets:new o.CometsService(this,{}),bonuses:new o.BonusesService(this,{}),logger:new o.LoggerService(this,{}),firefly:new o.FireflyService(this,{})}}initPointers(){const e=this.getGameSize();u||this.input.addPointer(1),this.input.on("pointerdown",t=>{const s=new Phaser.Geom.Circle(i.mainConfig.touch.areaOffset,e.height-i.mainConfig.touch.areaOffset,i.mainConfig.touch.areaSize),a=(new Phaser.Geom.Circle(e.width-i.mainConfig.touch.areaOffset,e.height-i.mainConfig.touch.areaOffset,i.mainConfig.touch.areaSize),new Phaser.Geom.Circle(t.x,t.y,i.mainConfig.touch.pointerRadius));Phaser.Geom.Intersects.CircleToCircle(s,a)?this.player.setPointer("left",t):this.player.setPointer("right",t)},this),this.input.on("pointerup",e=>{this.player.pointers.left===e&&this.player.onLeftPointerUp(),this.player.pointers.right===e&&this.player.onRightPointerUp()},this)}update(e,t){var s;this.updateSceneTime(e,t),this.rewardedModal.update(),this.isPaused||(this.deltaTime=t/i.mainConfig.scene.delta,this.gameTime+=15*this.deltaTime,this.enemies.forEach(s=>{s.act(e,t)}),this.bullets.forEach(s=>{s.act(e,t)}),this.effects.forEach(e=>{e.act()}),Object.keys(this.services).forEach(s=>{this.services[s].act(e,t)}),this.bonuses.forEach(e=>{e.act()}),this.instances.forEach(s=>{s.act(e,t)}),null===(s=this.boss)||void 0===s||s.act(e,t),this.player.act(e,t))}resetState(){this.bullets=[],this.enemies=[],this.effects=[],this.bonuses=[],this.instances=[],this.boss=null,this.score=0,this.text="",this.lives=2,this.stats=d.getInitialGameStats(),this.isWon=!1,this.isFail=!1,this.isPaused=!1,this.gameTime=0}onFail(){this.isFail=!0,setTimeout(()=>{this.scene.start(l.ESceneName.fail)},i.mainConfig.scene.failTimeoutTime)}onWin(){this.isWon||this.isFail||(this.isWon=!0,setTimeout(()=>{this.isFail||this.scene.start(l.ESceneName.win,{score:this.score,isFlawlessVictory:this.player.hp===this.player.maxHp})},i.mainConfig.scene.winTimeoutTime))}onPlayerDestroy(){this.services.interface.draw(),this.isFail=!0,this.lives>0?(this.lives-=1,this.showFailRewardedModal()):this.player.destroy()}destroyPlayer(){this.isPaused=!1,this.player.destroy(),this.services.interface.hideModalOverlay(),this.rewardedModal.hide()}showFailRewardedModal(){this.isPaused=!0,this.services.interface.showModalOverlay(),this.rewardedModal.show()}revivePlayer(){this.isPaused=!1,this.isFail=!1,this.isWon=!1,this.rewardedModal.hide(),this.player.revive()}shakeScreen(){this.shakeCamera.shake(500,.003)}updateBackgroundColor(){this.background.setTint(a.getRandomHexColor(),a.getRandomHexColor(),a.getRandomHexColor(),a.getRandomHexColor())}isBoosterActive(){return null!==this.player.currentBooster}getLevelMode(){const e=this.getData().level;return i.levelsConfig.levels[e].mode}getActiveBooster(){return this.player.currentBooster}getStats(){return this.stats}}t.GameScene=m},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=t.BonusesService=t.FireflyService=t.CometsService=t.LevelService=t.InterfaceService=t.LoggerService=t.MeteorsService=t.StarsService=void 0;var i=s(129);Object.defineProperty(t,"StarsService",{enumerable:!0,get:function(){return i.StarsService}});var a=s(131);Object.defineProperty(t,"MeteorsService",{enumerable:!0,get:function(){return a.MeteorsService}});var o=s(133);Object.defineProperty(t,"LoggerService",{enumerable:!0,get:function(){return o.LoggerService}});var n=s(134);Object.defineProperty(t,"InterfaceService",{enumerable:!0,get:function(){return n.InterfaceService}});var r=s(135);Object.defineProperty(t,"LevelService",{enumerable:!0,get:function(){return r.LevelService}});var h=s(156);Object.defineProperty(t,"CometsService",{enumerable:!0,get:function(){return h.CometsService}});var l=s(158);Object.defineProperty(t,"FireflyService",{enumerable:!0,get:function(){return l.FireflyService}});var c=s(160);Object.defineProperty(t,"BonusesService",{enumerable:!0,get:function(){return c.BonusesService}});var d=s(11);Object.defineProperty(t,"Service",{enumerable:!0,get:function(){return d.Service}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarsService=void 0;const i=s(130),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.stars=[],this.params=t,this.init()}init(){const{scene:e}=this,{count:t}=this.params;for(let s=0;s<t;s++)this.stars.push(new i.Star(e,{initialAlphaCoef:500*s}))}act(e,t){this.update(e,t)}update(e,t){this.stars.forEach(s=>{s.act(e,t)})}}t.StarsService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Star=void 0;t.Star=class{constructor(e,t){const s=e.getGameSize();this.scene=e,this.body=e.ui.drawImage({x:Math.random()*s.width,y:Math.random()*s.height,texture:"star"}),this.initialCoef=t.initialAlphaCoef,this.body.setDepth(0),this.body.setScale(.25+.25*Math.random())}act(e,t){this.update(e,t)}update(e,t){const{scene:s,body:i,initialCoef:a,lastRelocationTime:o}=this,n=s.gameTime;i.angle+=4*s.deltaTime,i.alpha=Math.sin((n+a)/1500);const r=this.scene.getGameSize();n>o&&i.alpha<=.5&&(i.x=Math.random()*r.width,i.y=Math.random()*r.height,this.lastRelocationTime=n+1e3)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MeteorsService=void 0;const i=s(3),a=s(132),o=s(1),n=s(11);class r extends n.Service{constructor(e,t){super(e),this.meteors=[],this.meteorIntervalTime=1e3,this.meteorIntervalTimeRange=1e3,this.lastMeteorTime=0,this.maxCount=25,this.params=t,this.init()}init(){for(let e=0;e<o.getRandomInt(5,8);e++)this.spawnMeteor({outside:!1});for(let e=0;e<o.getRandomInt(3,5);e++)this.spawnMeteor({outside:!0})}act(e,t){this.update(e,t)}update(e,t){const s=this.scene.getGameSize(),{scene:i,maxCount:a}=this,{deltaTime:o,gameTime:n}=i;n>this.lastMeteorTime&&this.meteors.length<a&&this.spawnMeteor({outside:!0}),this.meteors.forEach(e=>{const{body:t,speed:i}=e;t.angle+=.5*i.x*o,t.x+=i.x*o,t.y+=i.y*o,(t.x>s.width+200||t.y>s.height+200)&&(this.meteors=this.meteors.filter(t=>t!==e),t.destroy())})}spawnMeteor({outside:e}){const{scene:t,meteorIntervalTime:s,meteorIntervalTimeRange:n}=this,r=t.gameTime,h=.5+1*Math.random(),l=this.scene.getGameSize(),c=o.angleToRadians(45),d=.25+2.5*Math.random(),u=new i.Vector(d*Math.cos(c),d*Math.sin(c)),m=Math.random()>.5?"x":"y",p=e?{x:"x"===m?Math.random()*(.75*l.width)-200:-200,y:"y"===m?Math.random()*(.75*l.height)-200:-200}:{x:l.width*Math.random(),y:l.height*Math.random()};this.meteors.push(new a.Meteor(t,p,u,{spriteIndex:1+Math.floor(4*Math.random()),alpha:.25+.4*Math.random(),scale:h})),this.lastMeteorTime=Math.random()*n+r+s*h}}t.MeteorsService=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Meteor=void 0;t.Meteor=class{constructor(e,t,s,i){this.scene=e,this.body=e.ui.drawImage({x:t.x,y:t.y,texture:"meteor-"+i.spriteIndex}),this.speed=s,this.body.setAlpha(i.alpha),this.body.setDepth(5),this.body.setScale(i.scale,i.scale)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerService=void 0;const i=s(5),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.lastLogTime=0,this.params=t,this.init()}init(){}act(){this.update()}update(){const e=this.scene,t=e.gameTime;t>this.lastLogTime&&i.IS_DEV&&(console.group("Stats"),console.log("effects: "+e.effects.length),console.log("enemies: "+e.enemies.length),console.log("bullets: "+e.bullets.length),console.groupEnd(),console.log("Total kills: ",e.getStats().kills),this.lastLogTime=t+2e3)}}t.LoggerService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InterfaceService=void 0;const i=s(5),a=s(4),o=s(3),n=s(0),r=s(21),h=s(11),l={[n.EBoosterType.damage]:a.colors.red,[n.EBoosterType.speed]:a.colors.yellow,[n.EBoosterType.regenerator]:a.colors.green,[n.EBoosterType.shield]:a.colors.aqua};class c extends h.Service{constructor(e,t){super(e),this.backgroundParams={initialAlpha:0,changeTime:15e3,canChangeColor:!1},this.params=t,this.init()}init(){const{scene:e}=this,t=this.scene.getGameSize();this.graphics=e.add.graphics({lineStyle:{width:2,color:65280},fillStyle:{color:16775926}}),this.graphicsOverlay=e.add.graphics({fillStyle:{color:a.colors.gray2}}),this.graphicsOverlay.setDepth(a.depths.overlay),this.graphicsOverlay.setAlpha(.5),this.counterText=this.scene.ui.drawBitmapText({x:t.width-21,y:34,text:"0",fontSize:24,origin:[1,.5],depth:a.depths.graphics,letterSpacing:3}),this.debugText=this.scene.ui.drawBitmapText({x:20,y:66,text:"",fontSize:16,origin:[0,.5],depth:a.depths.graphics}),this.cosmonsText=this.scene.ui.drawCosmons({x:243,y:30,value:0,isCentered:!1,depth:a.depths.graphics}),this.playerHealthbar=new Phaser.Geom.Rectangle(20,27,t.width,11),this.bossHealthbar=new Phaser.Geom.Rectangle(t.width-200-20,27,t.width,11),this.graphics.setDepth(a.depths.graphics),this.initBooster(),this.boosterCircleProgress=new r.UICircleProgress(this.scene,{pos:new o.Vector(261,32)}),this.backgroundParams.initialAlpha=Math.random()*(5*this.backgroundParams.changeTime),e.getSettings().isMobile&&this.initTouchAreas()}initExperimentralAngleControls(){const e=this.scene.player,t=this.scene.getGameSize(),s=t.width-i.mainConfig.touch.areaOffset,o=t.height-i.mainConfig.touch.areaOffset,n=this.scene.ui.drawImage({x:s,y:o,texture:"control-arrow-left",scale:.25}).setDepth(a.depths.graphics).setInteractive(),r=this.scene.ui.drawImage({x:t.width-i.mainConfig.touch.areaOffset-100,y:t.height-i.mainConfig.touch.areaOffset,texture:"control-arrow-left",scale:.25}).setDepth(a.depths.graphics).setInteractive().setFlipX(!0);r.on("pointerover",(function(t){e.setAutoRotate(-1)})),r.on("pointerout",(function(t){e.setAutoRotate(0)})),n.on("pointerover",(function(t){e.setAutoRotate(1)})),n.on("pointerout",(function(t){e.setAutoRotate(0)}))}initBooster(){const e=this.scene.add.graphics({lineStyle:{width:2,color:16763904}}).setDepth(a.depths.graphics),t=this.scene.ui.drawImage({x:261,y:32,texture:"bonus-speed",scale:.6,depth:a.depths.graphics}),s=new Phaser.Geom.Circle(400,300,50);this.booster={graphics:e,image:t,progressCircle:s}}initTouchAreas(){const e=this.scene.getGameSize();this.scene.ui.drawImage({x:i.mainConfig.touch.areaOffset,y:e.height-i.mainConfig.touch.areaOffset,texture:"touch-area",scale:.022*i.mainConfig.touch.areaSize}),this.scene.ui.drawImage({x:e.width-i.mainConfig.touch.areaOffset,y:e.height-i.mainConfig.touch.areaOffset,texture:"touch-area",scale:.022*i.mainConfig.touch.areaSize})}act(){this.draw(),this.update()}draw(){const{scene:e,graphics:t}=this,{player:s,boss:i}=e;t.clear(),this.booster.graphics.clear(),this.drawStatus(),this.drawHealthbar({firstColor:a.colors.green,secondColor:a.colors.red,healthbarRect:this.playerHealthbar,hp:s.hp,maxHp:s.maxHp}),i&&this.drawHealthbar({firstColor:a.colors.white,secondColor:a.colors.red,healthbarRect:this.bossHealthbar,hp:i.hp,maxHp:i.maxHp,fromLeft:!0}),this.drawCosmons(),this.drawBoosters(),e.getSettings().isMobile&&this.drawPointers(),this.drawDebugPanel()}update(){this.updateBackground()}updateBackground(){const{scene:e,backgroundParams:t}=this,s=.25*(1+Math.sin((t.initialAlpha+e.gameTime)/t.changeTime));s>.4?this.backgroundParams.canChangeColor=!0:this.backgroundParams.canChangeColor&&s<.01&&(this.backgroundParams.canChangeColor=!1,e.updateBackgroundColor()),e.background.setAlpha(s)}drawStatus(){const{scene:e,counterText:t}=this;i.levelsConfig.levels[e.getData().level].mode.type!==n.EGameMode.boss?t.setText(e.text):t.setText("")}drawHealthbar(e){const{graphics:t}=this,{healthbarRect:s,firstColor:i,secondColor:o,hp:n,maxHp:r}=e;let h=n/r;e.fromLeft&&(h=1-h),t.fillStyle(o),s.width=200,t.fillRectShape(s),t.fillStyle(i),s.width=Math.max(200*h,0),t.fillRectShape(s),t.lineStyle(2,a.colors.white),s.width=200,t.strokeRectShape(s)}drawCosmons(){const{scene:e,cosmonsText:t}=this;t.updateValue(e.score),e.isBoosterActive()?t.updatePosition(new o.Vector(295,30)):t.updatePosition(new o.Vector(243,30))}drawBoosters(){const{scene:e,booster:t}=this,{gameTime:s,player:i}=e;if(e.isBoosterActive()){t.image.visible=!0;const a=e.getActiveBooster()||"";t.image.setTexture(a);const o=(i.boosterParams.endTime-s)/(1e3*i.bonusesTime);this.boosterCircleProgress.update({percentage:o,color:l[a]})}else t.image.visible=!1,this.boosterCircleProgress.hide()}drawPointers(){const{graphics:e,scene:t}=this,s=t.player.pointers,a=this.scene.input.pointer1,o=this.scene.input.pointer2;!a.isDown||s.left!==a&&s.right!==a||e.strokeCircle(a.x,a.y,i.mainConfig.touch.pointerSize),!o.isDown||s.left!==o&&s.right!==o||e.strokeCircle(o.x,o.y,i.mainConfig.touch.pointerSize)}drawDebugPanel(){const{scene:e}=this;e.getQueryParam("fps")&&this.debugText.setText("FPS: "+this.scene.game.loop.actualFps.toFixed(2))}showModalOverlay(){const{graphicsOverlay:e,scene:t}=this,s=t.getGameSize(),i=new Phaser.Geom.Rectangle(0,0,s.width,s.height);e.fillRectShape(i)}hideModalOverlay(){const{graphicsOverlay:e}=this;e.clear()}}t.InterfaceService=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LevelService=void 0;const i=s(136),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.params=t,this.init()}init(){const{scene:e}=this,t=e.getData().level;this.currentLevel=new i.levels[t](e)}act(){this.update()}update(){const{scene:e,currentLevel:t}=this,s=t.checkForWin();e.text=t.getTextByMode(),t.update(),s&&e.onWin()}}t.LevelService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.levels=void 0;const i=s(137),a=s(144),o=s(145),n=s(146),r=s(147),h=s(148),l=s(149),c=s(150),d=s(151),u=s(152),m=s(153),p=s(154),g=s(155);t.levels=[i.Level1,a.Level2,o.Level3,n.Level4,r.Level5,h.Level6,l.Level7,c.Level8,d.Level9,u.Level10,m.Level11,p.Level12,g.Level13]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level1=void 0;const i=s(5),a=s(9),o=s(8);class n extends o.Level{constructor(e){super(e,0);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[0];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&e.utils.createEnemy(a.Bot)}}t.Level1=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BossMode=t.WavesMode=t.TimeMode=t.EnemyKillsMode=t.TotalKillsMode=t.Mode=void 0;var i=s(17);Object.defineProperty(t,"Mode",{enumerable:!0,get:function(){return i.Mode}});var a=s(139);Object.defineProperty(t,"TotalKillsMode",{enumerable:!0,get:function(){return a.TotalKillsMode}});var o=s(140);Object.defineProperty(t,"EnemyKillsMode",{enumerable:!0,get:function(){return o.EnemyKillsMode}});var n=s(141);Object.defineProperty(t,"TimeMode",{enumerable:!0,get:function(){return n.TimeMode}});var r=s(142);Object.defineProperty(t,"WavesMode",{enumerable:!0,get:function(){return r.WavesMode}});var h=s(143);Object.defineProperty(t,"BossMode",{enumerable:!0,get:function(){return h.BossMode}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TotalKillsMode=void 0;const i=s(17);class a extends i.Mode{getStatus(){const e=this.scene.getStats(),t=Number(this.modeParams.target);return{value:t-e.totalKills,text:`${e.totalKills}/${t}`}}}t.TotalKillsMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnemyKillsMode=void 0;const i=s(17);class a extends i.Mode{getStatus(){const e=this.scene.getStats(),t=this.modeParams.target,s=Object.values(t).reduce((e,t)=>e+t,0),i=Object.keys(t).reduce((s,i)=>{const a=t[i];return s+Math.min(a,e.kills[i]||0)},0);return{value:s-i,text:`${i}/${s}`}}}t.EnemyKillsMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeMode=void 0;const i=s(17);class a extends i.Mode{getStatus(){const e=Math.ceil(this.scene.gameTime/1e3);return{value:Number(this.modeParams.target)-e,text:`${e}/${this.modeParams.target}`}}}t.TimeMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavesMode=void 0;const i=s(17);class a extends i.Mode{constructor(e,t){super(e,t),this.waveNumber=0,this.maxEnemies=0,this.setLevelState(0)}setLevelState(e){const t=this.scene.getSettings().isMobile,s=this.modeParams;if(e>=s.target.length)this.waveNumber=e,this.enemies=[],this.maxEnemies=0;else{const i=s.target[e].maxEnemies;this.waveNumber=e,this.enemies=[...s.target[e].enemies],this.maxEnemies=t?i-1:i}}getStatus(){const e=this.modeParams.target.length;return{value:e-this.waveNumber,text:`${Math.min(e,this.waveNumber+1)}/${e}`}}spawn(){const{maxEnemies:e,enemies:t}=this,s=this.modeParams.target.length,i=this.scene.enemies.length;if(i<e){const e=t.shift();e?this.scene.utils.createEnemy(e):i<=0&&this.waveNumber<s&&this.setLevelState(this.waveNumber+1)}}}t.WavesMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BossMode=void 0;const i=s(17);class a extends i.Mode{constructor(e,t){super(e,t),this.spawnBoss()}spawnBoss(){const{scene:e}=this,t=new this.modeParams.target(e);e.boss=t}getStatus(){const e=this.scene.boss.hp;return{value:e,text:`${e}/${this.scene.boss.maxHp}`}}}t.BossMode=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level2=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,1);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[1];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,s=[a.Bot];return Math.random()>.25&&t<1&&s.push(a.Hunter),s}}t.Level2=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level3=void 0;const i=s(5),a=s(9),o=s(0),n=s(8);class r extends n.Level{constructor(e){super(e,2);const t=e.getSettings().isMobile,s=i.levelsConfig.levels[2];this.maxEnemiesCount=t?s.maxEnemies-1:s.maxEnemies}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<this.maxEnemiesCount&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===o.EEnemyName.hunter).length,s=e.enemies.filter(e=>e.name===o.EEnemyName.ufo).length,i=[a.Bot];return Math.random()>.5&&(t<1&&i.push(a.Hunter),s<1&&i.push(a.UFO)),i}}t.Level3=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level4=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,3)}update(){super.update()}spawn(){}}t.Level4=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level5=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,4)}spawn(){}}t.Level5=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level6=void 0;const i=s(9),a=s(0),o=s(8);class n extends o.Level{constructor(e){super(e,5)}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<4&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===a.EEnemyName.bot).length,s=e.enemies.filter(e=>e.name===a.EEnemyName.hunter).length,o=e.enemies.filter(e=>e.name===a.EEnemyName.ufo).length,n=e.enemies.filter(e=>e.name===a.EEnemyName.flyer).length,r=[];return t<1&&r.push(i.Bot),s<1&&r.push(i.Hunter),o<1&&r.push(i.UFO),n<1&&r.push(i.Flyer),t>0&&s<2&&Math.random()>.4&&r.push(i.Hunter),t>0&&o<2&&Math.random()>.4&&r.push(i.UFO),r}}t.Level6=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level7=void 0;const i=s(9),a=s(0),o=s(8);class n extends o.Level{constructor(e){super(e,6)}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<4&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===a.EEnemyName.bot).length,s=e.enemies.filter(e=>e.name===a.EEnemyName.hunter).length,o=e.enemies.filter(e=>e.name===a.EEnemyName.ufo).length,n=e.enemies.filter(e=>e.name===a.EEnemyName.flyer).length,r=e.enemies.filter(e=>e.name===a.EEnemyName.destroyer).length,h=[];return t<1&&Math.random()>.5&&h.push(i.Bot),s<1&&h.push(i.Hunter),o<1&&h.push(i.UFO),n<1&&h.push(i.Flyer),r<1&&h.push(i.Destroyer),n<2&&Math.random()>.4&&h.push(i.Flyer),r>0&&s<2&&Math.random()>.6&&h.push(i.Hunter),r>0&&o<2&&Math.random()>.6&&h.push(i.UFO),h}}t.Level7=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level8=void 0;const i=s(9),a=s(0),o=s(8);class n extends o.Level{constructor(e){super(e,7)}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<4&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=this.getAvailableEnemies(),s=t[Math.floor(Math.random()*t.length)];e.utils.createEnemy(s)}getAvailableEnemies(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===a.EEnemyName.hunter).length,s=e.enemies.filter(e=>e.name===a.EEnemyName.ufo).length,o=e.enemies.filter(e=>e.name===a.EEnemyName.flyer).length,n=e.enemies.filter(e=>e.name===a.EEnemyName.destroyer).length,r=e.enemies.filter(e=>e.name===a.EEnemyName.stealth).length,h=[];return r<1&&h.push(i.Stealth),t<1&&h.push(i.Hunter),s<1&&h.push(i.UFO),o<1&&h.push(i.Flyer),n<1&&h.push(i.Destroyer),r>0&&o<2&&h.push(i.Flyer),r>0&&n<2&&h.push(i.Destroyer),h}}t.Level8=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level9=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,8)}update(){super.update()}spawn(){}}t.Level9=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level10=void 0;const i=s(8);class a extends i.Level{constructor(e){super(e,9)}spawn(){}}t.Level10=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level11=void 0;const i=s(9),a=s(0),o=s(8);class n extends o.Level{constructor(e){super(e,10)}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<4&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===a.EEnemyName.flyer).length,s=e.enemies.filter(e=>e.name===a.EEnemyName.destroyer).length,o=e.enemies.filter(e=>e.name===a.EEnemyName.missileCarrier).length,n=Math.random();n>.75&&s<2?e.utils.createEnemy(i.Destroyer):n>.5&&t<2?e.utils.createEnemy(i.Flyer):n>.25&&o<2?e.utils.createEnemy(i.MissileCarrier):e.utils.createEnemy(i.Hunter)}}t.Level11=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level12=void 0;const i=s(9),a=s(0),o=s(8);class n extends o.Level{constructor(e){super(e,11)}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<5&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===a.EEnemyName.flyer).length,s=e.enemies.filter(e=>e.name===a.EEnemyName.missileCarrier).length,o=e.enemies.filter(e=>e.name===a.EEnemyName.laserShip).length,n=Math.random();n>.6&&o<2?e.utils.createEnemy(i.LaserShip):n>.3&&s<2?e.utils.createEnemy(i.MissileCarrier):n>.25&&t<2?e.utils.createEnemy(i.Flyer):n>.1?e.utils.createEnemy(i.Destroyer):e.utils.createEnemy(i.Stealth)}}t.Level12=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Level13=void 0;const i=s(9),a=s(0),o=s(8);class n extends o.Level{constructor(e){super(e,12)}spawn(){const{scene:e}=this,{enemies:t}=e;t.length<5&&this.spawnEnemy()}spawnEnemy(){const{scene:e}=this,t=e.enemies.filter(e=>e.name===a.EEnemyName.flyer).length,s=e.enemies.filter(e=>e.name===a.EEnemyName.missileCarrier).length,o=e.enemies.filter(e=>e.name===a.EEnemyName.laserShip).length,n=e.enemies.filter(e=>e.name===a.EEnemyName.defender).length,r=Math.random();r>.6&&n<2?e.utils.createEnemy(i.Defender):r>.5&&o<2?e.utils.createEnemy(i.LaserShip):r>.3&&s<2?e.utils.createEnemy(i.MissileCarrier):r>.25&&t<2?e.utils.createEnemy(i.Flyer):r>.1?e.utils.createEnemy(i.Destroyer):e.utils.createEnemy(i.Stealth)}}t.Level13=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CometsService=void 0;const i=s(157),a=s(11);class o extends a.Service{constructor(e,t){super(e),this.comets=[],this.count=15,this.params=t,this.init()}init(){const{scene:e,count:t}=this;for(let s=0;s<t;s++)this.comets.push(new i.Comet(e,{}))}act(e,t){this.update(e,t)}update(e,t){const s=this.scene.getGameSize(),{deltaTime:i}=this.scene;this.comets.forEach(e=>{const{body:t}=e;t.y+=e.speed*i,t.y>s.height+100&&(e.updateParams(),e.refreshPosition())})}}t.CometsService=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Comet=void 0;const i=s(1);t.Comet=class{constructor(e,t){this.speed=3;const s=e.getGameSize();this.scene=e,this.body=e.ui.drawImage({x:i.getRandomInt(0,s.width),y:i.getRandomInt(0,s.height),texture:"comet"}),this.updateParams()}updateParams(){const{body:e}=this;e.setAlpha(.03+.1*Math.random()),e.setScale(.2,.75+.5*Math.random()),this.speed=i.getRandomInt(3,7)}refreshPosition(){const{body:e}=this,t=this.scene.getGameSize();e.x=i.getRandomInt(0,t.width),e.y=-100}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FireflyService=void 0;const i=s(5),a=s(3),o=s(159),n=s(11);class r extends n.Service{constructor(e,t){super(e),this.nextSpawnTime=0,this.fireflyersCreatedCount=0,this.params=t,this.updateNextSpawnTime()}act(e,t){this.update(e,t)}update(e,t){const{scene:s}=this,{gameTime:a}=s;this.scene.getStats();this.fireflyersCreatedCount<i.fireflyConfig.maxCountPerLevel&&a>=this.nextSpawnTime&&(this.spawnFirefly(),this.updateNextSpawnTime())}updateNextSpawnTime(e=i.fireflyConfig.spawnTimeInterval,t=i.fireflyConfig.spawnTimeIntervalRange){const{scene:s}=this,{gameTime:a}=s;this.nextSpawnTime=a+e+t*Math.random()}spawnFirefly(){const{scene:e}=this,t=this.scene.getGameSize(),s=new o.Firefly(e,{pos:new a.Vector(t.width*Math.random(),t.height*Math.random())});this.fireflyersCreatedCount+=1,this.scene.instances.push(s)}}t.FireflyService=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Firefly=void 0;const i=s(5),a=s(3),o=s(1),n=s(0),r=s(35);t.Firefly=class{constructor(e,t){this.targetTimeInterval=i.fireflyConfig.targetTimeInterval,this.targetTimeIntervalRange=i.fireflyConfig.targetTimeIntervalRange,this.hp=i.fireflyConfig.hp,this.scale=i.fireflyConfig.scale,this.bodySize=i.fireflyConfig.bodySize,this.speed=i.fireflyConfig.speed,this.rotateSpeed=i.fireflyConfig.rotateSpeed,this.angle=0,this.targetAngle=0,this.lastChangeTargetTime=0,this.lifeTime=0,this.scene=e,this.params=t,this.init()}init(){const{scene:e,params:t,scale:s}=this,a=e.gameTime;this.body=e.physics.add.image(t.pos.x,t.pos.y,"firefly"),this.body.setScale(s),this.body.setDepth(i.fireflyConfig.depth),this.body.setImmovable(!0),this.body.setAlpha(0),this.lifeTime=a+i.fireflyConfig.lifeTime+Math.random()*i.fireflyConfig.lifeTimeRange,this.initCollisions()}initCollisions(){const{scene:e}=this;e.bullets.forEach(t=>{e.physics.add.collider(this.body,t.body,()=>{t.owner===n.EOwner.player&&this.hit()})})}act(e,t){this.update(e,t)}update(e,t){const{scene:s,lifeTime:a}=this,o=s.gameTime;o>this.lastChangeTargetTime&&this.updateTarget(),this.updateBase(e,t),this.updateBodySize(),o>=a?this.body.alpha>i.fireflyConfig.alphaChange?this.body.setAlpha(this.body.alpha-i.fireflyConfig.alphaChange*s.deltaTime):this.destroy():this.body.alpha<1&&this.body.setAlpha(this.body.alpha+i.fireflyConfig.alphaChange*s.deltaTime)}updateBase(e,t){const{scene:s,body:i,angle:a,targetAngle:n,rotateSpeed:r}=this;this.body.angle=a-90;const h=o.angleToRadians(a);i.x+=this.speed*Math.cos(h)*s.deltaTime,i.y+=this.speed*Math.sin(h)*s.deltaTime,this.angle=o.getNearestAngle(a,n,r*s.deltaTime)}updateBodySize(){const{scene:e,scale:t,bodySize:s}=this,{gameTime:i}=e,a=t+.02*Math.sin(i/200);this.body.setScale(a);const n=o.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,a,s);this.body.setCircle(s,n.x,n.y)}updateTarget(){const{scene:e,targetTimeInterval:t,targetTimeIntervalRange:s}=this,i=e.gameTime;this.defineTarget();const a=t+Math.random()*s;this.lastChangeTargetTime=i+a}defineTarget(){const e=this.scene.utils.getRandomPos(10,20);this.setTarget(e)}setTarget(e){const{body:t}=this;this.targetAngle=o.getAngleBetweenPointsInDegrees(e,t)}onHit(){this.speed+=i.fireflyConfig.increaseSpeedOnHit,this.targetTimeInterval-=i.fireflyConfig.decreaseTargetTimeIntervalOnHit,this.targetTimeIntervalRange-=i.fireflyConfig.decreaseTargetTimeIntervalRangeOnHit,this.updateTarget()}hit(){const{scene:e,body:t}=this;this.hp-=1,this.onHit(),this.hp<=0&&(this.destroy(),e.effects.push(new r.FireflyExplode(e,{pos:new a.Vector(t.x,t.y),scale:t.scale})))}destroy(){const{body:e}=this;this.scene.instances=this.scene.instances.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BonusesService=void 0;const i=s(5),a=s(3),o=s(161),n=s(38),r=s(1),h=s(11);class l extends h.Service{constructor(e,t){super(e),this.prevTotalKills=0,this.params=t,this.init()}init(){this.updateNextSpawnTime()}act(e,t){this.update(e,t)}update(e,t){const{scene:s}=this,{gameTime:i}=s;if(i>=this.nextSpawnTime){const e=s.getStats().totalKills;e-2+1>this.prevTotalKills&&"boss"!==this.scene.getLevelMode().type&&(this.spawnBonus(),this.prevTotalKills=e),this.updateNextSpawnTime()}}spawnBonus(){const{scene:e}=this,t=e.getGameSize(),s=n.boosters[r.getRandomInt(0,3)];e.bonuses.push(new o.Booster(e,new a.Vector(r.getRandomInt(50,t.width-50),r.getRandomInt(100,t.height-50)),s))}updateNextSpawnTime(){const{scene:e}=this,{gameTime:t}=e,s=1e3*i.boostersConfig.spawnIntervalRangeTime,a=1e3*i.boostersConfig.spawnAdditionalTime+1e3*e.player.bonusesTime;this.nextSpawnTime=t+a+Math.random()*s}}t.BonusesService=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Booster=t.Bonus=void 0;var i=s(27);Object.defineProperty(t,"Bonus",{enumerable:!0,get:function(){return i.Bonus}});var a=s(38);Object.defineProperty(t,"Booster",{enumerable:!0,get:function(){return a.Booster}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const i=s(5),a=s(3),o=s(0),n=s(18),r=s(0),h=s(1);let l,c,d,u;t.Player=class{constructor(e){this.scale=.6,this.bodySize=26,this.bulletSpeed=10,this.maxHp=0,this.hp=0,this.movementSpeed=0,this.attackSpeed=0,this.damage=0,this.explosionResistance=0,this.bonusesTime=0,this.fortune=0,this.lastFireTime=0,this.lastAttackTime=0,this.angle=0,this.immortalityTime=0,this.autoRotate=0,this.pointers={left:null,right:null},this.prevPointersPos={left:{x:0,y:0},right:{x:0,y:0}},this.pointerValues={isLeftTouched:!1,isRightTouched:!1,left:{x:0,y:0},right:{x:0,y:0}},this.currentBooster=null,this.boosterParams={endTime:0,nextShadowTime:0,nextRegenerationTime:0},this.shieldBodySize=80,this.scene=e;const t=this.scene.getGameSize();this.body=this.scene.physics.add.image(t.width/2,t.height/2,"player-ship"),this.lastAttackTime=e.gameTime+100,this.init(),this.initProperties()}init(){const{scene:e,scale:t}=this;this.body.setScale(t),this.body.setDepth(100),this.body.setImmovable(!0),this.initShield(),l=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),c=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),d=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),u=e.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W)}initProperties(){const e=this.scene.getData();this.maxHp=i.playerConfig.maxHealth+i.storeConfig.products.maxHealth.valuePerLevel*e.store.maxHealth,this.hp=this.maxHp,this.movementSpeed=i.playerConfig.movementSpeed+i.storeConfig.products.movementSpeed.valuePerLevel*e.store.movementSpeed,this.attackSpeed=i.playerConfig.attackSpeed-i.storeConfig.products.attackSpeed.valuePerLevel*e.store.attackSpeed,this.damage=i.playerConfig.damage+i.storeConfig.products.damage.valuePerLevel*e.store.damage,this.explosionResistance=i.playerConfig.explosionResistance+i.storeConfig.products.explosionResistance.valuePerLevel*e.store.explosionResistance,this.bonusesTime=i.playerConfig.bonusesTime+i.storeConfig.products.bonusesTime.valuePerLevel*e.store.bonusesTime,this.fortune=i.playerConfig.fortune+i.storeConfig.products.fortune.valuePerLevel*e.store.fortune,h.debugLog("player",this)}initShield(){this.shieldBody=this.scene.physics.add.image(300,300,"shield"),this.shieldBody.setImmovable(!0)}act(e,t){this.update(e,t)}update(e,t){if(this.updateBoosters(e,t),!this.body.active)return;this.updateBody(e,t),this.updateShooting(e,t),this.updateMovement(e,t),this.updateAngle(e,t);const s=h.getOffsetByAngle(this.angle,i.playerConfig.bodyOffset/2);this.geomCircle=new Phaser.Geom.Circle(this.body.x+s.x,this.body.y+s.y,this.bodySize*this.scale)}updateBody(e,t){const{scale:s,bodySize:a}=this,o=h.getOffsetByAngle(this.angle,i.playerConfig.bodyOffset),n=h.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,s,a,o);this.body.setCircle(a,n.x,n.y)}updateShooting(e,t){const{scene:s,lastAttackTime:i}=this,{gameTime:a}=s;if(s.getSettings().isMobile)a>i&&this.shoot(this.angle);else{s.input.activePointer.isDown&&this.shoot(this.angle)}}updateMovement(e,t){const{scene:s,body:o,pointerValues:n,prevPointersPos:r}=this,{deltaTime:h}=s,m=this.scene.getGameSize(),{movePointerParams:p}=i.playerConfig;let g=this.movementSpeed*h;if(s.getSettings().isMobile){if(this.pointers.left&&this.pointers.left.isDown){const e=this.pointers.left,t=new a.Vector(e.x,e.y);n.isLeftTouched||(this.prevPointersPos.left={x:t.x,y:t.y},this.pointerValues.left={x:0,y:0},n.isLeftTouched=!0);const s=r.left;this.pointerValues.left.x=Math.max(Math.min(this.pointerValues.left.x+(e.x-s.x)/p.speed,p.range),-p.range),this.pointerValues.left.y=Math.max(Math.min(this.pointerValues.left.y+(e.y-s.y)/p.speed,p.range),-p.range),this.prevPointersPos.left={x:t.x,y:t.y},o.x+=this.pointerValues.left.x,o.y+=this.pointerValues.left.y}}else{const e=s.input.keyboard.createCursorKeys(),t=e.down.isDown||c.isDown,i=e.up.isDown||u.isDown,a=e.left.isDown||l.isDown,n=e.right.isDown||d.isDown;(i||t)&&(n||a)&&(g*=.8),i?o.y-=g:t&&(o.y+=g),n?o.x+=g:a&&(o.x-=g)}const y=this.body.displayWidth/2;o.x<y&&(o.x=y),o.y<i.mainConfig.scene.minYPos&&(o.y=i.mainConfig.scene.minYPos),o.x>m.width-y&&(o.x=m.width-y),o.y>m.height-y&&(o.y=m.height-y)}updateAngle(e,t){const{scene:s,body:o,pointerValues:n,prevPointersPos:r}=this,{anglePointerParams:l}=i.playerConfig,c=s.input.activePointer,d=new a.Vector(o.x,o.y);if(s.getSettings().isMobile){if(this.angle+=this.autoRotate,this.pointers.right&&this.pointers.right.isDown){const e=this.pointers.right,t=new a.Vector(e.x,e.y),s=h.getOffsetByAngle(this.angle,1);n.isRightTouched||(this.prevPointersPos.right={x:t.x,y:t.y},this.pointerValues.right={x:s.x,y:s.y},n.isRightTouched=!0);const i=r.right;this.pointerValues.right.x=Math.max(Math.min(this.pointerValues.right.x+(e.x-i.x)/l.speed,l.range),-l.range),this.pointerValues.right.y=Math.max(Math.min(this.pointerValues.right.y+(e.y-i.y)/l.speed,l.range),-l.range),this.prevPointersPos.right={x:t.x,y:t.y};const o=new a.Vector(this.pointerValues.right.x,this.pointerValues.right.y);this.angle=h.getAngleBetweenPointsInDegrees(o,new a.Vector(0,0))}}else this.angle=h.angleToDegrees(h.getAngleBetweenPointsInRadians(new a.Vector(c.x,c.y),d));this.body.angle=this.angle+90}updateBoosters(e,t){const{scene:s,boosterParams:a}=this,{gameTime:o}=s;this.currentBooster===r.EBoosterType.speed&&o>a.nextShadowTime&&(this.createShadow(),this.boosterParams.nextShadowTime=o+i.playerConfig.shadowIntervalTime),this.currentBooster===r.EBoosterType.regenerator&&o>a.nextRegenerationTime&&(a.nextRegenerationTime=o+1e3,this.updateHp(i.boostersConfig.types.regenerator.hpPerSecond),this.hp>=this.maxHp&&this.destroyBooster()),this.updateShieldBooster(),o>a.endTime&&this.destroyBooster()}updateShieldBooster(){const{shieldBodySize:e}=this;this.shieldBody.x=this.body.x,this.shieldBody.y=this.body.y,this.shieldBody.angle=this.body.angle;const t=h.getOffsetByRadians(h.angleToRadians(this.angle)+Math.PI,25),s=h.getBodyPosWithOffset(this.shieldBody.displayWidth,this.shieldBody.displayHeight,1,e,t);this.shieldBody.setCircle(e,s.x,s.y),this.shieldBody.visible=this.currentBooster===r.EBoosterType.shield}shoot(e){const{scene:t,body:s,bulletSpeed:i,damage:n}=this,{gameTime:r}=t;r>this.lastAttackTime&&(this.scene.utils.createSphereBullet({pos:new a.Vector(s.x,s.y),owner:o.EOwner.player,speed:i,angle:e,sprite:"laser-green",explodeSprite:"explode-green",damage:n}),this.lastAttackTime=r+this.attackSpeed)}hit(e,t={}){const{type:s}=t,{scene:i,immortalityTime:a}=this;if(i.gameTime<a)return;let o=e;"explode"===s&&(o=Math.round(e-e*(this.explosionResistance/100))),h.debugLog("damage",o),this.updateHp(-o),this.hp<=0&&!i.getQueryParam("immortality",!0)&&this.scene.onPlayerDestroy()}createShadow(){const{scene:e,body:t,scale:s}=this;e.effects.push(new n.Shadow(e,{pos:new a.Vector(t.x,t.y),sprite:"player-ship",lifeTime:250,scale:s,angle:this.angle+90,alpha:.4}))}setPointer(e,t){this.pointers[e]=t}setBooster(e){const{gameTime:t}=this.scene;switch(this.destroyBooster(),this.currentBooster=e,this.boosterParams.endTime=t+1e3*this.bonusesTime,e){case r.EBoosterType.speed:this.movementSpeed+=i.boostersConfig.types.speed.additionalSpeed;break;case r.EBoosterType.damage:this.damage*=i.boostersConfig.types.damage.additionalXDamage;break;case r.EBoosterType.regenerator:this.boosterParams.nextRegenerationTime=t+1e3}}setAutoRotate(e){this.autoRotate=e*(this.scene.game.settings.queryParams["rotation-speed"]||4)}updateHp(e){this.hp=Math.max(Math.min(this.maxHp,this.hp+e),0)}hitShield(e){if(this.currentBooster===r.EBoosterType.shield){const t=new a.Vector(e.body.x,e.body.y),s=new a.Vector(this.body.x,this.body.y),i=h.getDistanceBetweenPoints(t,s),o=h.getAngleDiff(this.angle,e.getAngle());i<70&&o>45&&e.explode()}}destroyBooster(){const{currentBooster:e}=this;switch(e){case r.EBoosterType.speed:this.movementSpeed-=i.boostersConfig.types.speed.additionalSpeed;break;case r.EBoosterType.damage:this.damage/=i.boostersConfig.types.damage.additionalXDamage}this.currentBooster=null}revive(){const{scene:e}=this;this.hp=this.maxHp*(i.playerConfig.revive.healthPercentage/100),this.immortalityTime=e.gameTime+i.playerConfig.revive.immortalityTime}destroy(){const{scene:e,body:t}=this;e.utils.createTripleExplode(t.x,t.y),this.destroyBooster(),t.destroy(),e.onFail(),e.shakeScreen()}updateFire(){const{scene:e,body:t,angle:s,lastFireTime:i}=this,o=e.gameTime,r=h.angleToRadians(s+180);o>i&&(e.effects.push(new n.Fire(e,{pos:new a.Vector(t.x+45*Math.cos(r+.4),t.y+45*Math.sin(r+.4)),angle:r})),e.effects.push(new n.Fire(e,{pos:new a.Vector(t.x+45*Math.cos(r-.4),t.y+45*Math.sin(r-.4)),angle:r})),this.lastFireTime=o+75)}onLeftPointerUp(){this.pointers.left=null,this.pointerValues.isLeftTouched=!1}onRightPointerUp(){this.pointers.right=null,this.pointerValues.isRightTouched=!1}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const i=s(4),a=s(3),o=s(164),n=s(1),r=s(18),h=s(22);t.Utils=class{constructor(e){this.createEnemy=(e,t={})=>{var s;const{scene:i}=this,a=null!==(s=t.pos)&&void 0!==s?s:this.getRandomPointOutside();i.enemies.push(new e(i,{pos:a}))},this.scene=e}getRandomPos(e=0,t=0){const s=this.scene.getGameSize(),i=s.width*(e/100),o=s.height*(t/100),n=i+Math.random()*(s.width-2*i),r=o+Math.random()*(s.height-2*o);return new a.Vector(n,r)}getAngleToPlayer(e){const{scene:t}=this,{player:s}=t,i=new a.Vector(s.body.x,s.body.y);return n.getAngleBetweenPointsInDegrees(i,new a.Vector(e.x,e.y))}getRandomPointOutside(e={}){const{scene:t}=this,s=t.getGameSize(),i=e.distance||50,o={x:s.width,y:s.height},n=Math.random()>.5?"y":"x",r=[-i,o[n]+i][Math.floor(2*Math.random())],h={x:"x"===n?r:Math.random()*s.width,y:"y"===n?r:Math.random()*s.height};return new a.Vector(h.x,h.y)}getSafeAreaPoint(){const e=this.scene.getGameSize(),t=e.width*(i.enemySafeAreaPercentage.x/100),s=e.height*(i.enemySafeAreaPercentage.y/100),o=e.width/2-t+Math.random()*(2*t),n=e.height/2-s+Math.random()*(2*s);return new a.Vector(o,n)}createTripleExplode(e,t){const s=360*Math.random()/3;for(let i=0;i<3;i++){const o=n.angleToRadians(120*i+s),r={pos:new a.Vector(e+30*Math.cos(o),t+30*Math.sin(o)),sprite:"explode-orange",scaleCoef:1,withDamage:!0};this.createExplodeEffect(r)}}createBonus(e,t,s){const{scene:i}=this;i.bonuses.push(new o.Coin(i,{pos:new a.Vector(e,t),cost:s}))}createSphereBullet(e){const{scene:t}=this;t.bullets.push(new h.SphereBullet(t,e))}createRocketBullet(e){const{scene:t}=this;t.bullets.push(new h.RocketBullet(t,e))}createRayBullet(e){const{scene:t}=this;t.bullets.push(new h.RayBullet(t,e))}createExplodeEffect(e){const{scene:t}=this;t.effects.push(new r.Explode(t,e))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;const i=s(27),a=s(1),o={0:{sprite:"coin-bronze",xFactor:1},1:{sprite:"coin-silver",xFactor:1.5},2:{sprite:"coin-gold",xFactor:2}},n=a.getSeconds(2);class r extends i.Bonus{constructor(e,t){super(e),this.lifeTime=5e3;const s=o[(()=>{const e=Math.random();return e>.5?0:e>.2?1:2})()];this.cost=Math.floor(t.cost*s.xFactor),this.body=this.scene.physics.add.image(t.pos.x,t.pos.y,s.sprite),this.creationTime=e.gameTime,this.lifeTime+=Math.random()*n,this.init()}init(){this.body.setDepth(10),this.body.setCircle(16),this.initCollisions()}initCollisions(){const{scene:e}=this;e.physics.add.collider(this.body,e.player.body,()=>{e.score+=this.cost,this.destroy()})}act(){this.update()}update(){const{scene:e,body:t}=this,s=e.gameTime;t.angle+=3*Math.sin(.003*s),s>this.creationTime+this.lifeTime&&this.destroy()}}t.Coin=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bullet=void 0;const i=s(9),a=s(0);t.Bullet=class{constructor(e,t){this.scene=e,this.name=t.name,this.pos=t.pos,this.owner=t.owner,this.damage=t.damage}act(e,t){}update(e,t){const{body:s}=this,i=this.scene.getGameSize();(s.x+s.width<0||s.x-s.width>i.width||s.y+s.height<0||s.y-s.height>i.height)&&this.destroy()}initCollisions(){const{scene:e,owner:t,damage:s}=this,{boss:o}=e;t===a.EOwner.player?(e.enemies.forEach(t=>{e.physics.add.collider(this.body,t.body,()=>{this.explode(),t.damage(s)}),t instanceof i.Defender&&e.physics.add.overlap(this.body,t.shieldBody,()=>{t.hitShield(this)})}),e.bullets.forEach(t=>{"rocket"===t.name&&t.owner===a.EOwner.enemy&&e.physics.add.collider(this.body,t.body,()=>{t.hit(s),this.explode()})}),e.instances.forEach(t=>{e.physics.add.collider(this.body,t.body,()=>{t.hit(),this.explode()})}),o&&e.physics.add.collider(this.body,o.body,()=>{this.explode(),o.damage(s)})):(e.physics.add.collider(this.body,e.player.body,()=>{this.explode(),e.player.hit(s)}),e.physics.add.overlap(this.body,e.player.shieldBody,()=>{e.player.hitShield(this)}))}getAngle(){return this.angle}explode(){}destroy(){const{body:e}=this;this.scene.bullets=this.scene.bullets.filter(e=>e!==this),e.destroy()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sphere=void 0;const i=s(3),a=s(1),o=s(22),n={scale:1,bodySize:6,states:[]};class r extends o.Bullet{constructor(e,t){super(e,{name:"sphere",pos:t.pos,owner:t.owner,damage:t.damage}),this.currentStateIndex=0,this.depth=10,this.body=e.physics.add.image(t.pos.x,t.pos.y,t.sprite),t.tint&&this.body.setTint(t.tint),this.params=Object.assign(Object.assign({},n),a.excludeUndefinedValues(t)),this.currentState=this.params.states[0],this.speed=t.speed,this.scale=this.params.scale,this.angle=t.angle,this.init()}init(){const{body:e,params:t,depth:s}=this,{angle:i,scale:a}=t;e.setAngle(i+90),e.setDepth(s),e.setOrigin(.5,.5),e.setScale(a),this.updateBodyCenter(),this.initCollisions()}updateBodyCenter(){const{params:e,scale:t}=this,{bodySize:s}=e,o=a.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,t,s,new i.Vector(0,0));this.body.setCircle(s,o.x,o.y)}act(e,t){this.body.setScale(this.scale),this.updateBodyCenter(),this.updateState(e,t),this.updateMovement(e,t),super.update(e,t)}updateState(e,t){const{scene:s,body:i,currentState:a}=this;if(a)switch(a.name){case"wait":a.time-=s.deltaTime,a.time<=0&&this.setNextState();break;case"changeState":a.time-=s.deltaTime,a.cb(this),a.time<=0&&this.setNextState();break;case"changeSize":a.time-=s.deltaTime,this.scale=a.scaleFn(this.scale),a.time<=0&&this.setNextState();break;case"changeAngle":{const e=a.angleFn();i.setAngle(a.angleFn()),this.angle=e,this.setNextState();break}case"changeSpeed":a.time-=s.deltaTime,this.speed=Math.max(a.speedFn(this.speed),0),a.time<=0&&this.setNextState();break;case"explode":a.explode(this),this.destroy()}}setNextState(){this.currentStateIndex+=1,this.currentState=this.params.states[this.currentStateIndex]}updateMovement(e,t){const{scene:s,body:i,speed:o,angle:n}=this,{deltaTime:r}=s,h=a.angleToRadians(n);i.x+=o*Math.cos(h)*r,i.y+=o*Math.sin(h)*r}draw(){}explode(){const{body:e,params:t}=this;this.scene.utils.createExplodeEffect({pos:new i.Vector(e.x,e.y),sprite:t.explodeSprite,scaleCoef:t.explodeScale||1}),this.destroy()}}t.Sphere=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rocket=void 0;const i=s(3),a=s(0),o=s(1),n=s(22),r=s(18);class h extends n.Bullet{constructor(e,t){super(e,{name:"rocket",pos:t.pos,owner:t.owner,damage:t.damage}),this.hp=30,this.depth=10,this.speed=2,this.maxSpeed=5,this.scale=1,this.bodySize=10,this.rotateSpeed=1.2,this.lifeTime=0,this.nextShadowTime=0,this.body=e.physics.add.image(t.pos.x,t.pos.y,t.sprite),this.params=t,this.angle=t.angle,this.lifeTime=e.gameTime+5e3,this.init()}init(){const{body:e,params:t,depth:s,scale:i}=this,{angle:a}=t;e.setAngle(a+90),e.setDepth(s),e.setOrigin(.5,.5),e.setScale(i),e.setImmovable(!0),this.updateBodyCenter(),this.initCollisions(),this.initBulletsCollisions()}initBulletsCollisions(){const{scene:e}=this;e.bullets.forEach(t=>{t.owner===a.EOwner.player&&e.physics.add.collider(this.body,t.body,()=>{this.hit(t.damage),t.explode()})})}updateBodyCenter(){const{scale:e,bodySize:t}=this,s=o.getBodyPosWithOffset(this.body.displayWidth,this.body.displayHeight,e,t,new i.Vector(0,0));this.body.setCircle(t,s.x,s.y)}act(e,t){this.body.setScale(this.scale),this.updateBodyCenter(),this.updateMovement(e,t),this.updateSpeed(),this.updateAngle(),this.updateShadow(),this.updateLifeTime(),super.update(e,t)}updateMovement(e,t){const{scene:s,body:i,angle:a}=this,{deltaTime:n}=s,r=o.angleToRadians(a);i.x+=this.speed*Math.cos(r)*n,i.y+=this.speed*Math.sin(r)*n}updateSpeed(){this.speed<this.maxSpeed&&(this.speed+=.02*this.scene.deltaTime)}updateAngle(){const{scene:e,angle:t,body:s}=this,a=e.player.body,n=new i.Vector(a.x,a.y),r=o.getAngleBetweenPointsInDegrees(n,s);this.angle=o.getNearestAngle(t,r,this.rotateSpeed*e.deltaTime),this.body.angle=t+90}updateShadow(){const{scene:e}=this,{gameTime:t}=e;t>this.nextShadowTime&&(this.createShadow(),this.nextShadowTime=t+70)}updateLifeTime(){const{scene:e}=this;e.gameTime>this.lifeTime&&this.explode(!1)}createShadow(){const{scene:e,body:t}=this,s=o.getOffsetByAngle(this.angle-180,10);e.effects.push(new r.Shadow(e,{pos:new i.Vector(t.x+s.x,t.y+s.y),sprite:"rocket-shadow",lifeTime:250,scale:.75,angle:this.angle+90,alpha:.4}))}draw(){}explode(e=!0){const{scene:t,body:s,params:a}=this;e&&t.utils.createExplodeEffect({pos:new i.Vector(s.x,s.y),sprite:a.explodeSprite,scaleCoef:1}),t.utils.createTripleExplode(s.x,s.y),this.destroy()}hit(e){this.hp-=e,this.hp<=0&&this.explode(!1)}}t.Rocket=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ray=void 0;const i=s(3),a=s(1),o=s(22);class n extends o.Bullet{constructor(e,t){super(e,{name:"ray",pos:t.pos,owner:t.owner,damage:t.damage}),this.depth=10,this.delay=0,this.lifeTime=50,this.reload=0,this.body=e.add.image(t.pos.x,t.pos.y,t.sprite),this.params=t,this.angle=t.angle,this.delay=t.delay,this.init()}init(){const{body:e,params:t,depth:s}=this;e.setAngle(t.angle),e.setDepth(s),e.setOrigin(0,.5),e.setScale(this.scene.getGameSize().width/this.body.width,1),this.initLine()}initLine(){const{body:e}=this,t=a.getOffsetByAngle(this.angle,this.scene.getGameSize().width);this.line=new Phaser.Geom.Line(e.x,e.y,e.x+t.x,e.y+t.y)}act(e,t){this.updateCollisions(),this.delay>0?(this.body.setAlpha(.15),this.delay-=this.scene.deltaTime):(this.body.setAlpha(1),this.lifeTime-=this.scene.deltaTime,this.lifeTime<=0&&this.destroy()),this.params.isLaserActive()||this.destroy(),super.update(e,t)}updateCollisions(){const{scene:e,body:t}=this,s=e.player,{gameTime:o}=e;if(Phaser.Geom.Intersects.LineToCircle(this.line,s.geomCircle)&&s.body.active){const e=new i.Vector(t.x,t.y),n=new i.Vector(s.body.x,s.body.y),r=a.getDistanceBetweenPoints(e,n);o>this.reload&&this.delay<=0&&(s.hit(this.params.damage),this.reload=o+500,this.explode()),this.body.setScale(r/this.body.width,1)}else this.body.setScale(this.scene.getGameSize().width/this.body.width,1)}destroy(){super.destroy(),this.params.onDestroy()}explode(){const{scene:e,body:t,params:s}=this,o=e.player,n=new i.Vector(t.x,t.y),r=new i.Vector(o.body.x,o.body.y),h=a.getDistanceBetweenPoints(n,r),l=a.getOffsetByAngle(this.angle,h);e.utils.createExplodeEffect({pos:new i.Vector(t.x+l.x,t.y+l.y),sprite:s.explodeSprite,scaleCoef:1})}}t.Ray=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialGameStats=void 0;t.getInitialGameStats=()=>({totalKills:0,kills:{bot:0,destroyer:0,hunter:0,flyer:0,ufo:0,stealth:0,"missile-carrier":0,"laser-ship":0,defender:0}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreloadScene=void 0;const i=s(0),a=s(7);class o extends a.Scene{constructor(){super({key:i.ESceneName.preload})}create(){0!==this.getData().level&&this.setData("wasHistoryShown",!0),this.startGame()}startGame(){this.game.i18n.loadLang(this.game.settings.lang).then(()=>{this.game.i18n.setCurrentLang(this.game.settings.lang),this.ui.drawOriginalText({x:0,y:-100,text:this.game.i18n.getText("gameStart"),fontSize:1,origin:[.5,.5]}),setTimeout(()=>{this.scene.start(i.ESceneName.menu)},50)})}}t.PreloadScene=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfoScene=void 0;const i=s(4),a=s(0),o=s(7);class n extends o.Scene{constructor(){super({key:a.ESceneName.info})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=e.width/2;this.text=this.ui.drawOriginalText({x:s,y:t.y,text:this.params.text,fontSize:this.params.textSize,align:"center",origin:[.5,0],maxWidth:e.width/1.5,color:i.colors.white}),this.drawBackButton(this.text.y+this.text.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText),this.updateContentPositions()}drawBackButton(e){const t=this.getGameSize();this.backButton=this.ui.drawButton({x:t.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.params.backButtonText||this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.menu)}}})}updateContentPositions(){const e=(this.text.displayHeight+i.defaultButtonParams.height+i.defaultButtonParams.spaceYText)/2;this.text.y-=e,this.backButton.updatePosition(this.backButton.getPosition().x,this.backButton.getPosition().y-e)}}t.InfoScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryScene=void 0;const i=s(4),a=s(0),o=s(7);class n extends o.Scene{constructor(){super({key:a.ESceneName.history})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=this.getSettings().isMobile;this.historyText=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.i18n.getText("history"),fontSize:i.fontSizes.textMedium,align:"center",origin:[.5,0],maxWidth:s?.8*e.width:.6*e.width,color:i.colors.white}),this.drawNextButton(this.historyText.y+this.historyText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText+15),this.updateContentPositions()}drawNextButton(e){const{params:t}=this,s=this.getGameSize();this.nextButton=this.ui.drawButton({x:s.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:t.isMenuScene?this.game.i18n.getText("back"):this.game.i18n.getText("next2"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.preview)}}})}updateContentPositions(){const e=(this.historyText.displayHeight+i.defaultButtonParams.height+i.defaultButtonParams.spaceYText+15)/2;this.historyText.y-=e,this.nextButton.updatePosition(this.nextButton.getPosition().x,this.nextButton.getPosition().y-e)}}t.HistoryScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdScene=void 0;const i=s(4),a=s(0),o=s(7);class n extends o.Scene{constructor(){super({key:a.ESceneName.ad})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=e.width/2;this.text=this.ui.drawOriginalText({x:s,y:t.y,text:this.game.i18n.getText("adLoading"),fontSize:i.fontSizes.textMedium,align:"center",origin:[.5,.5],maxWidth:e.width,color:i.colors.white}),this.showAd()}showAd(){const{wasHistoryShown:e,level:t}=this.getData();this.game.adManager.showFullscreenVideo({onClose:()=>{e||0!==t?this.scene.start(a.ESceneName.preview):(this.scene.start(a.ESceneName.history,{isMenuScene:!1}),this.setData("wasHistoryShown",!0))},onError:()=>{}})}}t.AdScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingScene=void 0;const i=s(4),a=s(0),o=s(7);class n extends o.Scene{constructor(){super({key:a.ESceneName.loading}),this.isResourcesLoaded=!1}preload(){const e=this.getGameSize(),t=this.getGameCenter();this.text=this.ui.drawOriginalText({x:t.x,y:t.y,text:this.game.i18n.getText("loadingGameResources"),fontSize:18,align:"center",origin:[.5,.5],maxWidth:.6*e.width,color:i.colors.white}),this.progressText=this.ui.drawOriginalText({x:t.x,y:this.text.y+this.text.displayHeight+i.defaultUISpacings.text,text:"0%",fontSize:18,align:"center",origin:[.5,.5],maxWidth:.6*e.width,color:i.colors.white}),this.updateContentPositions(),this.load.on("progress",e=>{this.onLoadingProgress(e)}),this.isResourcesLoaded&&this.onLoadingComplete(),this.load.on("complete",()=>{this.onLoadingComplete()}),this.load.image("background-1","assets/images/background/bg-gray.jpg"),this.load.image("background-2","assets/images/background/bg-planet.jpg"),this.load.image("player-ship","assets/images/ships/player-ship.png"),this.load.image("enemy-bot-ship","assets/images/ships/enemy-ship-2.png"),this.load.image("enemy-hunter-ship","assets/images/ships/enemy-hunter.png"),this.load.image("enemy-ufo","assets/images/ships/enemy-ufo.png"),this.load.image("enemy-flyer","assets/images/ships/enemy-flyer.png"),this.load.image("enemy-destroyer-ship","assets/images/ships/enemy-destroyer.png"),this.load.image("enemy-stealth-ship","assets/images/ships/enemy-stealth.png"),this.load.image("enemy-missile-carrier-ship","assets/images/ships/enemy-missile-carrier.png"),this.load.image("enemy-laser-ship","assets/images/ships/enemy-laser-ship.png"),this.load.image("enemy-defender-ship","assets/images/ships/enemy-defender-ship.png"),this.load.image("boss-1-ship","assets/images/ships/boss-1-ship.png"),this.load.image("boss-2-ship","assets/images/ships/mothership.png"),this.load.image("laser-green","assets/images/bullets/laser-green-3.png"),this.load.image("laser-red","assets/images/bullets/laser-red-2.png"),this.load.image("laser-aqua","assets/images/bullets/laser-aqua.png"),this.load.image("sphere-bullet","assets/images/bullets/sphere-bullet.png"),this.load.image("sphere-bullet-yellow","assets/images/bullets/sphere-bullet-yellow.png"),this.load.image("sphere-bullet-gray","assets/images/bullets/sphere-bullet-gray.png"),this.load.image("sphere-bullet-blue","assets/images/bullets/sphere-bullet-blue.png"),this.load.image("sphere-bullet-purple","assets/images/bullets/sphere-bullet-purple.png"),this.load.image("rocket-bullet","assets/images/bullets/rocket.png"),this.load.image("ray-bullet-red","assets/images/bullets/ray-red.png"),this.load.image("explode-green","assets/images/effects/explode-green.png"),this.load.image("explode-red","assets/images/effects/explode-red.png"),this.load.image("explode-orange","assets/images/effects/explode-orange.png"),this.load.image("explode-gray","assets/images/effects/explode-gray.png"),this.load.image("explode-yellow","assets/images/effects/explode-yellow.png"),this.load.image("explode-aqua","assets/images/effects/explode-aqua.png"),this.load.image("explode-blue","assets/images/effects/explode-blue.png"),this.load.image("explode-purple","assets/images/effects/explode-purple.png"),this.load.image("star","assets/images/effects/star-4.png"),this.load.image("fire","assets/images/effects/fire-3.png"),this.load.image("comet","assets/images/effects/comet.png"),this.load.image("meteor-1","assets/images/effects/meteor-gray-1.png"),this.load.image("meteor-2","assets/images/effects/meteor-gray-2.png"),this.load.image("meteor-3","assets/images/effects/meteor-gray-3.png"),this.load.image("meteor-4","assets/images/effects/meteor-gray-4.png"),this.load.image("shield","assets/images/effects/shield.png"),this.load.image("rocket-shadow","assets/images/effects/rocket-shadow.png"),this.load.audio("laser-1",["assets/audio/sfx_laser1.ogg"]),this.load.audio("laser-2",["assets/audio/sfx_laser2.ogg"]),this.load.image("coin-bronze","assets/images/bonus/star-bronze.png"),this.load.image("coin-silver","assets/images/bonus/star-silver.png"),this.load.image("bonus-speed","assets/images/bonus/bonus-speed.png"),this.load.image("bonus-shield","assets/images/bonus/bonus-shield.png"),this.load.image("bonus-damage","assets/images/bonus/bonus-damage.png"),this.load.image("bonus-regenerator","assets/images/bonus/bonus-regenerator.png"),this.load.image("touch-area","assets/images/controls/touch-area.png"),this.load.image("control-arrow-left","assets/images/controls/arrow-left.png"),this.load.image("firefly","assets/images/other/firefly.png")}onLoadingProgress(e){this.progressText.text=(100*e).toFixed(0)+"%"}onLoadingComplete(){this.isResourcesLoaded?this.scene.start(a.ESceneName.game,{}):(this.isResourcesLoaded=!0,setTimeout(()=>{this.scene.start(a.ESceneName.game,{})},100))}updateContentPositions(){const e=(this.text.displayHeight+this.progressText.displayHeight+i.defaultUISpacings.text)/2;this.text.y-=e,this.progressText.y-=e}}t.LoadingScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContactsScene=void 0;const i=s(4),a=s(0),o=s(7);class n extends o.Scene{constructor(){super({key:a.ESceneName.contacts})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=e.width/2,a=t.y-50;this.text=this.ui.drawOriginalText({x:s,y:t.y,text:this.game.i18n.getTemplateText("contactDeveloper.template",{args:{email:i.DEVELOPER_EMAIL}}),fontSize:i.fontSizes.text,align:"center",origin:[.5,.5],maxWidth:e.width,color:i.colors.white}),this.text.y=a,this.drawBackButton(a+i.defaultButtonParams.spaceY)}drawBackButton(e){const t=this.getGameSize();this.ui.drawButton({x:t.width/2,y:e,width:i.defaultButtonParams.width120,height:i.defaultButtonParams.height,text:this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.scene.start(a.ESceneName.menu)}}})}}t.ContactsScene=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LeaderboardsScene=void 0;const i=s(4),a=s(1),o=s(0),n=s(7),r=350,h=35,l={leaderboardTitle:i.defaultUIPositions.top},c=50,d=i.defaultUIPositions.bottom,u=15;class m extends n.Scene{constructor(){super({key:o.ESceneName.leaderboards})}init(e){this.params=e}create(){this.updateSceneUniqueId();const e=this.getGameSize(),t=this.getGameCenter(),s=e.width/2;this.graphics=this.add.graphics({lineStyle:{width:2,color:i.colors.white}}),this.loadingText=this.ui.drawOriginalText({x:s,y:t.y,text:this.game.i18n.getText("loadingLeaderboards"),fontSize:i.fontSizes.text,align:"center",origin:[.5,0],color:i.colors.white}),this.leaderboardTitleText=this.ui.drawOriginalText({x:s,y:l.leaderboardTitle,text:this.game.i18n.getText("leaderboard"),fontSize:i.fontSizes.title,align:"center",origin:[.5,.5],color:i.colors.white}).setVisible(!1),this.drawBackButton(this.loadingText.y+this.loadingText.displayHeight+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText),this.updateContentPositions();const a=this.sceneUniqueId;this.game.leaderboards.getLeaderboardEntries().then(e=>{this.isTheSameScene(a,o.ESceneName.leaderboards)&&this.drawLeaderboards(e)}).catch(e=>{console.error(e),this.isTheSameScene(a,o.ESceneName.leaderboards)&&(this.loadingText.text=this.game.i18n.getText("loadingLeaderboardsError"))})}drawBackButton(e){const t=this.getGameSize();this.backButton=this.ui.drawButton({x:t.width/2,y:e,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}})}drawLeaderboards(e){const t=this.getGameSize(),s=this.getGameCenter(),a=c+l.leaderboardTitle,o=t.height-a-d-i.defaultButtonParams.height/2-i.defaultButtonParams.spaceY;let n=o/10,u=10;n<h&&(u=Math.floor(o/h),n=o/u),this.drawLeaderboard(!0,s.x-r,a,e.entries.slice(0,u),u,n),this.drawLeaderboard(!1,s.x,a,e.entries.slice(10,10+u),u,n),this.loadingText.setVisible(!1),this.leaderboardTitleText.setVisible(!0),this.backButton.updatePosition(s.x,a+o+i.defaultButtonParams.spaceY)}drawLeaderboard(e,t,s,o,n,h){var l;const{graphics:c}=this;for(let d=0;d<n;d++){const n=o[d],m=new Phaser.Geom.Rectangle(t,s+h*d,r,h);if(c.strokeRectShape(m),!n)continue;let p=i.colors.white;(null===(l=this.game.leaderboards.getPlayerEntry())||void 0===l?void 0:l.player.uniqueID)===n.player.uniqueID&&(p=i.colors.green),e&&(0===d&&(p=i.colors.gold),1===d&&(p=i.colors.silver),2===d&&(p=i.colors.bronze)),this.ui.drawOriginalText({x:u+t,y:s+h/2+h*d,text:n.rank+".  "+(a.getEllipsisText(n.player.publicName,20)||this.game.i18n.getText("anonymousShip")),fontSize:i.fontSizes.textSmall,align:"center",origin:[0,.5],color:p}),this.ui.drawOriginalText({x:t+r-u,y:s+h/2+h*d,text:n.score.toString(),fontSize:i.fontSizes.textSmall,align:"center",origin:[1,.5],color:p})}}updateContentPositions(){const e=(this.loadingText.displayHeight+i.defaultButtonParams.height+i.defaultButtonParams.spaceYText)/2;this.loadingText.y-=e,this.backButton.updatePosition(this.backButton.getPosition().x,this.backButton.getPosition().y-e)}}t.LeaderboardsScene=m},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FinalScene=void 0;const i=s(4),a=s(1),o=s(0),n=s(7);class r extends n.Scene{constructor(){super({key:o.ESceneName.final})}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter(),s=e.width/2;this.text=this.ui.drawOriginalText({x:s,y:t.y,text:this.game.i18n.getText("finalVictory"),fontSize:i.fontSizes.text,align:"center",origin:[.5,1],maxWidth:e.width/1.5,color:i.colors.white}),this.drawBackButton(0,0),this.drawWaitButton(0,0),this.updateContentPositions()}drawBackButton(e,t){this.backButton=this.ui.drawButton({x:e,y:t,width:i.defaultButtonParams.width120,height:i.defaultButtonParams.height,text:this.game.i18n.getText("goToMenu"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}})}drawWaitButton(e,t){const s=this.getData();this.waitButton=this.ui.drawButton({x:e,y:t,responsive:{paddingX:i.defaultButtonParams.paddingX},height:i.defaultButtonParams.height,text:this.game.i18n.getText("wait"),isDisabled:s.isWaitButtonPressed,callbacks:{onPointerDown:()=>{this.text.text=this.game.i18n.getText("thanksForWaiting"),this.setData("isWaitButtonPressed",!0),this.game.localStorage.setGameData({isWaitButtonPressed:!0}),this.waitButton.setDisabled(!0),a.sendMetrikaGoal(o.EGoalTargetName.waitNextLevels,{isPressed:!0}),this.updateContentPositions()}}})}updateContentPositions(){const e=this.getGameCenter();this.text.y=e.y+(this.text.displayHeight-i.defaultButtonParams.height-i.defaultButtonParams.spaceYText)/2;const t=this.text.y+i.defaultButtonParams.height/2+i.defaultButtonParams.spaceYText,s=this.waitButton.getSize().width,a=(i.defaultButtonParams.width120/2+s/2+i.defaultButtonParams.spaceX)/2;this.backButton.updatePosition(e.x-a,t),this.waitButton.updatePosition(e.x+a,t)}}t.FinalScene=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreScene=void 0;const i=s(3),a=s(4),o=s(0),n=s(5),r=s(21),h=s(39),l=s(179),c=s(7);class d extends c.Scene{constructor(){super({key:o.ESceneName.store}),this.productsControls=[],this.currentProducts=[],this.productsState={},this.currentProductSection=h.EStoreSection.characteristics,this.currentPage=0,this.maxPages=1}init(e){this.params=e}create(){const e=this.getGameSize(),t=this.getGameCenter();this.deviceType=this.game.settings.deviceType,this.currentProductSection=h.EStoreSection.characteristics,this.currentPage=0,this.graphics=this.add.graphics({lineStyle:{width:2,color:a.colors.white}}),this.playerScore=this.ui.drawCosmons({x:25,y:40,value:this.getData().score,isCentered:!1,depth:100}),this.titleStoreText=this.ui.drawOriginalText({x:t.x,y:l.uiPositions.titleTop,text:this.game.i18n.getText("store"),fontSize:a.fontSizes.title,align:"center",origin:[.5,.5],color:a.colors.white}),this.soonText=this.ui.drawOriginalText({x:t.x,y:l.uiPositions.storeTop[this.deviceType]+(e.height-a.defaultButtonParams.spaceY-l.uiPositions.storeTop[this.deviceType]-a.defaultButtonParams.height-l.uiSpacings.bottom)/2,text:this.game.i18n.getText("soon"),fontSize:22,align:"center",origin:[.5,.5],color:a.colors.white}).setVisible(!1),this.paginationText=this.ui.drawOriginalText({x:0,y:0,text:"",fontSize:16,align:"center",origin:[.5,.5],color:a.colors.white}),this.tabs=new r.UITabs(this,{pos:new i.Vector(t.x,l.uiPositions.tabsTop[this.deviceType]),tabs:l.storeTabs,onClick:e=>{this.onTabChange(e.key)}}),this.drawControls(),this.initProducts(),this.updateCurrentProducts(),this.drawProducts(),this.updateMobilePositions()}updateMobilePositions(){const e=this.getGameSize(),t=this.getGameCenter();this.game.settings.isMobile&&(this.titleStoreText.setVisible(!1),this.paginationText.y=e.height-l.uiSpacings.mobile.buttonBorderY-a.defaultButtonParams.height/2-l.uiSpacings.mobile.padinationTextBottom,this.paginationText.x=e.width-l.uiSpacings.mobile.buttonBorderX,this.menuButton.updatePosition(l.uiSpacings.mobile.buttonBorderX,e.height-l.uiSpacings.mobile.buttonBorderY),this.nextStoreSectionButton.updatePosition(e.width-l.uiSpacings.mobile.buttonBorderX,e.height-l.uiSpacings.mobile.buttonBorderY-a.defaultButtonParams.height-l.uiSpacings.mobile.nextButtonBottom),this.prevStoreSectionButton.updatePosition(e.width-l.uiSpacings.mobile.buttonBorderX,e.height-l.uiSpacings.mobile.buttonBorderY),this.playerScore.setCentered(!0),this.playerScore.updatePosition(new i.Vector(t.x,e.height-l.uiSpacings.mobile.playerCosmonsBottom)),this.soonText.y=l.uiPositions.storeTop[this.deviceType]+(e.height-l.uiSpacings.mobile.playerCosmonsBottom-l.uiPositions.storeTop[this.deviceType]-l.uiSpacings.mobile.productBottom)/2)}drawControls(){const e=this.getGameCenter(),t=this.getMaxProductsCount()*l.storeParams.productWidth,s=e.x-t/2,i=l.uiPositions.storeTop[this.deviceType]+this.getAvailableHeight()+a.defaultButtonParams.spaceY;this.menuButton=this.ui.drawButton({x:s+a.defaultButtonParams.width120/2,y:i,width:a.defaultButtonParams.width120,height:a.defaultButtonParams.height,text:this.game.i18n.getText("goToMenu"),callbacks:{onPointerDown:()=>{this.scene.start(o.ESceneName.menu)}}}),this.prevStoreSectionButton=this.ui.drawButton({x:s+t-a.defaultButtonParams.width120/2-a.defaultButtonParams.width120-a.defaultButtonParams.spaceX-45,y:i,width:a.defaultButtonParams.width120,height:a.defaultButtonParams.height,text:this.game.i18n.getText("back"),noDefaultCursorAfterClick:!0,callbacks:{onPointerDown:()=>{this.onPaginationChange(-1)}}}),this.nextStoreSectionButton=this.ui.drawButton({x:s+t-a.defaultButtonParams.width120/2,y:i,width:a.defaultButtonParams.width120,height:a.defaultButtonParams.height,text:this.game.i18n.getText("next2"),noDefaultCursorAfterClick:!0,callbacks:{onPointerDown:()=>{this.onPaginationChange(1)}}}),this.paginationText.y=i,this.paginationText.x=s+t-a.defaultButtonParams.width120-35}initProducts(){const e=this.getMaxProductsCount();for(let t=0;t<e;t++){const e=this.ui.drawOriginalText({x:0,y:0,text:"",fontSize:14,align:"center",maxWidth:50,origin:[.5,.5],color:a.colors.white}),s=this.ui.drawOriginalText({x:0,y:0,text:this.game.i18n.getText("maximum"),align:"center",fontSize:14,maxWidth:l.storeParams.productWidth,origin:[.5,0],color:a.colors.white}).setVisible(!1),i=this.ui.drawOriginalText({x:0,y:0,text:"",align:"center",fontSize:14,maxWidth:l.storeParams.productWidth-10,origin:[.5,0],color:a.colors.white}).setVisible(!1),o=this.ui.drawCosmons({x:0,y:0,value:0,isCentered:!0,depth:100}),n=this.ui.drawIndicator({x:0,y:0,value:0,max:0}),r=this.ui.drawButton({x:0,y:0,width:l.storeParams.descriptionButtonWidth,height:l.storeParams.descriptionButtonWidth,text:"?",callbacks:{onPointerDown:()=>{this.onDescriptionButtonClick(t)}}}),h=this.ui.drawButton({x:0,y:0,depth:1,width:l.storeParams.buyButtonWidth,height:l.storeParams.buyButtonHeight,text:this.game.i18n.getText("buy"),noDefaultCursorAfterClick:!0,callbacks:{onPointerDown:()=>{this.onBuyProduct(t)}}}),c=this.ui.drawButton({x:0,y:0,width:l.storeParams.buyButtonWidth,height:l.storeParams.buyButtonHeight,text:this.game.i18n.getText("back"),callbacks:{onPointerDown:()=>{this.onBackDescriptionButtonClick(t)}}});c.hide(),this.productsControls[t]={nameText:e,maximumText:s,descriptionText:i,buyButton:h,cosmonsPrice:o,stateIndicator:n,descriptionButton:r,backDescriptionButton:c}}}updateCurrentProducts(){const e=this.getMaxProductsCount(),t=l.allStoreProducts[this.currentProductSection].slice(this.currentPage*e,this.currentPage*e+e);this.currentProducts=t,this.productsState={}}drawProducts(){const{graphics:e,currentProducts:t}=this;e.clear();const s=l.allStoreProducts[this.currentProductSection],i=this.getMaxProductsCount();for(let e=0;e<i;e++){t[e]?this.drawProduct(e):this.hideProduct(e)}t.length<=0?this.soonText.setVisible(!0):this.soonText.setVisible(!1),this.maxPages=Math.ceil(s.length/i)||1,this.paginationText.text=`${this.currentPage+1} / ${this.maxPages}`,this.updatePaginationButtons()}drawProduct(e,t=!0){var s;const{graphics:o}=this,r=this.getGameCenter(),h=this.getData(),c=this.currentProducts.length*l.storeParams.productWidth,d=r.x-c/2,u=l.uiPositions.storeTop[this.deviceType],m=d+e*l.storeParams.productWidth,p=u,g=this.getAvailableHeight(),y=this.productsControls[e],S=this.currentProducts[e],b=n.storeConfig.products[S.key],f=m+l.storeParams.productWidth/2,v=p+g-l.uiSpacings.product.buyButtonBottom,x=h.store[S.key],T=b.maxLevel,w=b.price[x];if(y.nameText.x=f,y.nameText.y=p+l.uiSpacings.product.nameTextTop,y.nameText.text=this.game.i18n.getText(S.i18nName),y.maximumText.x=f,y.maximumText.y=p+l.uiSpacings.product.maximumTextTop,y.descriptionText.x=f,y.descriptionText.y=p+l.uiSpacings.product.descriptionTextTop,y.descriptionText.text=this.game.i18n.getText(S.i18nDescription||"")||this.game.i18n.getText("noDescription"),w&&(y.cosmonsPrice.updatePosition(new i.Vector(f,p+l.uiSpacings.product.cosmonsPriceTop)),y.cosmonsPrice.updateValue(w)),y.stateIndicator.updatePosition(new i.Vector(f,v-l.uiSpacings.product.indicatorBottom)),y.stateIndicator.setMaxValue(b.maxLevel),y.stateIndicator.setValue(x),y.descriptionButton.updatePosition(m+l.storeParams.descriptionButtonWidth/2+l.uiSpacings.product.paddingX,v),y.buyButton.updatePosition(m+l.storeParams.buyButtonWidth+a.defaultButtonParams.height/2,v),y.backDescriptionButton.updatePosition(f,v),h.score<w||x>=T-1?y.buyButton.setDisabled(!0):y.buyButton.setDisabled(!1),y.maximumText.setVisible(!1),t){const e=new Phaser.Geom.Rectangle(m,p,l.storeParams.productWidth,g),t=new Phaser.Geom.Line(m,p+l.uiSpacings.product.nameLineTop,m+l.storeParams.productWidth,p+l.uiSpacings.product.nameLineTop);o.strokeRectShape(e),o.strokeLineShape(t)}(null===(s=this.productsState[e])||void 0===s?void 0:s.isDescriptionVisible)?(this.hideProduct(e),y.nameText.visible=!0,y.descriptionText.visible=!0,y.backDescriptionButton.show()):(this.showProduct(e),w||(y.cosmonsPrice.hide(),y.maximumText.setVisible(!0)))}updatePaginationButtons(){const e=0===this.currentPage,t=this.currentPage>=this.maxPages-1;this.prevStoreSectionButton.setDisabled(e),this.nextStoreSectionButton.setDisabled(t)}hideProduct(e){const t=this.productsControls[e];t.nameText.visible=!1,t.descriptionText.visible=!1,t.maximumText.visible=!1,t.buyButton.hide(),t.descriptionButton.hide(),t.stateIndicator.hide(),t.cosmonsPrice.hide(),t.backDescriptionButton.hide()}showProduct(e){const t=this.productsControls[e];t.nameText.visible=!0,t.descriptionText.visible=!1,t.buyButton.show(),t.descriptionButton.show(),t.stateIndicator.show(),t.cosmonsPrice.show(),t.backDescriptionButton.hide()}getMaxProductsCount(){const e=this.getGameSize();let t=Math.floor((e.width-2*l.uiSpacings.storeWidth[this.deviceType])/l.storeParams.productWidth);return"mobile"===this.deviceType&&t>l.MAX_MOBILE_PRODUCTS_COUNT&&(t=l.MAX_MOBILE_PRODUCTS_COUNT),t}getAvailableHeight(){const e=this.getGameSize(),t=l.uiPositions.storeTop[this.deviceType];let s=0;return s="mobile"===this.deviceType?e.height-(t+l.uiSpacings.mobile.playerCosmonsBottom+l.uiSpacings.mobile.productBottom):e.height-(t+l.uiSpacings.bottom+a.defaultButtonParams.height/2+a.defaultButtonParams.spaceY),s<l.storeParams.productMinHeight&&(s=l.storeParams.productMinHeight),s}getProductPrice(e){const t=this.getData(),s=this.currentProducts[e],i=n.storeConfig.products[s.key],a=t.store[s.key];return i.price[a]}onTabChange(e){this.currentProductSection=e,this.currentPage=0,this.updateCurrentProducts(),this.drawProducts()}onPaginationChange(e){const t=this.currentPage;this.currentPage=Math.min(Math.max(this.currentPage+e,0),this.maxPages-1),t!==this.currentPage&&(this.updateCurrentProducts(),this.drawProducts())}onDescriptionButtonClick(e){this.productsState[e]={isDescriptionVisible:!0},this.drawProduct(e,!1)}onBackDescriptionButtonClick(e){this.productsState[e]={isDescriptionVisible:!1},this.drawProduct(e,!1)}onBuyProduct(e){const t=this.getData(),s=this.currentProducts[e],i=this.getProductPrice(e),a=t.score-i,o=t.store[s.key]+1;this.setData("score",a),this.setData("store",Object.assign(Object.assign({},t.store),{[s.key]:o})),this.game.localStorage.setGameData({score:a,store:Object.assign(Object.assign({},t.store),{[s.key]:o})}),this.playerScore.updateValue(a),this.drawProducts()}}t.StoreScene=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_MOBILE_PRODUCTS_COUNT=t.allStoreProducts=t.storeTabs=t.storeParams=t.uiPositions=t.uiSpacings=void 0;const i=s(4),a=s(31),o=s(39);function n(e){return{key:e,i18nName:e,i18nDescription:e+"Description"}}t.uiSpacings={bottom:i.defaultUIPositions.bottom,product:{paddingX:25,nameTextTop:30,descriptionTextTop:80,maximumTextTop:86,nameLineTop:60,cosmonsPriceTop:95,indicatorBottom:65,descriptionButton:55,buyButtonBottom:45},storeWidth:{desktop:100,mobile:150},mobile:{productBottom:45,playerCosmonsBottom:45,buttonBorderX:100,buttonBorderY:55,nextButtonBottom:50,padinationTextBottom:25}},t.uiPositions={titleTop:i.defaultUIPositions.top,tabsTop:{desktop:130,mobile:60},storeTop:{desktop:130+i.defaultButtonParams.spaceY,mobile:45+i.defaultButtonParams.spaceY}},t.storeParams={productMinHeight:250,productWidth:220,descriptionButtonWidth:40,buyButtonHeight:40,buyButtonWidth:115},t.storeTabs=[{textI18nKey:o.EStoreSection.characteristics,key:o.EStoreSection.characteristics},{textI18nKey:o.EStoreSection.ships,key:o.EStoreSection.ships},{textI18nKey:o.EStoreSection.weapons,key:o.EStoreSection.weapons},{textI18nKey:o.EStoreSection.boosters,key:o.EStoreSection.boosters}],t.allStoreProducts={characteristics:[n(a.EPlayerStoreProduct.maxHealth),n(a.EPlayerStoreProduct.damage),n(a.EPlayerStoreProduct.movementSpeed),n(a.EPlayerStoreProduct.attackSpeed),n(a.EPlayerStoreProduct.explosionResistance),n(a.EPlayerStoreProduct.bonusesTime),n(a.EPlayerStoreProduct.fortune)],ships:[],weapons:[],boosters:[]},t.MAX_MOBILE_PRODUCTS_COUNT=2},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getGameConfig=void 0;const i=s(36),a=s(1);t.getGameConfig=()=>{const e=a.isMobileDevice()?i.getMobileGameConfig():i.getDesktopGameConfig();return Object.assign(Object.assign({},i.baseConfig),e)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const i=s(40);class a extends Phaser.Game{constructor(e,t){super(e),this.data=t.data,this.settings=t.settings,this.adManager=new i.AdManager,this.translations=new i.Translations(this),this.i18n=t.i18n,this.localStorage=i.LocalStorage,this.leaderboards=new i.Leaderboards(this)}}t.Game=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=t.Emitter=void 0;class i{constructor(){this.listeners=[]}subscribe(e,t){this.listeners.push({type:e,cb:t})}unsubscribe(e,t){this.listeners=this.listeners.filter(s=>s.cb!==t&&s.type!==e)}dispatch(e){this.listeners.forEach(t=>{t.type===e.type&&(console.log("=== dispatch action ===",e),t.cb(e.payload))})}}t.Emitter=i;const a=new i;t.EventEmitter=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(1);t.default=new class{constructor(){this.setItem=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){console.error(e)}},this.getItem=e=>{try{return window.localStorage.getItem(e)}catch(e){console.error(e)}return null}}getGameData(){const e=i.decryptValue(this.getItem("data"));if(e)try{return JSON.parse(e)}catch(e){console.error(e)}return null}setGameData(e){const t=this.getGameData()||{},s=Object.assign(Object.assign({},t),e),a=i.encryptValue(JSON.stringify(s));a?(this.setItem("data",a),i.debugLog("save",e)):console.error("Failed to save data!")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(1);t.default=class{constructor(e){this.dictionary={},this.currentLang=e,this.getText=this.getText.bind(this),this.getPluralText=this.getPluralText.bind(this),this.getTemplateText=this.getTemplateText.bind(this)}setCurrentLang(e){this.currentLang=e}loadLang(e){return new Promise((t,s)=>{if(this.dictionary[e])return t(void 0);i.debugLog("i18n",`load dictionary "${e}"`),fetch(`assets/i18n/${e}.json`).then(e=>e.json()).then(s=>{this.dictionary[e]=s,t(void 0)}).catch(e=>{console.error(e),s(e)})})}getKeyValue(e){return this.dictionary[this.currentLang]||this.throwNoLangError(this.currentLang),this.dictionary[this.currentLang][e]}getText(e){if(""===e)return"";const t=this.getKeyValue(e);return t||this.throwNoKeyError(e),t}getPluralText(e,t){const s=this.getKeyValue(e);return s||this.throwNoKeyError(e),i.pluralize(t.plularNumber,s,{isGenetiveForm:t.isGenetiveForm})}getTemplateText(e,t){const s=this.getKeyValue(e);return s||this.throwNoKeyError(e),i.textTemplate(s,t.args)}throwNoKeyError(e){throw new Error(`Key "${e}" does not exist in "${this.currentLang}" language`)}throwNoLangError(e){throw new Error(`Current language "${e}" was not loaded`)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Translations=void 0;const i=s(5),a=s(0);t.Translations=class{constructor(e){this.getMissionText=e=>{const{getText:t,getPluralText:s,getTemplateText:o}=this.game.i18n;switch(e.type){case a.EGameMode.totalKills:{const i=e.target;return`${t("mission")}: ${t("destroy")} ${i} ${s("invaders.plural",{plularNumber:i,isGenetiveForm:!0})}`}case a.EGameMode.enemyKills:{const a=e.target,o=Object.keys(a).map(e=>{const t=a[e],o=i.enemiesConfig.ships[e].pluralName;return`${t} ${s(o,{plularNumber:t})}`}).join(" / ");return`${t("mission")}: ${t("destroy")} ${o}`}case a.EGameMode.time:{const i=e.target;return`${t("mission")}: ${t("stayAliveFor")} ${i} ${s("seconds.plural",{plularNumber:i})}`}case a.EGameMode.waves:{const i=e.target.length,a=s("wave.plural",{plularNumber:i,isGenetiveForm:!0});return`${t("mission")}: ${o("defeatWavesCount.template",{args:{count:i,wave:a}})}`}case a.EGameMode.boss:return t("winBoss")}},this.game=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdManager=void 0;t.AdManager=class{showFullscreenVideo(e){window.ysdk.adv.showFullscreenAdv({callbacks:{onError:e.onError,onClose:e.onClose}})}showRewardedVideo(e){window.ysdk.adv.showRewardedVideo({callbacks:{onRewarded:e.onRewarded,onClose:e.onClose}})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Leaderboards=void 0;const i=s(4),a=s(1);t.Leaderboards=class{constructor(e){this.game=e,this.leaderboardName=e.settings.isMobile?i.leaderboardsNames.mobile:i.leaderboardsNames.main,a.debugLog("leaderboard",`init "${this.leaderboardName}"`),this.getLeaderboards()}getLeaderboards(){window.ysdk.getLeaderboards().then(e=>{this.lb=e,this.getLeaderboardPlayerEntry()}).catch(()=>{})}setLeaderboardScore(e){return a.debugLog("leaderboard","set score: "+e),this.lb?this.lb.setLeaderboardScore(this.leaderboardName,e).catch(e=>{console.error(e)}):Promise.reject()}getLeaderboardEntries(){return a.debugLog("leaderboard","get entries"),this.lb?this.lb.getLeaderboardEntries(this.leaderboardName).then(e=>(this.entries=e,e)):Promise.reject()}getLeaderboardPlayerEntry(){return a.debugLog("leaderboard","get entry"),this.lb?this.lb.getLeaderboardPlayerEntry(this.leaderboardName).then(e=>(this.playerEntry=e,e)):Promise.reject()}getPlayerEntry(){return this.playerEntry}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initMockYSDK=void 0;const i={score:101,extraData:"",rank:57257,player:{uniqueID:"j8t/7RM9xCd4bEZh0F2/zdyJiQIrbaV16GJqXgk5MkM=",lang:"ru",publicName:"Денис Чертенко",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},subscriptions:{}},formattedScore:"101"},a={leaderboard:{appID:96458,name:"main2",default:!0,description:{invert_sort_order:!1,score_format:{type:"numeric",options:{decimal_offset:0}}},title:{en:"Top players",ru:"Лучшие игроки"}},ranges:[{start:0,size:10},{start:57237,size:7}],userRank:57241,entries:[{score:310000002,extraData:"",rank:1,player:{uniqueID:"R5/7pYVcWrgDtdJjdtPTKYx4xiEbHC+yTPHfFhfvr6g=",lang:"ru",publicName:"Вячеслав Шабельник",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"310000002"},{score:9367061,extraData:"",rank:2,player:{uniqueID:"486tMW29whlo8T6svy9H9fejptWvsNKn/51YEnAx7as=",lang:"ru",publicName:"Sergey B.",avatarIdHash:"VEVTP7BEY5XBGMFTE3AKQCJHJY6SLONNJ7WPX73EL3ESZGQ5OFTB642MGF732MFDIMLHCU7OQJXACG6OPOBQ3UW5H543XNIFSAPLJSG7JHUJVQZKBAFCMWBWGMGVECUIKHDG4FOCXSZ6CX6YF7OJIF6Y",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"9367061"},{score:8440127,extraData:"",rank:3,player:{uniqueID:"BC3f+F4unlEGNki8FtWqgHBG6QuZm379DFsR+YpNWp4=",lang:"ru",publicName:"Ольга",avatarIdHash:"2LTSYAF3KRJM4VR5KVDOMIJKCMYOVDPISIXSM3G4NNMXKV4BV6WDQTBW6337GW3N5DU24TB5SNG5JIS32FPGICGQLQNCFW2IBDTNSC4X2MGXLGQIZTOAO27BRUUYCXVEJUE46CL7NFEXSALGKOJQ====",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"8440127"},{score:8439338,extraData:"",rank:4,player:{uniqueID:"TMPRXpwBWc/UvDAVWcsWNj7L+FU58f8S/x3BVnmiJYs=",lang:"ru",publicName:"Belugina O.",avatarIdHash:"DX4XAVIZF5Z6EZY5J5GVUXLNBU6J674SM4H3RRADVITXS3TQ77KHGEMOM2HWMD4V3MIKH2OHTZ73QNKIYACYCZTG2CNE7OCNNF4AWRLDVAAHZU2TV2XCTQMJBVRHSBW2ZGOQVRRO23SHRHULU5WX3QEWFS4TMQQCZTHQ====",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"8439338"},{score:7070707,extraData:"",rank:5,player:{uniqueID:"M+/5lLKeUK1PNZsEq6ddzQNVsPd0/6mJOpOiaMfP9rc=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"}},formattedScore:"7070707"},{score:6385931,extraData:"",rank:6,player:{uniqueID:"AFmbLj8nFXyjPxIgA1tBxP0buAS2U36nSiMDEU2QXQ0=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"}},formattedScore:"6385931"},{score:6154115,extraData:"",rank:7,player:{uniqueID:"Ly/m+/WE6fKJ69uapbwIOVa4y7JxuDuYFLQyGPWD/PQ=",lang:"ru",publicName:"Владислав С.",avatarIdHash:"LYYBVBE4VVXDNBOZQKFFQLLR6Q4K7W7F675ZBENB3OGYP32BTCXLZOC4GJIORBF65DVVJBQN7VWKQT6XNWREJOKXCXLJV47UBGCFMDJYQ7RKPOJKHNBJNBCGGLTP3UVJHXPAHA4ON7N37UM46VU7Q===",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"6154115"},{score:6000016,extraData:"",rank:8,player:{uniqueID:"oKa8t/3GdbQA0dSIB/EZMyU+r2TuftisVPyw+Z92ME0=",lang:"ru",publicName:"NardGammon - Лучшие Нарды",avatarIdHash:"476LF7ETEUUEP6HMFCAAASTPRON5SONAT4E4WHFL57OU6G6JS6RVLZN25CS2FEIFTKU5OZWMAS6VQAK32B5D42U33VOACQB2DMPOCDTTP7JA3FP7YUWLSAEAYN22I7EACGYPVM7GDOFGVCS3FYTP4===",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"6000016"},{score:5546592,extraData:"",rank:9,player:{uniqueID:"snYHxZUrbtIH936Ll7eKgO+F+fPybg3rUHW/Guv/tkM=",lang:"ru",publicName:"",avatarIdHash:"0",scopePermissions:{avatar:"forbid",public_name:"forbid"}},formattedScore:"5546592"},{score:4763196,extraData:"",rank:10,player:{uniqueID:"0QC4GXR2UtGebLij0+XThGLzUm9DF8oCfrgUoPVYmNo=",lang:"ru",publicName:"ГалинаГригорьевна г.",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"4763196"},{score:101,extraData:"",rank:57238,player:{uniqueID:"mLSWPBRGBTC6Vhrn4cMriuL4aa2i1DbfqGqKorf2lP0=",lang:"ru",publicName:"Замир Казиев",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"101"},{score:101,extraData:"",rank:57239,player:{uniqueID:"tGwgRmRNP/Eo6/eKEl4dj1lCeeKFjH4v4cfPDHyoj+w=",lang:"ru",publicName:"Николай Гурский",avatarIdHash:"K6REE6UOVMUMZRYC3V7WQIZCR53KXHNBIVYTCX4X4HCI556NFYGMSVDMVVDIKF63IW6KSYRASHCBWSEGQ3KWXG7WJCB5STGFIEAFBRGUG7C3DLQLMAISSNOXFCUWOATWJV5NEAFOOMQZBQUVP252Y===",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"101"},{score:101,extraData:"",rank:57240,player:{uniqueID:"pGVMJqLvAlWSbnKOhljxg6iVIG/yyziapsJ1zuLCDQY=",lang:"ru",publicName:"Сергей Блохин",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"101"},{score:101,extraData:"",rank:57241,player:{uniqueID:"j8t/7RM9xCd4bEZh0F2/zdyJiQIrbaV16GJqXgk5MkM=",lang:"ru",publicName:"Денис Чертенко",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"},subscriptions:{}},formattedScore:"101"},{score:101,extraData:"",rank:57242,player:{uniqueID:"oTAdoVj8mQxNziVapR4rFleCW0mpxncLfqbmdE09mz0=",lang:"ru",publicName:"Интересные факты о человеческом здоровье",avatarIdHash:"QCADYR7JG6JFJBZDB3XMLFMQ6GR7KSM7R3HC2WNF2MTTMUY5VFCPOE53IQLKP4ROGSPCP5DPM74DXWGMW4ZG4MS3RCAXG34TA2D5DS2RJWBZOF4PTEDPJRD7HBQ4QKTPIKOIIWJUOMLTOIXSEVLR6===",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"101"},{score:101,extraData:"",rank:57243,player:{uniqueID:"jRyD4dbrzmON7RghSiPMSwNYR7z0zbWD+/ZlmkYaEAU=",lang:"en",publicName:"אמיר פיינטוך",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"101"},{score:101,extraData:"",rank:57244,player:{uniqueID:"FulvDAqAqY90kItHJoLSBfZiOpGXNjJitPNNQyI/S8Q=",lang:"ru",publicName:"Мария Д.",avatarIdHash:"0",scopePermissions:{avatar:"allow",public_name:"allow"}},formattedScore:"101"}]},o={setLeaderboardScore:(e,t)=>new Promise((e,t)=>{Math.random()>.25?e():t()}),getLeaderboardEntries:e=>new Promise((e,t)=>{setTimeout(()=>{Math.random()>.15?e(a):t()},1e3)}),getLeaderboardPlayerEntry:e=>new Promise((e,t)=>{setTimeout(()=>{Math.random()>.15?e(i):t()},1e3)})};t.initMockYSDK=()=>new Promise(e=>{setTimeout(()=>{window.ysdk={environment:{i18n:{lang:"ru"}},getLeaderboards:()=>Promise.resolve(o),adv:{showFullscreenAdv:e=>{setTimeout(()=>{e.callbacks.onClose()},1500)},showRewardedVideo:e=>{setTimeout(()=>{Math.random()>.25&&e.callbacks.onRewarded()},1500),setTimeout(()=>{e.callbacks.onClose()},2500)}}},e(void 0)},0)})}]);